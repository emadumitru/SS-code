===
move-tree
---
ImportDeclaration [4675,4696]
    QualifiedName: java.util.Map [4682,4695]
to
CompilationUnit [0,24732]
at 0
===
move-tree
---
ImportDeclaration [3373,3431]
    QualifiedName: com.fasterxml.jackson.core.JsonProcessingException [3380,3430]
to
CompilationUnit [0,24732]
at 1
===
move-tree
---
ImportDeclaration [3433,3486]
    QualifiedName: com.fasterxml.jackson.core.type.TypeReference [3440,3485]
to
CompilationUnit [0,24732]
at 2
===
move-tree
---
ImportDeclaration [3551,3602]
    QualifiedName: com.fasterxml.jackson.databind.ObjectMapper [3558,3601]
to
CompilationUnit [0,24732]
at 3
===
move-tree
---
ImportDeclaration [23890,23939]
    QualifiedName: org.glassfish.grizzly.http.server.Request [23897,23938]
to
CompilationUnit [0,24732]
at 4
===
move-tree
---
ImportDeclaration [23941,23991]
    QualifiedName: org.glassfish.grizzly.http.server.Response [23948,23990]
to
CompilationUnit [0,24732]
at 5
===
move-tree
---
ImportDeclaration [4213,4272]
    QualifiedName: org.opentripplanner.api.model.AgencyAndIdSerializer [4220,4271]
to
CompilationUnit [0,24732]
at 6
===
move-tree
---
ImportDeclaration [4445,4469]
    QualifiedName: org.slf4j.Logger [4452,4468]
to
CompilationUnit [0,24732]
at 7
===
move-tree
---
ImportDeclaration [4471,4502]
    QualifiedName: org.slf4j.LoggerFactory [4478,4501]
to
CompilationUnit [0,24732]
at 8
===
move-tree
---
ImportDeclaration [4506,4533]
    QualifiedName: java.io.IOException [4513,4532]
to
CompilationUnit [0,24732]
at 9
===
move-tree
---
ImportDeclaration [4339,4394]
    QualifiedName: org.opentripplanner.routing.core.RoutingRequest [4346,4393]
to
CompilationUnit [0,24732]
at 12
===
move-tree
---
ImportDeclaration [188,243]
    QualifiedName: org.opentripplanner.routing.core.RoutingRequest [195,242]
to
CompilationUnit [0,24732]
at 34
===
move-tree
---
ImportDeclaration [15185,15232]
    QualifiedName: org.opentripplanner.routing.graph.Graph [15192,15231]
to
CompilationUnit [0,24732]
at 35
===
move-tree
---
ImportDeclaration [4396,4443]
    QualifiedName: org.opentripplanner.routing.graph.Graph [4403,4442]
to
CompilationUnit [0,24732]
at 51
===
insert-tree
---
PackageDeclaration [44667,44711]
    QualifiedName: org.opentripplanner.analyst.cluster [44675,44710]
to
CompilationUnit [0,24732]
at 0
===
insert-tree
---
ImportDeclaration [119,170]
    QualifiedName: com.fasterxml.jackson.databind.ObjectMapper [126,169]
to
CompilationUnit [0,24732]
at 1
===
insert-tree
---
ImportDeclaration [172,222]
    QualifiedName: org.glassfish.grizzly.http.server.Response [179,221]
to
CompilationUnit [0,24732]
at 2
===
insert-tree
---
ImportDeclaration [224,274]
    QualifiedName: org.glassfish.grizzly.http.util.HttpStatus [231,273]
to
CompilationUnit [0,24732]
at 3
===
insert-tree
---
ImportDeclaration [276,341]
    QualifiedName: org.opentripplanner.analyst.cluster.AnalystClusterRequest [283,340]
to
CompilationUnit [0,24732]
at 4
===
insert-tree
---
ImportDeclaration [343,367]
    QualifiedName: org.slf4j.Logger [350,366]
to
CompilationUnit [0,24732]
at 5
===
insert-tree
---
ImportDeclaration [369,400]
    QualifiedName: org.slf4j.LoggerFactory [376,399]
to
CompilationUnit [0,24732]
at 6
===
insert-tree
---
ImportDeclaration [404,431]
    QualifiedName: java.io.IOException [411,430]
to
CompilationUnit [0,24732]
at 7
===
insert-tree
---
ImportDeclaration [433,461]
    QualifiedName: java.io.OutputStream [440,460]
to
CompilationUnit [0,24732]
at 8
===
insert-tree
---
ImportDeclaration [463,491]
    QualifiedName: java.util.ArrayDeque [470,490]
to
CompilationUnit [0,24732]
at 9
===
insert-tree
---
ImportDeclaration [493,520]
    QualifiedName: java.util.ArrayList [500,519]
to
CompilationUnit [0,24732]
at 10
===
insert-tree
---
ImportDeclaration [522,550]
    QualifiedName: java.util.Collection [529,549]
to
CompilationUnit [0,24732]
at 11
===
insert-tree
---
ImportDeclaration [552,575]
    QualifiedName: java.util.Deque [559,574]
to
CompilationUnit [0,24732]
at 12
===
insert-tree
---
ImportDeclaration [577,602]
    QualifiedName: java.util.HashMap [584,601]
to
CompilationUnit [0,24732]
at 13
===
insert-tree
---
ImportDeclaration [604,626]
    QualifiedName: java.util.List [611,625]
to
CompilationUnit [0,24732]
at 14
===
insert-tree
---
ImportDeclaration [12915,12967]
    QualifiedName: com.fasterxml.jackson.annotation.JsonInclude [12922,12966]
to
CompilationUnit [0,24732]
at 16
===
insert-tree
---
ImportDeclaration [13137,13178]
    QualifiedName: org.glassfish.grizzly.http.Method [13144,13177]
to
CompilationUnit [0,24732]
at 20
===
insert-tree
---
ImportDeclaration [13180,13233]
    QualifiedName: org.glassfish.grizzly.http.server.HttpHandler [13187,13232]
to
CompilationUnit [0,24732]
at 21
===
insert-tree
---
ImportDeclaration [13338,13388]
    QualifiedName: org.glassfish.grizzly.http.util.HttpStatus [13345,13387]
to
CompilationUnit [0,24732]
at 24
===
insert-tree
---
ImportDeclaration [13390,13455]
    QualifiedName: org.opentripplanner.analyst.cluster.AnalystClusterRequest [13397,13454]
to
CompilationUnit [0,24732]
at 25
===
insert-tree
---
ImportDeclaration [13520,13547]
    QualifiedName: java.io.IOException [13527,13546]
to
CompilationUnit [0,24732]
at 27
===
insert-tree
---
ImportDeclaration [13549,13571]
    QualifiedName: java.util.List [13556,13570]
to
CompilationUnit [0,24732]
at 28
===
insert-tree
---
ImportDeclaration [18706,18758]
    QualifiedName: org.glassfish.grizzly.http.server.HttpServer [18713,18757]
to
CompilationUnit [0,24732]
at 29
===
insert-tree
---
ImportDeclaration [18760,18817]
    QualifiedName: org.glassfish.grizzly.http.server.NetworkListener [18767,18816]
to
CompilationUnit [0,24732]
at 30
===
insert-tree
---
ImportDeclaration [18819,18880]
    QualifiedName: org.glassfish.grizzly.strategies.SameThreadIOStrategy [18826,18879]
to
CompilationUnit [0,24732]
at 31
===
insert-tree
---
ImportDeclaration [18972,19002]
    QualifiedName: java.net.BindException [18979,19001]
to
CompilationUnit [0,24732]
at 35
===
insert-tree
---
ImportDeclaration [20780,20806]
    QualifiedName: java.util.Iterator [20787,20805]
to
CompilationUnit [0,24732]
at 36
===
insert-tree
---
ImportDeclaration [20808,20837]
    QualifiedName: java.util.Spliterator [20815,20836]
to
CompilationUnit [0,24732]
at 37
===
insert-tree
---
ImportDeclaration [20839,20874]
    QualifiedName: java.util.function.Consumer [20846,20873]
to
CompilationUnit [0,24732]
at 38
===
insert-tree
---
ImportDeclaration [20876,20912]
    QualifiedName: java.util.function.Predicate [20883,20911]
to
CompilationUnit [0,24732]
at 39
===
insert-tree
---
ImportDeclaration [24528,24561]
    QualifiedName: gnu.trove.map.TIntLongMap [24535,24560]
to
CompilationUnit [0,24732]
at 40
===
insert-tree
---
ImportDeclaration [24563,24598]
    QualifiedName: gnu.trove.map.TIntObjectMap [24570,24597]
to
CompilationUnit [0,24732]
at 41
===
insert-tree
---
ImportDeclaration [24600,24642]
    QualifiedName: gnu.trove.map.hash.TIntLongHashMap [24607,24641]
to
CompilationUnit [0,24732]
at 42
===
insert-tree
---
ImportDeclaration [24644,24688]
    QualifiedName: gnu.trove.map.hash.TIntObjectHashMap [24651,24687]
to
CompilationUnit [0,24732]
at 43
===
insert-tree
---
ImportDeclaration [24690,24755]
    QualifiedName: org.opentripplanner.analyst.cluster.AnalystClusterRequest [24697,24754]
to
CompilationUnit [0,24732]
at 44
===
insert-tree
---
ImportDeclaration [24759,24787]
    QualifiedName: java.util.ArrayDeque [24766,24786]
to
CompilationUnit [0,24732]
at 45
===
insert-tree
---
ImportDeclaration [24789,24811]
    QualifiedName: java.util.List [24796,24810]
to
CompilationUnit [0,24732]
at 46
===
insert-tree
---
ImportDeclaration [24813,24836]
    QualifiedName: java.util.Queue [24820,24835]
to
CompilationUnit [0,24732]
at 47
===
insert-tree
---
ImportDeclaration [33373,33431]
    QualifiedName: com.fasterxml.jackson.core.JsonProcessingException [33380,33430]
to
CompilationUnit [0,24732]
at 57
===
insert-tree
---
ImportDeclaration [33433,33486]
    QualifiedName: com.fasterxml.jackson.core.type.TypeReference [33440,33485]
to
CompilationUnit [0,24732]
at 58
===
insert-tree
---
ImportDeclaration [33551,33602]
    QualifiedName: com.fasterxml.jackson.databind.ObjectMapper [33558,33601]
to
CompilationUnit [0,24732]
at 60
===
insert-tree
---
ImportDeclaration [34213,34272]
    QualifiedName: org.opentripplanner.api.model.AgencyAndIdSerializer [34220,34271]
to
CompilationUnit [0,24732]
at 74
===
insert-tree
---
ImportDeclaration [34445,34469]
    QualifiedName: org.slf4j.Logger [34452,34468]
to
CompilationUnit [0,24732]
at 78
===
insert-tree
---
ImportDeclaration [34471,34502]
    QualifiedName: org.slf4j.LoggerFactory [34478,34501]
to
CompilationUnit [0,24732]
at 79
===
insert-tree
---
ImportDeclaration [34506,34533]
    QualifiedName: java.io.IOException [34513,34532]
to
CompilationUnit [0,24732]
at 80
===
insert-tree
---
ImportDeclaration [34675,34697]
    QualifiedName: java.util.List [34682,34696]
to
CompilationUnit [0,24732]
at 85
===
insert-node
---
TypeDeclaration [653,12783]
to
CompilationUnit [0,24732]
at 112
===
insert-node
---
TypeDeclaration [13575,18581]
to
CompilationUnit [0,24732]
at 113
===
insert-tree
---
TypeDeclaration [19069,20653]
    Modifier: public [19069,19075]
    TYPE_DECLARATION_KIND: class [19076,19081]
    SimpleName: BrokerMain [19082,19092]
    FieldDeclaration [19102,19178]
        Modifier: private [19102,19109]
        Modifier: static [19110,19116]
        Modifier: final [19117,19122]
        SimpleType [19123,19129]
            SimpleName: Logger [19123,19129]
        VariableDeclarationFragment [19130,19177]
            SimpleName: LOG [19130,19133]
            MethodInvocation [19136,19177]
                METHOD_INVOCATION_RECEIVER [19136,19149]
                    SimpleName: LoggerFactory [19136,19149]
                SimpleName: getLogger [19150,19159]
                METHOD_INVOCATION_ARGUMENTS [19160,19176]
                    TypeLiteral [19160,19176]
                        SimpleType [19160,19170]
                            SimpleName: BrokerMain [19160,19170]
    FieldDeclaration [19186,19223]
        Modifier: private [19186,19193]
        Modifier: static [19194,19200]
        Modifier: final [19201,19206]
        PrimitiveType: int [19207,19210]
        VariableDeclarationFragment [19211,19222]
            SimpleName: PORT [19211,19215]
            NumberLiteral: 9001 [19218,19222]
    FieldDeclaration [19231,19284]
        Modifier: private [19231,19238]
        Modifier: static [19239,19245]
        Modifier: final [19246,19251]
        SimpleType [19252,19258]
            SimpleName: String [19252,19258]
        VariableDeclarationFragment [19259,19283]
            SimpleName: BIND_ADDRESS [19259,19271]
            StringLiteral: "0.0.0.0" [19274,19283]
    MethodDeclaration [19292,20646]
        Modifier: public [19292,19298]
        Modifier: static [19299,19305]
        PrimitiveType: void [19306,19310]
        SimpleName: main [19311,19315]
        SingleVariableDeclaration [19316,19329]
            ArrayType [19316,19324]
                SimpleType [19316,19322]
                    SimpleName: String [19316,19322]
                Dimension [19322,19324]
            SimpleName: args [19325,19329]
        Block [19331,20646]
            ExpressionStatement [19344,19420]
                MethodInvocation [19344,19419]
                    METHOD_INVOCATION_RECEIVER [19344,19347]
                        SimpleName: LOG [19344,19347]
                    SimpleName: info [19348,19352]
                    METHOD_INVOCATION_ARGUMENTS [19353,19418]
                        StringLiteral: "Starting qbroker on port {} of interface {}" [19353,19398]
                        SimpleName: PORT [19400,19404]
                        SimpleName: BIND_ADDRESS [19406,19418]
            VariableDeclarationStatement [19430,19471]
                SimpleType [19430,19440]
                    SimpleName: HttpServer [19430,19440]
                VariableDeclarationFragment [19441,19470]
                    SimpleName: httpServer [19441,19451]
                    ClassInstanceCreation [19454,19470]
                        SimpleType [19458,19468]
                            SimpleName: HttpServer [19458,19468]
            VariableDeclarationStatement [19481,19566]
                SimpleType [19481,19496]
                    SimpleName: NetworkListener [19481,19496]
                VariableDeclarationFragment [19497,19565]
                    SimpleName: networkListener [19497,19512]
                    ClassInstanceCreation [19515,19565]
                        SimpleType [19519,19534]
                            SimpleName: NetworkListener [19519,19534]
                        StringLiteral: "qbroker" [19535,19544]
                        SimpleName: BIND_ADDRESS [19546,19558]
                        SimpleName: PORT [19560,19564]
            ExpressionStatement [19576,19657]
                MethodInvocation [19576,19656]
                    METHOD_INVOCATION_RECEIVER [19576,19606]
                        MethodInvocation [19576,19606]
                            METHOD_INVOCATION_RECEIVER [19576,19591]
                                SimpleName: networkListener [19576,19591]
                            SimpleName: getTransport [19592,19604]
                    SimpleName: setIOStrategy [19607,19620]
                    METHOD_INVOCATION_ARGUMENTS [19621,19655]
                        MethodInvocation [19621,19655]
                            METHOD_INVOCATION_RECEIVER [19621,19641]
                                SimpleName: SameThreadIOStrategy [19621,19641]
                            SimpleName: getInstance [19642,19653]
            ExpressionStatement [19738,19778]
                MethodInvocation [19738,19777]
                    METHOD_INVOCATION_RECEIVER [19738,19748]
                        SimpleName: httpServer [19738,19748]
                    SimpleName: addListener [19749,19760]
                    METHOD_INVOCATION_ARGUMENTS [19761,19776]
                        SimpleName: networkListener [19761,19776]
            VariableDeclarationStatement [19945,19974]
                SimpleType [19945,19951]
                    SimpleName: Broker [19945,19951]
                VariableDeclarationFragment [19952,19973]
                    SimpleName: broker [19952,19958]
                    ClassInstanceCreation [19961,19973]
                        SimpleType [19965,19971]
                            SimpleName: Broker [19965,19971]
            ExpressionStatement [19984,20072]
                MethodInvocation [19984,20071]
                    METHOD_INVOCATION_RECEIVER [19984,20019]
                        MethodInvocation [19984,20019]
                            METHOD_INVOCATION_RECEIVER [19984,19994]
                                SimpleName: httpServer [19984,19994]
                            SimpleName: getServerConfiguration [19995,20017]
                    SimpleName: addHttpHandler [20020,20034]
                    METHOD_INVOCATION_ARGUMENTS [20035,20070]
                        ClassInstanceCreation [20035,20064]
                            SimpleType [20039,20056]
                                SimpleName: BrokerHttpHandler [20039,20056]
                            SimpleName: broker [20057,20063]
                        StringLiteral: "/*" [20066,20070]
            TryStatement [20082,20605]
                Block [20086,20289]
                    ExpressionStatement [20101,20120]
                        MethodInvocation [20101,20119]
                            METHOD_INVOCATION_RECEIVER [20101,20111]
                                SimpleName: httpServer [20101,20111]
                            SimpleName: start [20112,20117]
                    ExpressionStatement [20134,20162]
                        MethodInvocation [20134,20161]
                            METHOD_INVOCATION_RECEIVER [20134,20137]
                                SimpleName: LOG [20134,20137]
                            SimpleName: info [20138,20142]
                            METHOD_INVOCATION_ARGUMENTS [20143,20160]
                                StringLiteral: "Broker running." [20143,20160]
                    ExpressionStatement [20176,20189]
                        MethodInvocation [20176,20188]
                            METHOD_INVOCATION_RECEIVER [20176,20182]
                                SimpleName: broker [20176,20182]
                            SimpleName: run [20183,20186]
                    ExpressionStatement [20248,20278]
                        MethodInvocation [20248,20277]
                            METHOD_INVOCATION_RECEIVER [20248,20270]
                                MethodInvocation [20248,20270]
                                    METHOD_INVOCATION_RECEIVER [20248,20254]
                                        SimpleName: Thread [20248,20254]
                                    SimpleName: currentThread [20255,20268]
                            SimpleName: join [20271,20275]
                CatchClause [20290,20406]
                    SingleVariableDeclaration [20297,20313]
                        SimpleType [20297,20310]
                            SimpleName: BindException [20297,20310]
                        SimpleName: be [20311,20313]
                    Block [20315,20406]
                        ExpressionStatement [20330,20395]
                            MethodInvocation [20330,20394]
                                METHOD_INVOCATION_RECEIVER [20330,20333]
                                    SimpleName: LOG [20330,20333]
                                SimpleName: error [20334,20339]
                                METHOD_INVOCATION_ARGUMENTS [20340,20393]
                                    StringLiteral: "Cannot bind to port {}. Is it already in use?" [20340,20387]
                                    SimpleName: PORT [20389,20393]
                CatchClause [20407,20506]
                    SingleVariableDeclaration [20414,20429]
                        SimpleType [20414,20425]
                            SimpleName: IOException [20414,20425]
                        SimpleName: ioe [20426,20429]
                    Block [20431,20506]
                        ExpressionStatement [20446,20495]
                            MethodInvocation [20446,20494]
                                METHOD_INVOCATION_RECEIVER [20446,20449]
                                    SimpleName: LOG [20446,20449]
                                SimpleName: error [20450,20455]
                                METHOD_INVOCATION_ARGUMENTS [20456,20493]
                                    StringLiteral: "IO exception while starting server." [20456,20493]
                CatchClause [20507,20605]
                    SingleVariableDeclaration [20514,20537]
                        SimpleType [20514,20534]
                            SimpleName: InterruptedException [20514,20534]
                        SimpleName: ie [20535,20537]
                    Block [20539,20605]
                        ExpressionStatement [20554,20594]
                            MethodInvocation [20554,20593]
                                METHOD_INVOCATION_RECEIVER [20554,20557]
                                    SimpleName: LOG [20554,20557]
                                SimpleName: info [20558,20562]
                                METHOD_INVOCATION_ARGUMENTS [20563,20592]
                                    StringLiteral: "Interrupted, shutting down." [20563,20592]
            ExpressionStatement [20615,20637]
                MethodInvocation [20615,20636]
                    METHOD_INVOCATION_RECEIVER [20615,20625]
                        SimpleName: httpServer [20615,20625]
                    SimpleName: shutdown [20626,20634]
to
CompilationUnit [0,24732]
at 114
===
insert-tree
---
TypeDeclaration [20916,24410]
    Javadoc [20916,20928]
    Modifier: public [20930,20936]
    TYPE_DECLARATION_KIND: class [20937,20942]
    SimpleName: CircularList [20943,20955]
    TypeParameter [20956,20957]
        SimpleName: T [20956,20957]
    ParameterizedType [20970,20981]
        SimpleType [20970,20978]
            SimpleName: Iterable [20970,20978]
        SimpleType [20979,20980]
            SimpleName: T [20979,20980]
    FieldDeclaration [20991,21011]
        ParameterizedType [20991,20998]
            SimpleType [20991,20995]
                SimpleName: Node [20991,20995]
            SimpleType [20996,20997]
                SimpleName: T [20996,20997]
        VariableDeclarationFragment [20999,21010]
            SimpleName: head [20999,21003]
            NullLiteral [21006,21010]
    TypeDeclaration [21019,21482]
        Modifier: public [21019,21025]
        TYPE_DECLARATION_KIND: class [21026,21031]
        SimpleName: CircularListIterator [21032,21052]
        ParameterizedType [21064,21075]
            SimpleType [21064,21072]
                SimpleName: Iterator [21064,21072]
            SimpleType [21073,21074]
                SimpleName: T [21073,21074]
        FieldDeclaration [21089,21109]
            ParameterizedType [21089,21096]
                SimpleType [21089,21093]
                    SimpleName: Node [21089,21093]
                SimpleType [21094,21095]
                    SimpleName: T [21094,21095]
            VariableDeclarationFragment [21097,21108]
                SimpleName: curr [21097,21101]
                SimpleName: head [21104,21108]
        MethodDeclaration [21121,21211]
            MarkerAnnotation [21121,21130]
                SimpleName: Override [21122,21130]
            Modifier: public [21140,21146]
            PrimitiveType: boolean [21147,21154]
            SimpleName: hasNext [21155,21162]
            Block [21165,21211]
                ReturnStatement [21180,21200]
                    InfixExpression [21187,21199]
                        SimpleName: curr [21187,21191]
                        INFIX_EXPRESSION_OPERATOR: != [21192,21194]
                        NullLiteral [21195,21199]
        MethodDeclaration [21223,21475]
            MarkerAnnotation [21223,21232]
                SimpleName: Override [21224,21232]
            Modifier: public [21242,21248]
            SimpleType [21249,21250]
                SimpleName: T [21249,21250]
            SimpleName: next [21251,21255]
            Block [21258,21475]
                VariableDeclarationStatement [21273,21302]
                    SimpleType [21273,21274]
                        SimpleName: T [21273,21274]
                    VariableDeclarationFragment [21275,21301]
                        SimpleName: currElement [21275,21286]
                        QualifiedName: curr.element [21289,21301]
                ExpressionStatement [21316,21333]
                    Assignment [21316,21332]
                        SimpleName: curr [21316,21320]
                        ASSIGNMENT_OPERATOR: = [21321,21322]
                        QualifiedName: curr.next [21323,21332]
                IfStatement [21347,21431]
                    InfixExpression [21351,21363]
                        SimpleName: curr [21351,21355]
                        INFIX_EXPRESSION_OPERATOR: == [21356,21358]
                        SimpleName: head [21359,21363]
                    Block [21365,21431]
                        ExpressionStatement [21384,21396]
                            Assignment [21384,21395]
                                SimpleName: curr [21384,21388]
                                ASSIGNMENT_OPERATOR: = [21389,21390]
                                NullLiteral [21391,21395]
                ReturnStatement [21445,21464]
                    SimpleName: currElement [21452,21463]
    MethodDeclaration [21490,21587]
        MarkerAnnotation [21490,21499]
            SimpleName: Override [21491,21499]
        Modifier: public [21505,21511]
        ParameterizedType [21512,21523]
            SimpleType [21512,21520]
                SimpleName: Iterator [21512,21520]
            SimpleType [21521,21522]
                SimpleName: T [21521,21522]
        SimpleName: iterator [21524,21532]
        Block [21535,21587]
            ReturnStatement [21546,21580]
                ClassInstanceCreation [21553,21579]
                    SimpleType [21557,21577]
                        SimpleName: CircularListIterator [21557,21577]
    MethodDeclaration [21595,21816]
        MarkerAnnotation [21595,21604]
            SimpleName: Override [21596,21604]
        Modifier: public [21610,21616]
        PrimitiveType: void [21617,21621]
        SimpleName: forEach [21622,21629]
        SingleVariableDeclaration [21630,21656]
            ParameterizedType [21630,21649]
                SimpleType [21630,21638]
                    SimpleName: Consumer [21630,21638]
                WildcardType [21639,21648]
                    SimpleType [21647,21648]
                        SimpleName: T [21647,21648]
            SimpleName: action [21650,21656]
        Block [21658,21816]
            VariableDeclarationStatement [21669,21689]
                ParameterizedType [21669,21676]
                    SimpleType [21669,21673]
                        SimpleName: Node [21669,21673]
                    SimpleType [21674,21675]
                        SimpleName: T [21674,21675]
                VariableDeclarationFragment [21677,21688]
                    SimpleName: curr [21677,21681]
                    SimpleName: head [21684,21688]
            DoStatement [21699,21809]
                Block [21702,21787]
                    ExpressionStatement [21717,21745]
                        MethodInvocation [21717,21744]
                            METHOD_INVOCATION_RECEIVER [21717,21723]
                                SimpleName: action [21717,21723]
                            SimpleName: accept [21724,21730]
                            METHOD_INVOCATION_ARGUMENTS [21731,21743]
                                QualifiedName: curr.element [21731,21743]
                    ExpressionStatement [21759,21776]
                        Assignment [21759,21775]
                            SimpleName: curr [21759,21763]
                            ASSIGNMENT_OPERATOR: = [21764,21765]
                            QualifiedName: curr.next [21766,21775]
                InfixExpression [21795,21807]
                    SimpleName: curr [21795,21799]
                    INFIX_EXPRESSION_OPERATOR: != [21800,21802]
                    SimpleName: head [21803,21807]
    MethodDeclaration [21824,21935]
        MarkerAnnotation [21824,21833]
            SimpleName: Override [21825,21833]
        Modifier: public [21839,21845]
        ParameterizedType [21846,21860]
            SimpleType [21846,21857]
                SimpleName: Spliterator [21846,21857]
            SimpleType [21858,21859]
                SimpleName: T [21858,21859]
        SimpleName: spliterator [21861,21872]
        Block [21875,21935]
            ThrowStatement [21886,21928]
                ClassInstanceCreation [21892,21927]
                    SimpleType [21896,21925]
                        SimpleName: UnsupportedOperationException [21896,21925]
    TypeDeclaration [21943,22040]
        Modifier: private [21943,21950]
        Modifier: static [21951,21957]
        TYPE_DECLARATION_KIND: class [21958,21963]
        SimpleName: Node [21964,21968]
        TypeParameter [21969,21970]
            SimpleName: T [21969,21970]
        FieldDeclaration [21983,21993]
            SimpleType [21983,21987]
                SimpleName: Node [21983,21987]
            VariableDeclarationFragment [21988,21992]
                SimpleName: prev [21988,21992]
        FieldDeclaration [22003,22013]
            SimpleType [22003,22007]
                SimpleName: Node [22003,22007]
            VariableDeclarationFragment [22008,22012]
                SimpleName: next [22008,22012]
        FieldDeclaration [22023,22033]
            SimpleType [22023,22024]
                SimpleName: T [22023,22024]
            VariableDeclarationFragment [22025,22032]
                SimpleName: element [22025,22032]
    MethodDeclaration [22048,22582]
        Javadoc [22048,22147]
            TagElement [22052,22145]
                TextElement: Insert an element at the tail of the circular list (the position just previous to the head).  [22052,22145]
        Modifier: public [22153,22159]
        PrimitiveType: void [22160,22164]
        SimpleName: insertAtTail [22165,22177]
        SingleVariableDeclaration [22179,22188]
            SimpleType [22179,22180]
                SimpleName: T [22179,22180]
            SimpleName: element [22181,22188]
        Block [22190,22582]
            VariableDeclarationStatement [22201,22232]
                ParameterizedType [22201,22208]
                    SimpleType [22201,22205]
                        SimpleName: Node [22201,22205]
                    SimpleType [22206,22207]
                        SimpleName: T [22206,22207]
                VariableDeclarationFragment [22209,22231]
                    SimpleName: newNode [22209,22216]
                    ClassInstanceCreation [22219,22231]
                        ParameterizedType [22223,22229]
                            SimpleType [22223,22227]
                                SimpleName: Node [22223,22227]
            ExpressionStatement [22242,22268]
                Assignment [22242,22267]
                    QualifiedName: newNode.element [22242,22257]
                    ASSIGNMENT_OPERATOR: = [22258,22259]
                    SimpleName: element [22260,22267]
            IfStatement [22278,22575]
                InfixExpression [22282,22294]
                    SimpleName: head [22282,22286]
                    INFIX_EXPRESSION_OPERATOR: == [22287,22289]
                    NullLiteral [22290,22294]
                Block [22296,22411]
                    ExpressionStatement [22311,22334]
                        Assignment [22311,22333]
                            QualifiedName: newNode.next [22311,22323]
                            ASSIGNMENT_OPERATOR: = [22324,22325]
                            SimpleName: newNode [22326,22333]
                    ExpressionStatement [22348,22371]
                        Assignment [22348,22370]
                            QualifiedName: newNode.prev [22348,22360]
                            ASSIGNMENT_OPERATOR: = [22361,22362]
                            SimpleName: newNode [22363,22370]
                    ExpressionStatement [22385,22400]
                        Assignment [22385,22399]
                            SimpleName: head [22385,22389]
                            ASSIGNMENT_OPERATOR: = [22390,22391]
                            SimpleName: newNode [22392,22399]
                Block [22417,22575]
                    ExpressionStatement [22432,22457]
                        Assignment [22432,22456]
                            QualifiedName: newNode.prev [22432,22444]
                            ASSIGNMENT_OPERATOR: = [22445,22446]
                            QualifiedName: head.prev [22447,22456]
                    ExpressionStatement [22471,22491]
                        Assignment [22471,22490]
                            QualifiedName: newNode.next [22471,22483]
                            ASSIGNMENT_OPERATOR: = [22484,22485]
                            SimpleName: head [22486,22490]
                    ExpressionStatement [22505,22530]
                        Assignment [22505,22529]
                            QualifiedName: head.prev.next [22505,22519]
                            ASSIGNMENT_OPERATOR: = [22520,22521]
                            SimpleName: newNode [22522,22529]
                    ExpressionStatement [22544,22564]
                        Assignment [22544,22563]
                            QualifiedName: head.prev [22544,22553]
                            ASSIGNMENT_OPERATOR: = [22554,22555]
                            SimpleName: newNode [22556,22563]
    MethodDeclaration [22592,22855]
        Javadoc [22592,22653]
            TagElement [22596,22651]
                TextElement: Insert a new element at the head of the circular list.  [22596,22651]
        Modifier: public [22659,22665]
        PrimitiveType: void [22666,22670]
        SimpleName: insertAtHead [22671,22683]
        SingleVariableDeclaration [22685,22694]
            SimpleType [22685,22686]
                SimpleName: T [22685,22686]
            SimpleName: element [22687,22694]
        Block [22696,22855]
            ExpressionStatement [22799,22821]
                MethodInvocation [22799,22820]
                    SimpleName: insertAtTail [22799,22811]
                    METHOD_INVOCATION_ARGUMENTS [22812,22819]
                        SimpleName: element [22812,22819]
            ExpressionStatement [22831,22848]
                Assignment [22831,22847]
                    SimpleName: head [22831,22835]
                    ASSIGNMENT_OPERATOR: = [22836,22837]
                    QualifiedName: head.prev [22838,22847]
    MethodDeclaration [22863,22991]
        Javadoc [22863,22930]
            TagElement [22867,22928]
                TextElement: Get the element at the head of the list without removing it.  [22867,22928]
        Modifier: public [22936,22942]
        SimpleType [22943,22944]
            SimpleName: T [22943,22944]
        SimpleName: peek [22945,22949]
        Block [22953,22991]
            ReturnStatement [22964,22984]
                QualifiedName: head.element [22971,22983]
    MethodDeclaration [22999,23487]
        Javadoc [22999,23074]
            TagElement [23003,23072]
                TextElement: Take an element off the head of the list, removing it from the list.  [23003,23072]
        Modifier: public [23080,23086]
        SimpleType [23087,23088]
            SimpleName: T [23087,23088]
        SimpleName: pop [23089,23092]
        Block [23096,23487]
            IfStatement [23107,23163]
                InfixExpression [23111,23123]
                    SimpleName: head [23111,23115]
                    INFIX_EXPRESSION_OPERATOR: == [23116,23118]
                    NullLiteral [23119,23123]
                Block [23125,23163]
                    ReturnStatement [23140,23152]
                        NullLiteral [23147,23151]
            VariableDeclarationStatement [23173,23198]
                SimpleType [23173,23174]
                    SimpleName: T [23173,23174]
                VariableDeclarationFragment [23175,23197]
                    SimpleName: element [23175,23182]
                    QualifiedName: head.element [23185,23197]
            IfStatement [23208,23455]
                InfixExpression [23212,23229]
                    SimpleName: head [23212,23216]
                    INFIX_EXPRESSION_OPERATOR: == [23217,23219]
                    QualifiedName: head.next [23220,23229]
                Block [23231,23324]
                    ExpressionStatement [23301,23313]
                        Assignment [23301,23312]
                            SimpleName: head [23301,23305]
                            ASSIGNMENT_OPERATOR: = [23306,23307]
                            NullLiteral [23308,23312]
                Block [23330,23455]
                    ExpressionStatement [23345,23372]
                        Assignment [23345,23371]
                            QualifiedName: head.prev.next [23345,23359]
                            ASSIGNMENT_OPERATOR: = [23360,23361]
                            QualifiedName: head.next [23362,23371]
                    ExpressionStatement [23386,23413]
                        Assignment [23386,23412]
                            QualifiedName: head.next.prev [23386,23400]
                            ASSIGNMENT_OPERATOR: = [23401,23402]
                            QualifiedName: head.prev [23403,23412]
                    ExpressionStatement [23427,23444]
                        Assignment [23427,23443]
                            SimpleName: head [23427,23431]
                            ASSIGNMENT_OPERATOR: = [23432,23433]
                            QualifiedName: head.next [23434,23443]
            ReturnStatement [23465,23480]
                SimpleName: element [23472,23479]
    MethodDeclaration [23495,23862]
        Javadoc [23495,23668]
            TagElement [23507,23659]
                TextElement: Advance the head of the circular list forward to the next element. [23507,23573]
                TextElement: Return the element at the head of the list, leaving that element in the list. [23582,23659]
        Modifier: public [23674,23680]
        SimpleType [23681,23682]
            SimpleName: T [23681,23682]
        SimpleName: advance [23683,23690]
        Block [23693,23862]
            IfStatement [23704,23760]
                InfixExpression [23708,23720]
                    SimpleName: head [23708,23712]
                    INFIX_EXPRESSION_OPERATOR: == [23713,23715]
                    NullLiteral [23716,23720]
                Block [23722,23760]
                    ReturnStatement [23737,23749]
                        NullLiteral [23744,23748]
            VariableDeclarationStatement [23770,23799]
                SimpleType [23770,23771]
                    SimpleName: T [23770,23771]
                VariableDeclarationFragment [23772,23798]
                    SimpleName: headElement [23772,23783]
                    QualifiedName: head.element [23786,23798]
            ExpressionStatement [23809,23826]
                Assignment [23809,23825]
                    SimpleName: head [23809,23813]
                    ASSIGNMENT_OPERATOR: = [23814,23815]
                    QualifiedName: head.next [23816,23825]
            ReturnStatement [23836,23855]
                SimpleName: headElement [23843,23854]
    MethodDeclaration [23870,24405]
        Javadoc [23870,24099]
            TagElement [23882,24090]
                TextElement: Advances through the circular list returning the first element for which the predicate evaluates to true. [23882,23987]
                TextElement: If there is no such element, returns null leaving the head of the list back in the same place. [23996,24090]
        Modifier: public [24105,24111]
        SimpleType [24112,24113]
            SimpleName: T [24112,24113]
        SimpleName: advanceToElement [24114,24130]
        SingleVariableDeclaration [24132,24154]
            ParameterizedType [24132,24144]
                SimpleType [24132,24141]
                    SimpleName: Predicate [24132,24141]
                SimpleType [24142,24143]
                    SimpleName: T [24142,24143]
            SimpleName: predicate [24145,24154]
        Block [24156,24405]
            VariableDeclarationStatement [24167,24188]
                ParameterizedType [24167,24174]
                    SimpleType [24167,24171]
                        SimpleName: Node [24167,24171]
                    SimpleType [24172,24173]
                        SimpleName: T [24172,24173]
                VariableDeclarationFragment [24175,24187]
                    SimpleName: start [24175,24180]
                    SimpleName: head [24183,24187]
            DoStatement [24198,24376]
                Block [24201,24353]
                    VariableDeclarationStatement [24216,24242]
                        SimpleType [24216,24217]
                            SimpleName: T [24216,24217]
                        VariableDeclarationFragment [24218,24241]
                            SimpleName: currElement [24218,24229]
                            MethodInvocation [24232,24241]
                                SimpleName: advance [24232,24239]
                    IfStatement [24256,24342]
                        MethodInvocation [24260,24287]
                            METHOD_INVOCATION_RECEIVER [24260,24269]
                                SimpleName: predicate [24260,24269]
                            SimpleName: test [24270,24274]
                            METHOD_INVOCATION_ARGUMENTS [24275,24286]
                                SimpleName: currElement [24275,24286]
                        Block [24289,24342]
                            ReturnStatement [24308,24327]
                                SimpleName: currElement [24315,24326]
                InfixExpression [24361,24374]
                    SimpleName: head [24361,24365]
                    INFIX_EXPRESSION_OPERATOR: != [24366,24368]
                    SimpleName: start [24369,24374]
            ReturnStatement [24386,24398]
                NullLiteral [24393,24397]
to
CompilationUnit [0,24732]
at 115
===
insert-tree
---
TypeDeclaration [24840,26209]
    Javadoc [24840,25041]
        TagElement [24848,25036]
            TextElement: FIXME delivered tasks map is oblivious to multiple tasks having the same ID. [24848,24924]
            TextElement: In fact we just generate numeric queue task IDs. Origin point IDs will be handled at the application layer. [24929,25036]
    Modifier: public [25043,25049]
    TYPE_DECLARATION_KIND: class [25050,25055]
    SimpleName: Job [25056,25059]
    FieldDeclaration [25069,25092]
        Modifier: private [25069,25076]
        PrimitiveType: int [25077,25080]
        VariableDeclarationFragment [25081,25091]
            SimpleName: nTasks [25081,25087]
            NumberLiteral: 0 [25090,25091]
    FieldDeclaration [25189,25204]
        SimpleType [25189,25195]
            SimpleName: String [25189,25195]
        VariableDeclarationFragment [25196,25203]
            SimpleName: graphId [25196,25203]
    FieldDeclaration [25212,25238]
        Modifier: public [25212,25218]
        Modifier: final [25219,25224]
        SimpleType [25225,25231]
            SimpleName: String [25225,25231]
        VariableDeclarationFragment [25232,25237]
            SimpleName: jobId [25232,25237]
    FieldDeclaration [25282,25345]
        ParameterizedType [25282,25310]
            SimpleType [25282,25287]
                SimpleName: Queue [25282,25287]
            SimpleType [25288,25309]
                SimpleName: AnalystClusterRequest [25288,25309]
        VariableDeclarationFragment [25311,25344]
            SimpleName: visibleTasks [25311,25323]
            ClassInstanceCreation [25326,25344]
                ParameterizedType [25330,25342]
                    SimpleType [25330,25340]
                        SimpleName: ArrayDeque [25330,25340]
    FieldDeclaration [25436,25516]
        ParameterizedType [25436,25472]
            SimpleType [25436,25449]
                SimpleName: TIntObjectMap [25436,25449]
            SimpleType [25450,25471]
                SimpleName: AnalystClusterRequest [25450,25471]
        VariableDeclarationFragment [25473,25515]
            SimpleName: invisibleTasks [25473,25487]
            ClassInstanceCreation [25490,25515]
                ParameterizedType [25494,25513]
                    SimpleType [25494,25511]
                        SimpleName: TIntObjectHashMap [25494,25511]
    FieldDeclaration [25524,25575]
        SimpleType [25524,25535]
            SimpleName: TIntLongMap [25524,25535]
        VariableDeclarationFragment [25536,25574]
            SimpleName: invisibleUntil [25536,25550]
            ClassInstanceCreation [25553,25574]
                SimpleType [25557,25572]
                    SimpleName: TIntLongHashMap [25557,25572]
    MethodDeclaration [25583,25646]
        Modifier: public [25583,25589]
        SimpleName: Job [25590,25593]
        SingleVariableDeclaration [25595,25607]
            SimpleType [25595,25601]
                SimpleName: String [25595,25601]
            SimpleName: jobId [25602,25607]
        Block [25609,25646]
            ExpressionStatement [25620,25639]
                Assignment [25620,25638]
                    FieldAccess [25620,25630]
                        ThisExpression [25620,25624]
                        SimpleName: jobId [25625,25630]
                    ASSIGNMENT_OPERATOR: = [25631,25632]
                    SimpleName: jobId [25633,25638]
    MethodDeclaration [25654,25831]
        Javadoc [25654,25716]
            TagElement [25658,25714]
                TextElement: Adds a task to this Job, assigning it a task ID number.  [25658,25714]
        Modifier: public [25722,25728]
        PrimitiveType: void [25729,25733]
        SimpleName: addTask [25734,25741]
        SingleVariableDeclaration [25743,25769]
            SimpleType [25743,25764]
                SimpleName: AnalystClusterRequest [25743,25764]
            SimpleName: task [25765,25769]
        Block [25771,25831]
            ExpressionStatement [25782,25791]
                PostfixExpression [25782,25790]
                    SimpleName: nTasks [25782,25788]
                    POSTFIX_EXPRESSION_OPERATOR: ++ [25788,25790]
            ExpressionStatement [25801,25824]
                MethodInvocation [25801,25823]
                    METHOD_INVOCATION_RECEIVER [25801,25813]
                        SimpleName: visibleTasks [25801,25813]
                    SimpleName: add [25814,25817]
                    METHOD_INVOCATION_ARGUMENTS [25818,25822]
                        SimpleName: task [25818,25822]
    MethodDeclaration [25839,26204]
        Modifier: public [25839,25845]
        PrimitiveType: void [25846,25850]
        SimpleName: markTasksDelivered [25851,25869]
        SingleVariableDeclaration [25870,25903]
            ParameterizedType [25870,25897]
                SimpleType [25870,25874]
                    SimpleName: List [25870,25874]
                SimpleType [25875,25896]
                    SimpleName: AnalystClusterRequest [25875,25896]
            SimpleName: tasks [25898,25903]
        Block [25905,26204]
            VariableDeclarationStatement [25916,25963]
                PrimitiveType: long [25916,25920]
                VariableDeclarationFragment [25921,25962]
                    SimpleName: deliveryTime [25921,25933]
                    MethodInvocation [25936,25962]
                        METHOD_INVOCATION_RECEIVER [25936,25942]
                            SimpleName: System [25936,25942]
                        SimpleName: currentTimeMillis [25943,25960]
            VariableDeclarationStatement [25973,26011]
                PrimitiveType: long [25973,25977]
                VariableDeclarationFragment [25978,26010]
                    SimpleName: visibleAt [25978,25987]
                    InfixExpression [25990,26010]
                        SimpleName: deliveryTime [25990,26002]
                        INFIX_EXPRESSION_OPERATOR: + [26003,26004]
                        NumberLiteral: 60000 [26005,26010]
            EnhancedForStatement [26035,26197]
                SingleVariableDeclaration [26040,26066]
                    SimpleType [26040,26061]
                        SimpleName: AnalystClusterRequest [26040,26061]
                    SimpleName: task [26062,26066]
                SimpleName: tasks [26069,26074]
                Block [26076,26197]
                    ExpressionStatement [26091,26134]
                        MethodInvocation [26091,26133]
                            METHOD_INVOCATION_RECEIVER [26091,26105]
                                SimpleName: invisibleUntil [26091,26105]
                            SimpleName: put [26106,26109]
                            METHOD_INVOCATION_ARGUMENTS [26110,26132]
                                QualifiedName: task.taskId [26110,26121]
                                SimpleName: visibleAt [26123,26132]
                    ExpressionStatement [26148,26186]
                        MethodInvocation [26148,26185]
                            METHOD_INVOCATION_RECEIVER [26148,26162]
                                SimpleName: invisibleTasks [26148,26162]
                            SimpleName: put [26163,26166]
                            METHOD_INVOCATION_ARGUMENTS [26167,26184]
                                QualifiedName: task.taskId [26167,26178]
                                SimpleName: task [26180,26184]
to
CompilationUnit [0,24732]
at 116
===
insert-tree
---
TypeDeclaration [26333,28910]
    Modifier: public [26333,26339]
    TYPE_DECLARATION_KIND: class [26340,26345]
    SimpleName: QueuePath [26346,26355]
    FieldDeclaration [26365,26389]
        Modifier: public [26365,26371]
        SimpleType [26372,26378]
            SimpleName: String [26372,26378]
        VariableDeclarationFragment [26379,26388]
            SimpleName: queueType [26379,26388]
    FieldDeclaration [26395,26416]
        Modifier: public [26395,26401]
        SimpleType [26402,26408]
            SimpleName: String [26402,26408]
        VariableDeclarationFragment [26409,26415]
            SimpleName: userId [26409,26415]
    FieldDeclaration [26422,26444]
        Modifier: public [26422,26428]
        SimpleType [26429,26435]
            SimpleName: String [26429,26435]
        VariableDeclarationFragment [26436,26443]
            SimpleName: graphId [26436,26443]
    FieldDeclaration [26450,26470]
        Modifier: public [26450,26456]
        SimpleType [26457,26463]
            SimpleName: String [26457,26463]
        VariableDeclarationFragment [26464,26469]
            SimpleName: jobId [26464,26469]
    FieldDeclaration [26513,26536]
        Modifier: public [26513,26519]
        PrimitiveType: int [26520,26523]
        VariableDeclarationFragment [26524,26535]
            SimpleName: taskId [26524,26530]
            PrefixExpression [26533,26535]
                PREFIX_EXPRESSION_OPERATOR: - [26533,26534]
                NumberLiteral: 1 [26534,26535]
    MethodDeclaration [26544,27426]
        Javadoc [26544,26611]
            TagElement [26556,26602]
                TextElement: path is /queueType/userId/graphId/jobId/taskId [26556,26602]
        Modifier: public [26617,26623]
        SimpleName: QueuePath [26624,26633]
        SingleVariableDeclaration [26635,26645]
            SimpleType [26635,26641]
                SimpleName: String [26635,26641]
            SimpleName: uri [26642,26645]
        Block [26647,27426]
            VariableDeclarationStatement [26658,26699]
                ArrayType [26658,26666]
                    SimpleType [26658,26664]
                        SimpleName: String [26658,26664]
                    Dimension [26664,26666]
                VariableDeclarationFragment [26667,26698]
                    SimpleName: pathComponents [26667,26681]
                    MethodInvocation [26684,26698]
                        METHOD_INVOCATION_RECEIVER [26684,26687]
                            SimpleName: uri [26684,26687]
                        SimpleName: split [26688,26693]
                        METHOD_INVOCATION_ARGUMENTS [26694,26697]
                            StringLiteral: "/" [26694,26697]
            IfStatement [26778,26897]
                InfixExpression [26782,26839]
                    InfixExpression [26782,26807]
                        QualifiedName: pathComponents.length [26782,26803]
                        INFIX_EXPRESSION_OPERATOR: > [26804,26805]
                        NumberLiteral: 1 [26806,26807]
                    INFIX_EXPRESSION_OPERATOR: && [26808,26810]
                    PrefixExpression [26811,26839]
                        PREFIX_EXPRESSION_OPERATOR: ! [26811,26812]
                        MethodInvocation [26812,26839]
                            METHOD_INVOCATION_RECEIVER [26812,26829]
                                ArrayAccess [26812,26829]
                                    SimpleName: pathComponents [26812,26826]
                                    NumberLiteral: 1 [26827,26828]
                            SimpleName: isEmpty [26830,26837]
                Block [26841,26897]
                    ExpressionStatement [26856,26886]
                        Assignment [26856,26885]
                            SimpleName: queueType [26856,26865]
                            ASSIGNMENT_OPERATOR: = [26866,26867]
                            ArrayAccess [26868,26885]
                                SimpleName: pathComponents [26868,26882]
                                NumberLiteral: 1 [26883,26884]
            IfStatement [26907,27023]
                InfixExpression [26911,26968]
                    InfixExpression [26911,26936]
                        QualifiedName: pathComponents.length [26911,26932]
                        INFIX_EXPRESSION_OPERATOR: > [26933,26934]
                        NumberLiteral: 2 [26935,26936]
                    INFIX_EXPRESSION_OPERATOR: && [26937,26939]
                    PrefixExpression [26940,26968]
                        PREFIX_EXPRESSION_OPERATOR: ! [26940,26941]
                        MethodInvocation [26941,26968]
                            METHOD_INVOCATION_RECEIVER [26941,26958]
                                ArrayAccess [26941,26958]
                                    SimpleName: pathComponents [26941,26955]
                                    NumberLiteral: 2 [26956,26957]
                            SimpleName: isEmpty [26959,26966]
                Block [26970,27023]
                    ExpressionStatement [26985,27012]
                        Assignment [26985,27011]
                            SimpleName: userId [26985,26991]
                            ASSIGNMENT_OPERATOR: = [26992,26993]
                            ArrayAccess [26994,27011]
                                SimpleName: pathComponents [26994,27008]
                                NumberLiteral: 2 [27009,27010]
            IfStatement [27033,27150]
                InfixExpression [27037,27094]
                    InfixExpression [27037,27062]
                        QualifiedName: pathComponents.length [27037,27058]
                        INFIX_EXPRESSION_OPERATOR: > [27059,27060]
                        NumberLiteral: 3 [27061,27062]
                    INFIX_EXPRESSION_OPERATOR: && [27063,27065]
                    PrefixExpression [27066,27094]
                        PREFIX_EXPRESSION_OPERATOR: ! [27066,27067]
                        MethodInvocation [27067,27094]
                            METHOD_INVOCATION_RECEIVER [27067,27084]
                                ArrayAccess [27067,27084]
                                    SimpleName: pathComponents [27067,27081]
                                    NumberLiteral: 3 [27082,27083]
                            SimpleName: isEmpty [27085,27092]
                Block [27096,27150]
                    ExpressionStatement [27111,27139]
                        Assignment [27111,27138]
                            SimpleName: graphId [27111,27118]
                            ASSIGNMENT_OPERATOR: = [27119,27120]
                            ArrayAccess [27121,27138]
                                SimpleName: pathComponents [27121,27135]
                                NumberLiteral: 3 [27136,27137]
            IfStatement [27160,27275]
                InfixExpression [27164,27221]
                    InfixExpression [27164,27189]
                        QualifiedName: pathComponents.length [27164,27185]
                        INFIX_EXPRESSION_OPERATOR: > [27186,27187]
                        NumberLiteral: 4 [27188,27189]
                    INFIX_EXPRESSION_OPERATOR: && [27190,27192]
                    PrefixExpression [27193,27221]
                        PREFIX_EXPRESSION_OPERATOR: ! [27193,27194]
                        MethodInvocation [27194,27221]
                            METHOD_INVOCATION_RECEIVER [27194,27211]
                                ArrayAccess [27194,27211]
                                    SimpleName: pathComponents [27194,27208]
                                    NumberLiteral: 4 [27209,27210]
                            SimpleName: isEmpty [27212,27219]
                Block [27223,27275]
                    ExpressionStatement [27238,27264]
                        Assignment [27238,27263]
                            SimpleName: jobId [27238,27243]
                            ASSIGNMENT_OPERATOR: = [27244,27245]
                            ArrayAccess [27246,27263]
                                SimpleName: pathComponents [27246,27260]
                                NumberLiteral: 4 [27261,27262]
            IfStatement [27285,27419]
                InfixExpression [27289,27346]
                    InfixExpression [27289,27314]
                        QualifiedName: pathComponents.length [27289,27310]
                        INFIX_EXPRESSION_OPERATOR: > [27311,27312]
                        NumberLiteral: 5 [27313,27314]
                    INFIX_EXPRESSION_OPERATOR: && [27315,27317]
                    PrefixExpression [27318,27346]
                        PREFIX_EXPRESSION_OPERATOR: ! [27318,27319]
                        MethodInvocation [27319,27346]
                            METHOD_INVOCATION_RECEIVER [27319,27336]
                                ArrayAccess [27319,27336]
                                    SimpleName: pathComponents [27319,27333]
                                    NumberLiteral: 5 [27334,27335]
                            SimpleName: isEmpty [27337,27344]
                Block [27348,27419]
                    ExpressionStatement [27363,27408]
                        Assignment [27363,27407]
                            SimpleName: taskId [27363,27369]
                            ASSIGNMENT_OPERATOR: = [27370,27371]
                            MethodInvocation [27372,27407]
                                METHOD_INVOCATION_RECEIVER [27372,27379]
                                    SimpleName: Integer [27372,27379]
                                SimpleName: parseInt [27380,27388]
                                METHOD_INVOCATION_ARGUMENTS [27389,27406]
                                    ArrayAccess [27389,27406]
                                        SimpleName: pathComponents [27389,27403]
                                        NumberLiteral: 5 [27404,27405]
    MethodDeclaration [27434,28155]
        MarkerAnnotation [27434,27443]
            SimpleName: Override [27435,27443]
        Modifier: public [27449,27455]
        PrimitiveType: boolean [27456,27463]
        SimpleName: equals [27464,27470]
        SingleVariableDeclaration [27471,27479]
            SimpleType [27471,27477]
                SimpleName: Object [27471,27477]
            SimpleName: o [27478,27479]
        Block [27481,28155]
            IfStatement [27492,27519]
                InfixExpression [27496,27505]
                    ThisExpression [27496,27500]
                    INFIX_EXPRESSION_OPERATOR: == [27501,27503]
                    SimpleName: o [27504,27505]
                ReturnStatement [27507,27519]
                    BooleanLiteral: true [27514,27518]
            IfStatement [27529,27587]
                InfixExpression [27533,27572]
                    InfixExpression [27533,27542]
                        SimpleName: o [27533,27534]
                        INFIX_EXPRESSION_OPERATOR: == [27535,27537]
                        NullLiteral [27538,27542]
                    INFIX_EXPRESSION_OPERATOR: || [27543,27545]
                    InfixExpression [27546,27572]
                        MethodInvocation [27546,27556]
                            SimpleName: getClass [27546,27554]
                        INFIX_EXPRESSION_OPERATOR: != [27557,27559]
                        MethodInvocation [27560,27572]
                            METHOD_INVOCATION_RECEIVER [27560,27561]
                                SimpleName: o [27560,27561]
                            SimpleName: getClass [27562,27570]
                ReturnStatement [27574,27587]
                    BooleanLiteral: false [27581,27586]
            VariableDeclarationStatement [27599,27635]
                SimpleType [27599,27608]
                    SimpleName: QueuePath [27599,27608]
                VariableDeclarationFragment [27609,27634]
                    SimpleName: queuePath [27609,27618]
                    CastExpression [27621,27634]
                        SimpleType [27622,27631]
                            SimpleName: QueuePath [27622,27631]
                        SimpleName: o [27633,27634]
            IfStatement [27647,27692]
                InfixExpression [27651,27677]
                    SimpleName: taskId [27651,27657]
                    INFIX_EXPRESSION_OPERATOR: != [27658,27660]
                    QualifiedName: queuePath.taskId [27661,27677]
                ReturnStatement [27679,27692]
                    BooleanLiteral: false [27686,27691]
            IfStatement [27702,27801]
                ConditionalExpression [27706,27786]
                    InfixExpression [27706,27721]
                        SimpleName: graphId [27706,27713]
                        INFIX_EXPRESSION_OPERATOR: != [27714,27716]
                        NullLiteral [27717,27721]
                    PrefixExpression [27724,27758]
                        PREFIX_EXPRESSION_OPERATOR: ! [27724,27725]
                        MethodInvocation [27725,27758]
                            METHOD_INVOCATION_RECEIVER [27725,27732]
                                SimpleName: graphId [27725,27732]
                            SimpleName: equals [27733,27739]
                            METHOD_INVOCATION_ARGUMENTS [27740,27757]
                                QualifiedName: queuePath.graphId [27740,27757]
                    InfixExpression [27761,27786]
                        QualifiedName: queuePath.graphId [27761,27778]
                        INFIX_EXPRESSION_OPERATOR: != [27779,27781]
                        NullLiteral [27782,27786]
                ReturnStatement [27788,27801]
                    BooleanLiteral: false [27795,27800]
            IfStatement [27811,27902]
                ConditionalExpression [27815,27887]
                    InfixExpression [27815,27828]
                        SimpleName: jobId [27815,27820]
                        INFIX_EXPRESSION_OPERATOR: != [27821,27823]
                        NullLiteral [27824,27828]
                    PrefixExpression [27831,27861]
                        PREFIX_EXPRESSION_OPERATOR: ! [27831,27832]
                        MethodInvocation [27832,27861]
                            METHOD_INVOCATION_RECEIVER [27832,27837]
                                SimpleName: jobId [27832,27837]
                            SimpleName: equals [27838,27844]
                            METHOD_INVOCATION_ARGUMENTS [27845,27860]
                                QualifiedName: queuePath.jobId [27845,27860]
                    InfixExpression [27864,27887]
                        QualifiedName: queuePath.jobId [27864,27879]
                        INFIX_EXPRESSION_OPERATOR: != [27880,27882]
                        NullLiteral [27883,27887]
                ReturnStatement [27889,27902]
                    BooleanLiteral: false [27896,27901]
            IfStatement [27912,28019]
                ConditionalExpression [27916,28004]
                    InfixExpression [27916,27933]
                        SimpleName: queueType [27916,27925]
                        INFIX_EXPRESSION_OPERATOR: != [27926,27928]
                        NullLiteral [27929,27933]
                    PrefixExpression [27936,27974]
                        PREFIX_EXPRESSION_OPERATOR: ! [27936,27937]
                        MethodInvocation [27937,27974]
                            METHOD_INVOCATION_RECEIVER [27937,27946]
                                SimpleName: queueType [27937,27946]
                            SimpleName: equals [27947,27953]
                            METHOD_INVOCATION_ARGUMENTS [27954,27973]
                                QualifiedName: queuePath.queueType [27954,27973]
                    InfixExpression [27977,28004]
                        QualifiedName: queuePath.queueType [27977,27996]
                        INFIX_EXPRESSION_OPERATOR: != [27997,27999]
                        NullLiteral [28000,28004]
                ReturnStatement [28006,28019]
                    BooleanLiteral: false [28013,28018]
            IfStatement [28029,28124]
                ConditionalExpression [28033,28109]
                    InfixExpression [28033,28047]
                        SimpleName: userId [28033,28039]
                        INFIX_EXPRESSION_OPERATOR: != [28040,28042]
                        NullLiteral [28043,28047]
                    PrefixExpression [28050,28082]
                        PREFIX_EXPRESSION_OPERATOR: ! [28050,28051]
                        MethodInvocation [28051,28082]
                            METHOD_INVOCATION_RECEIVER [28051,28057]
                                SimpleName: userId [28051,28057]
                            SimpleName: equals [28058,28064]
                            METHOD_INVOCATION_ARGUMENTS [28065,28081]
                                QualifiedName: queuePath.userId [28065,28081]
                    InfixExpression [28085,28109]
                        QualifiedName: queuePath.userId [28085,28101]
                        INFIX_EXPRESSION_OPERATOR: != [28102,28104]
                        NullLiteral [28105,28109]
                ReturnStatement [28111,28124]
                    BooleanLiteral: false [28118,28123]
            ReturnStatement [28136,28148]
                BooleanLiteral: true [28143,28147]
    MethodDeclaration [28163,28562]
        MarkerAnnotation [28163,28172]
            SimpleName: Override [28164,28172]
        Modifier: public [28178,28184]
        PrimitiveType: int [28185,28188]
        SimpleName: hashCode [28189,28197]
        Block [28200,28562]
            VariableDeclarationStatement [28211,28269]
                PrimitiveType: int [28211,28214]
                VariableDeclarationFragment [28215,28268]
                    SimpleName: result [28215,28221]
                    ConditionalExpression [28224,28268]
                        InfixExpression [28224,28241]
                            SimpleName: queueType [28224,28233]
                            INFIX_EXPRESSION_OPERATOR: != [28234,28236]
                            NullLiteral [28237,28241]
                        MethodInvocation [28244,28264]
                            METHOD_INVOCATION_RECEIVER [28244,28253]
                                SimpleName: queueType [28244,28253]
                            SimpleName: hashCode [28254,28262]
                        NumberLiteral: 0 [28267,28268]
            ExpressionStatement [28279,28343]
                Assignment [28279,28342]
                    SimpleName: result [28279,28285]
                    ASSIGNMENT_OPERATOR: = [28286,28287]
                    InfixExpression [28288,28342]
                        InfixExpression [28288,28299]
                            NumberLiteral: 31 [28288,28290]
                            INFIX_EXPRESSION_OPERATOR: * [28291,28292]
                            SimpleName: result [28293,28299]
                        INFIX_EXPRESSION_OPERATOR: + [28300,28301]
                        ParenthesizedExpression [28302,28342]
                            ConditionalExpression [28303,28341]
                                InfixExpression [28303,28317]
                                    SimpleName: userId [28303,28309]
                                    INFIX_EXPRESSION_OPERATOR: != [28310,28312]
                                    NullLiteral [28313,28317]
                                MethodInvocation [28320,28337]
                                    METHOD_INVOCATION_RECEIVER [28320,28326]
                                        SimpleName: userId [28320,28326]
                                    SimpleName: hashCode [28327,28335]
                                NumberLiteral: 0 [28340,28341]
            ExpressionStatement [28353,28419]
                Assignment [28353,28418]
                    SimpleName: result [28353,28359]
                    ASSIGNMENT_OPERATOR: = [28360,28361]
                    InfixExpression [28362,28418]
                        InfixExpression [28362,28373]
                            NumberLiteral: 31 [28362,28364]
                            INFIX_EXPRESSION_OPERATOR: * [28365,28366]
                            SimpleName: result [28367,28373]
                        INFIX_EXPRESSION_OPERATOR: + [28374,28375]
                        ParenthesizedExpression [28376,28418]
                            ConditionalExpression [28377,28417]
                                InfixExpression [28377,28392]
                                    SimpleName: graphId [28377,28384]
                                    INFIX_EXPRESSION_OPERATOR: != [28385,28387]
                                    NullLiteral [28388,28392]
                                MethodInvocation [28395,28413]
                                    METHOD_INVOCATION_RECEIVER [28395,28402]
                                        SimpleName: graphId [28395,28402]
                                    SimpleName: hashCode [28403,28411]
                                NumberLiteral: 0 [28416,28417]
            ExpressionStatement [28429,28491]
                Assignment [28429,28490]
                    SimpleName: result [28429,28435]
                    ASSIGNMENT_OPERATOR: = [28436,28437]
                    InfixExpression [28438,28490]
                        InfixExpression [28438,28449]
                            NumberLiteral: 31 [28438,28440]
                            INFIX_EXPRESSION_OPERATOR: * [28441,28442]
                            SimpleName: result [28443,28449]
                        INFIX_EXPRESSION_OPERATOR: + [28450,28451]
                        ParenthesizedExpression [28452,28490]
                            ConditionalExpression [28453,28489]
                                InfixExpression [28453,28466]
                                    SimpleName: jobId [28453,28458]
                                    INFIX_EXPRESSION_OPERATOR: != [28459,28461]
                                    NullLiteral [28462,28466]
                                MethodInvocation [28469,28485]
                                    METHOD_INVOCATION_RECEIVER [28469,28474]
                                        SimpleName: jobId [28469,28474]
                                    SimpleName: hashCode [28475,28483]
                                NumberLiteral: 0 [28488,28489]
            ExpressionStatement [28501,28531]
                Assignment [28501,28530]
                    SimpleName: result [28501,28507]
                    ASSIGNMENT_OPERATOR: = [28508,28509]
                    InfixExpression [28510,28530]
                        InfixExpression [28510,28521]
                            NumberLiteral: 31 [28510,28512]
                            INFIX_EXPRESSION_OPERATOR: * [28513,28514]
                            SimpleName: result [28515,28521]
                        INFIX_EXPRESSION_OPERATOR: + [28522,28523]
                        SimpleName: taskId [28524,28530]
            ReturnStatement [28541,28555]
                SimpleName: result [28548,28554]
    MethodDeclaration [28570,28907]
        MarkerAnnotation [28570,28579]
            SimpleName: Override [28571,28579]
        Modifier: public [28585,28591]
        SimpleType [28592,28598]
            SimpleName: String [28592,28598]
        SimpleName: toString [28599,28607]
        Block [28610,28907]
            ReturnStatement [28621,28900]
                InfixExpression [28628,28899]
                    InfixExpression [28628,28673]
                        StringLiteral: "QueuePath{" [28628,28640]
                        INFIX_EXPRESSION_OPERATOR: + [28641,28642]
                        StringLiteral: "queueType='" [28660,28673]
                    INFIX_EXPRESSION_OPERATOR: + [28674,28675]
                    SimpleName: queueType [28676,28685]
                    CharacterLiteral: '\'' [28688,28692]
                    StringLiteral: ", userId='" [28712,28724]
                    SimpleName: userId [28727,28733]
                    CharacterLiteral: '\'' [28736,28740]
                    StringLiteral: ", graphId='" [28760,28773]
                    SimpleName: graphId [28776,28783]
                    CharacterLiteral: '\'' [28786,28790]
                    StringLiteral: ", jobId='" [28810,28821]
                    SimpleName: jobId [28824,28829]
                    CharacterLiteral: '\'' [28832,28836]
                    StringLiteral: ", taskId=" [28856,28867]
                    SimpleName: taskId [28870,28876]
                    CharacterLiteral: '}' [28896,28899]
to
CompilationUnit [0,24732]
at 117
===
insert-tree
---
TypeDeclaration [29034,29101]
    Javadoc [29034,29046]
    Modifier: public [29048,29054]
    TYPE_DECLARATION_KIND: class [29055,29060]
    SimpleName: QueueType [29061,29070]
    FieldDeclaration [29080,29094]
        SimpleType [29080,29086]
            SimpleName: String [29080,29086]
        VariableDeclarationFragment [29087,29093]
            SimpleName: typeId [29087,29093]
to
CompilationUnit [0,24732]
at 118
===
insert-node
---
TypeDeclaration [29220,29892]
to
CompilationUnit [0,24732]
at 119
===
insert-tree
---
Javadoc [653,2658]
    TagElement [661,2653]
        TextElement: This class watches for incoming requests for work tasks, and attempts to match them to enqueued tasks. [661,763]
        TextElement: It draws tasks fairly from all users, and fairly from all jobs within each user, while attempting to respect the [768,880]
        TextElement: cache affinity of each worker (give it tasks on the same graph it has been working on recently). [885,981]
        TextElement: When no work is available, the polling functions return immediately. Workers are expected to sleep and re-poll [990,1100]
        TextElement: after a few tens of seconds. [1105,1133]
        TextElement: TODO if there is a backlog of work (the usual case when jobs are lined up) workers will constantly change graphs [1142,1254]
        TextElement: We need a queue of deferred work: (job, timestamp) when a job would have fairly had its work consumed  if a worker was available. [1259,1388]
        TextElement: Anything that survives at the head of that queue for more than e.g. one minute gets forced on a non-affinity worker. [1393,1509]
        TextElement: Any new workers without an affinity preferentially pull work off the deferred queue. [1514,1598]
        TextElement: Polling worker connections scan the deferred queue before ever going to the main circular queue. [1603,1699]
        TextElement: When the deferred queue exceeds a certain size, that's when we must start more workers. [1704,1791]
        TextElement: We should distinguish between two cases: [1800,1840]
        TextElement: 1. we were waiting for work and woke up because work became available. [1845,1915]
        TextElement: 2. we were waiting for a consumer and woke up when one arrived. [1920,1983]
        TextElement: The first case implies that many workers should migrate toward the new work. [1992,2068]
        TextElement: Two key ideas are: [2077,2095]
        TextElement: 1. Least recently serviced queue of jobs [2100,2140]
        TextElement: 2. Affinity Homeostasis [2145,2168]
        TextElement: If we can constantly keep track of the ideal proportion of workers by graph (based on active queues), [2177,2278]
        TextElement: and the true proportion of consumers by graph (based on incoming requests) then we can decide when a worker's graph [2283,2398]
        TextElement: affinity should be ignored. [2403,2430]
        TextElement: It may also be helpful to mark jobs every time they are skipped in the LRU queue. Each time a job is serviced, [2439,2549]
        TextElement: it is taken out of the queue and put at its end. Jobs that have not been serviced float to the top. [2554,2653]
to
TypeDeclaration [653,12783]
at 0
===
insert-node
---
Modifier: public [2660,2666]
to
TypeDeclaration [653,12783]
at 1
===
insert-node
---
TYPE_DECLARATION_KIND: class [2667,2672]
to
TypeDeclaration [653,12783]
at 2
===
insert-node
---
SimpleName: Broker [2673,2679]
to
TypeDeclaration [653,12783]
at 3
===
insert-tree
---
SimpleType [2691,2699]
    SimpleName: Runnable [2691,2699]
to
TypeDeclaration [653,12783]
at 4
===
insert-tree
---
FieldDeclaration [2819,2891]
    Modifier: private [2819,2826]
    Modifier: static [2827,2833]
    Modifier: final [2834,2839]
    SimpleType [2840,2846]
        SimpleName: Logger [2840,2846]
    VariableDeclarationFragment [2847,2890]
        SimpleName: LOG [2847,2850]
        MethodInvocation [2853,2890]
            METHOD_INVOCATION_RECEIVER [2853,2866]
                SimpleName: LoggerFactory [2853,2866]
            SimpleName: getLogger [2867,2876]
            METHOD_INVOCATION_ARGUMENTS [2877,2889]
                TypeLiteral [2877,2889]
                    SimpleType [2877,2883]
                        SimpleName: Broker [2877,2883]
to
TypeDeclaration [653,12783]
at 5
===
insert-tree
---
FieldDeclaration [2899,2955]
    Modifier: private [2899,2906]
    ParameterizedType [2907,2925]
        SimpleType [2907,2919]
            SimpleName: CircularList [2907,2919]
        SimpleType [2920,2924]
            SimpleName: User [2920,2924]
    VariableDeclarationFragment [2926,2954]
        SimpleName: users [2926,2931]
        ClassInstanceCreation [2934,2954]
            ParameterizedType [2938,2952]
                SimpleType [2938,2950]
                    SimpleName: CircularList [2938,2950]
to
TypeDeclaration [653,12783]
at 6
===
insert-tree
---
FieldDeclaration [2963,2997]
    Modifier: private [2963,2970]
    PrimitiveType: int [2971,2974]
    VariableDeclarationFragment [2975,2996]
        SimpleName: nUndeliveredTasks [2975,2992]
        NumberLiteral: 0 [2995,2996]
to
TypeDeclaration [653,12783]
at 7
===
insert-tree
---
FieldDeclaration [3005,3039]
    Modifier: private [3005,3012]
    PrimitiveType: int [3013,3016]
    VariableDeclarationFragment [3017,3038]
        SimpleName: nWaitingConsumers [3017,3034]
        NumberLiteral: 0 [3037,3038]
to
TypeDeclaration [653,12783]
at 8
===
insert-tree
---
FieldDeclaration [3086,3113]
    Modifier: private [3086,3093]
    PrimitiveType: int [3094,3097]
    VariableDeclarationFragment [3098,3112]
        SimpleName: nextTaskId [3098,3108]
        NumberLiteral: 0 [3111,3112]
to
TypeDeclaration [653,12783]
at 9
===
insert-tree
---
FieldDeclaration [3121,3170]
    Modifier: private [3121,3128]
    SimpleType [3129,3141]
        SimpleName: ObjectMapper [3129,3141]
    VariableDeclarationFragment [3142,3169]
        SimpleName: mapper [3142,3148]
        ClassInstanceCreation [3151,3169]
            SimpleType [3155,3167]
                SimpleName: ObjectMapper [3155,3167]
to
TypeDeclaration [653,12783]
at 10
===
insert-node
---
FieldDeclaration [3178,3336]
to
TypeDeclaration [653,12783]
at 11
===
insert-tree
---
MethodDeclaration [3443,4225]
    Modifier: public [3443,3449]
    Modifier: synchronized [3450,3462]
    PrimitiveType: void [3463,3467]
    SimpleName: enqueueTasks [3468,3480]
    SingleVariableDeclaration [3482,3501]
        SimpleType [3482,3491]
            SimpleName: QueuePath [3482,3491]
        SimpleName: queuePath [3492,3501]
    SingleVariableDeclaration [3503,3542]
        ParameterizedType [3503,3536]
            SimpleType [3503,3513]
                SimpleName: Collection [3503,3513]
            SimpleType [3514,3535]
                SimpleName: AnalystClusterRequest [3514,3535]
        SimpleName: tasks [3537,3542]
    Block [3544,4225]
        ExpressionStatement [3555,3588]
            MethodInvocation [3555,3587]
                METHOD_INVOCATION_RECEIVER [3555,3558]
                    SimpleName: LOG [3555,3558]
                SimpleName: debug [3559,3564]
                METHOD_INVOCATION_ARGUMENTS [3565,3586]
                    StringLiteral: "Queue {}" [3565,3575]
                    SimpleName: queuePath [3577,3586]
        VariableDeclarationStatement [3675,3720]
            SimpleType [3675,3679]
                SimpleName: User [3675,3679]
            VariableDeclarationFragment [3680,3719]
                SimpleName: user [3680,3684]
                MethodInvocation [3687,3719]
                    SimpleName: findUser [3687,3695]
                    METHOD_INVOCATION_ARGUMENTS [3696,3718]
                        QualifiedName: queuePath.userId [3696,3712]
                        BooleanLiteral: true [3714,3718]
        VariableDeclarationStatement [3730,3776]
            SimpleType [3730,3733]
                SimpleName: Job [3730,3733]
            VariableDeclarationFragment [3734,3775]
                SimpleName: job [3734,3737]
                MethodInvocation [3740,3775]
                    METHOD_INVOCATION_RECEIVER [3740,3744]
                        SimpleName: user [3740,3744]
                    SimpleName: findJob [3745,3752]
                    METHOD_INVOCATION_ARGUMENTS [3753,3774]
                        QualifiedName: queuePath.jobId [3753,3768]
                        BooleanLiteral: true [3770,3774]
        EnhancedForStatement [3786,4030]
            SingleVariableDeclaration [3791,3817]
                SimpleType [3791,3812]
                    SimpleName: AnalystClusterRequest [3791,3812]
                SimpleName: task [3813,3817]
            SimpleName: tasks [3820,3825]
            Block [3827,4030]
                ExpressionStatement [3842,3869]
                    Assignment [3842,3868]
                        QualifiedName: task.taskId [3842,3853]
                        ASSIGNMENT_OPERATOR: = [3854,3855]
                        PostfixExpression [3856,3868]
                            SimpleName: nextTaskId [3856,3866]
                            POSTFIX_EXPRESSION_OPERATOR: ++ [3866,3868]
                ExpressionStatement [3883,3901]
                    MethodInvocation [3883,3900]
                        METHOD_INVOCATION_RECEIVER [3883,3886]
                            SimpleName: job [3883,3886]
                        SimpleName: addTask [3887,3894]
                        METHOD_INVOCATION_ARGUMENTS [3895,3899]
                            SimpleName: task [3895,3899]
                ExpressionStatement [3915,3938]
                    Assignment [3915,3937]
                        SimpleName: nUndeliveredTasks [3915,3932]
                        ASSIGNMENT_OPERATOR: += [3933,3935]
                        NumberLiteral: 1 [3936,3937]
                ExpressionStatement [3952,4019]
                    MethodInvocation [3952,4018]
                        METHOD_INVOCATION_RECEIVER [3952,3955]
                            SimpleName: LOG [3952,3955]
                        SimpleName: debug [3956,3961]
                        METHOD_INVOCATION_ARGUMENTS [3962,4017]
                            StringLiteral: "Enqueued task id {} in job {}" [3962,3993]
                            QualifiedName: task.taskId [3995,4006]
                            QualifiedName: job.jobId [4008,4017]
        ExpressionStatement [4209,4218]
            MethodInvocation [4209,4217]
                SimpleName: notify [4209,4215]
to
TypeDeclaration [653,12783]
at 12
===
insert-tree
---
MethodDeclaration [4233,4952]
    Javadoc [4233,4279]
        TagElement [4237,4277]
            TextElement: Long poll operations are enqueued here.  [4237,4277]
    Modifier: public [4285,4291]
    Modifier: synchronized [4292,4304]
    PrimitiveType: void [4305,4309]
    SimpleName: registerSuspendedResponse [4310,4335]
    SingleVariableDeclaration [4336,4350]
        SimpleType [4336,4342]
            SimpleName: String [4336,4342]
        SimpleName: graphId [4343,4350]
    SingleVariableDeclaration [4352,4369]
        SimpleType [4352,4360]
            SimpleName: Response [4352,4360]
        SimpleName: response [4361,4369]
    Block [4371,4952]
        VariableDeclarationStatement [4495,4552]
            ParameterizedType [4495,4510]
                SimpleType [4495,4500]
                    SimpleName: Deque [4495,4500]
                SimpleType [4501,4509]
                    SimpleName: Response [4501,4509]
            VariableDeclarationFragment [4511,4551]
                SimpleName: deque [4511,4516]
                MethodInvocation [4519,4551]
                    METHOD_INVOCATION_RECEIVER [4519,4538]
                        SimpleName: connectionsForGraph [4519,4538]
                    SimpleName: get [4539,4542]
                    METHOD_INVOCATION_ARGUMENTS [4543,4550]
                        SimpleName: graphId [4543,4550]
        IfStatement [4562,4688]
            InfixExpression [4566,4579]
                SimpleName: deque [4566,4571]
                INFIX_EXPRESSION_OPERATOR: == [4572,4574]
                NullLiteral [4575,4579]
            Block [4581,4688]
                ExpressionStatement [4596,4623]
                    Assignment [4596,4622]
                        SimpleName: deque [4596,4601]
                        ASSIGNMENT_OPERATOR: = [4602,4603]
                        ClassInstanceCreation [4604,4622]
                            ParameterizedType [4608,4620]
                                SimpleType [4608,4618]
                                    SimpleName: ArrayDeque [4608,4618]
                ExpressionStatement [4637,4677]
                    MethodInvocation [4637,4676]
                        METHOD_INVOCATION_RECEIVER [4637,4656]
                            SimpleName: connectionsForGraph [4637,4656]
                        SimpleName: put [4657,4660]
                        METHOD_INVOCATION_ARGUMENTS [4661,4675]
                            SimpleName: graphId [4661,4668]
                            SimpleName: deque [4670,4675]
        ExpressionStatement [4698,4722]
            MethodInvocation [4698,4721]
                METHOD_INVOCATION_RECEIVER [4698,4703]
                    SimpleName: deque [4698,4703]
                SimpleName: addLast [4704,4711]
                METHOD_INVOCATION_ARGUMENTS [4712,4720]
                    SimpleName: response [4712,4720]
        ExpressionStatement [4732,4755]
            Assignment [4732,4754]
                SimpleName: nWaitingConsumers [4732,4749]
                ASSIGNMENT_OPERATOR: += [4750,4752]
                NumberLiteral: 1 [4753,4754]
        ExpressionStatement [4936,4945]
            MethodInvocation [4936,4944]
                SimpleName: notify [4936,4942]
to
TypeDeclaration [653,12783]
at 13
===
insert-tree
---
MethodDeclaration [4960,5508]
    Javadoc [4960,5040]
        TagElement [4964,5038]
            TextElement: When we notice that a long poll connection has closed, we remove it here.  [4964,5038]
    Modifier: public [5046,5052]
    Modifier: synchronized [5053,5065]
    PrimitiveType: boolean [5066,5073]
    SimpleName: removeSuspendedResponse [5074,5097]
    SingleVariableDeclaration [5098,5112]
        SimpleType [5098,5104]
            SimpleName: String [5098,5104]
        SimpleName: graphId [5105,5112]
    SingleVariableDeclaration [5114,5131]
        SimpleType [5114,5122]
            SimpleName: Response [5114,5122]
        SimpleName: response [5123,5131]
    Block [5133,5508]
        VariableDeclarationStatement [5144,5201]
            ParameterizedType [5144,5159]
                SimpleType [5144,5149]
                    SimpleName: Deque [5144,5149]
                SimpleType [5150,5158]
                    SimpleName: Response [5150,5158]
            VariableDeclarationFragment [5160,5200]
                SimpleName: deque [5160,5165]
                MethodInvocation [5168,5200]
                    METHOD_INVOCATION_RECEIVER [5168,5187]
                        SimpleName: connectionsForGraph [5168,5187]
                    SimpleName: get [5188,5191]
                    METHOD_INVOCATION_ARGUMENTS [5192,5199]
                        SimpleName: graphId [5192,5199]
        IfStatement [5211,5269]
            InfixExpression [5215,5228]
                SimpleName: deque [5215,5220]
                INFIX_EXPRESSION_OPERATOR: == [5221,5223]
                NullLiteral [5224,5228]
            Block [5230,5269]
                ReturnStatement [5245,5258]
                    BooleanLiteral: false [5252,5257]
        IfStatement [5279,5478]
            MethodInvocation [5283,5305]
                METHOD_INVOCATION_RECEIVER [5283,5288]
                    SimpleName: deque [5283,5288]
                SimpleName: remove [5289,5295]
                METHOD_INVOCATION_ARGUMENTS [5296,5304]
                    SimpleName: response [5296,5304]
            Block [5307,5478]
                ExpressionStatement [5322,5345]
                    Assignment [5322,5344]
                        SimpleName: nWaitingConsumers [5322,5339]
                        ASSIGNMENT_OPERATOR: -= [5340,5342]
                        NumberLiteral: 1 [5343,5344]
                ExpressionStatement [5359,5410]
                    MethodInvocation [5359,5409]
                        METHOD_INVOCATION_RECEIVER [5359,5362]
                            SimpleName: LOG [5359,5362]
                        SimpleName: debug [5363,5368]
                        METHOD_INVOCATION_ARGUMENTS [5369,5408]
                            StringLiteral: "Removed closed connection from queue." [5369,5408]
                ExpressionStatement [5424,5441]
                    MethodInvocation [5424,5440]
                        SimpleName: logQueueStatus [5424,5438]
                ReturnStatement [5455,5467]
                    BooleanLiteral: true [5462,5466]
        ReturnStatement [5488,5501]
            BooleanLiteral: false [5495,5500]
to
TypeDeclaration [653,12783]
at 14
===
insert-tree
---
MethodDeclaration [5516,5659]
    Modifier: private [5516,5523]
    PrimitiveType: void [5524,5528]
    SimpleName: logQueueStatus [5529,5543]
    Block [5546,5659]
        ExpressionStatement [5557,5652]
            MethodInvocation [5557,5651]
                METHOD_INVOCATION_RECEIVER [5557,5560]
                    SimpleName: LOG [5557,5560]
                SimpleName: info [5561,5565]
                METHOD_INVOCATION_ARGUMENTS [5566,5650]
                    StringLiteral: "Status {} undelivered, {} consumers waiting." [5566,5612]
                    SimpleName: nUndeliveredTasks [5614,5631]
                    SimpleName: nWaitingConsumers [5633,5650]
to
TypeDeclaration [653,12783]
at 15
===
insert-tree
---
MethodDeclaration [5667,9135]
    Javadoc [5667,5862]
        TagElement [5679,5853]
            TextElement: Pull the next job queue with undelivered work fairly from users and jobs. [5679,5752]
            TextElement: Pass some of that work to a worker, blocking if necessary until there are workers available. [5761,5853]
    Modifier: public [5868,5874]
    Modifier: synchronized [5875,5887]
    PrimitiveType: void [5888,5892]
    SimpleName: deliverTasksForOneJob [5893,5914]
    SimpleType [5925,5945]
        SimpleName: InterruptedException [5925,5945]
    Block [5946,9135]
        WhileStatement [6016,6219]
            InfixExpression [6023,6045]
                SimpleName: nUndeliveredTasks [6023,6040]
                INFIX_EXPRESSION_OPERATOR: == [6041,6043]
                NumberLiteral: 0 [6044,6045]
            Block [6047,6219]
                ExpressionStatement [6062,6156]
                    MethodInvocation [6062,6155]
                        METHOD_INVOCATION_RECEIVER [6062,6065]
                            SimpleName: LOG [6062,6065]
                        SimpleName: debug [6066,6071]
                        METHOD_INVOCATION_ARGUMENTS [6072,6154]
                            StringLiteral: "Task delivery thread is going to sleep, there are no tasks waiting for delivery." [6072,6154]
                ExpressionStatement [6170,6187]
                    MethodInvocation [6170,6186]
                        SimpleName: logQueueStatus [6170,6184]
                ExpressionStatement [6201,6208]
                    MethodInvocation [6201,6207]
                        SimpleName: wait [6201,6205]
        ExpressionStatement [6229,6310]
            MethodInvocation [6229,6309]
                METHOD_INVOCATION_RECEIVER [6229,6232]
                    SimpleName: LOG [6229,6232]
                SimpleName: debug [6233,6238]
                METHOD_INVOCATION_ARGUMENTS [6239,6308]
                    StringLiteral: "Task delivery thread is awake and there are some undelivered tasks." [6239,6308]
        ExpressionStatement [6320,6337]
            MethodInvocation [6320,6336]
                SimpleName: logQueueStatus [6320,6334]
        VariableDeclarationStatement [6424,6439]
            SimpleType [6424,6427]
                SimpleName: Job [6424,6427]
            VariableDeclarationFragment [6428,6438]
                SimpleName: job [6428,6431]
                NullLiteral [6434,6438]
        WhileStatement [6449,6766]
            InfixExpression [6456,6467]
                SimpleName: job [6456,6459]
                INFIX_EXPRESSION_OPERATOR: == [6460,6462]
                NullLiteral [6463,6467]
            Block [6469,6766]
                VariableDeclarationStatement [6484,6512]
                    SimpleType [6484,6488]
                        SimpleName: User [6484,6488]
                    VariableDeclarationFragment [6489,6511]
                        SimpleName: user [6489,6493]
                        MethodInvocation [6496,6511]
                            METHOD_INVOCATION_RECEIVER [6496,6501]
                                SimpleName: users [6496,6501]
                            SimpleName: advance [6502,6509]
                IfStatement [6526,6676]
                    InfixExpression [6530,6542]
                        SimpleName: user [6530,6534]
                        INFIX_EXPRESSION_OPERATOR: == [6535,6537]
                        NullLiteral [6538,6542]
                    Block [6544,6676]
                        ExpressionStatement [6563,6661]
                            MethodInvocation [6563,6660]
                                METHOD_INVOCATION_RECEIVER [6563,6566]
                                    SimpleName: LOG [6563,6566]
                                SimpleName: error [6567,6572]
                                METHOD_INVOCATION_ARGUMENTS [6573,6659]
                                    StringLiteral: "There should always be at least one user here, because there is an undelivered task." [6573,6659]
                ExpressionStatement [6690,6755]
                    Assignment [6690,6754]
                        SimpleName: job [6690,6693]
                        ASSIGNMENT_OPERATOR: = [6694,6695]
                        MethodInvocation [6696,6754]
                            METHOD_INVOCATION_RECEIVER [6696,6705]
                                QualifiedName: user.jobs [6696,6705]
                            SimpleName: advanceToElement [6706,6722]
                            METHOD_INVOCATION_ARGUMENTS [6723,6753]
                                LambdaExpression [6723,6753]
                                    VariableDeclarationFragment [6723,6724]
                                        SimpleName: e [6723,6724]
                                    InfixExpression [6728,6753]
                                        MethodInvocation [6728,6749]
                                            METHOD_INVOCATION_RECEIVER [6728,6742]
                                                QualifiedName: e.visibleTasks [6728,6742]
                                            SimpleName: size [6743,6747]
                                        INFIX_EXPRESSION_OPERATOR: > [6750,6751]
                                        NumberLiteral: 0 [6752,6753]
        ExpressionStatement [6949,7033]
            MethodInvocation [6949,7032]
                METHOD_INVOCATION_RECEIVER [6949,6952]
                    SimpleName: LOG [6949,6952]
                SimpleName: debug [6953,6958]
                METHOD_INVOCATION_ARGUMENTS [6959,7031]
                    StringLiteral: "Task delivery thread has found undelivered tasks in job {}." [6959,7020]
                    QualifiedName: job.jobId [7022,7031]
        WhileStatement [7043,9126]
            BooleanLiteral: true [7050,7054]
            Block [7056,9126]
                WhileStatement [7071,7340]
                    InfixExpression [7078,7100]
                        SimpleName: nWaitingConsumers [7078,7095]
                        INFIX_EXPRESSION_OPERATOR: == [7096,7098]
                        NumberLiteral: 0 [7099,7100]
                    Block [7102,7340]
                        ExpressionStatement [7121,7206]
                            MethodInvocation [7121,7205]
                                METHOD_INVOCATION_RECEIVER [7121,7124]
                                    SimpleName: LOG [7121,7124]
                                SimpleName: debug [7125,7130]
                                METHOD_INVOCATION_ARGUMENTS [7131,7204]
                                    StringLiteral: "Task delivery thread is going to sleep, there are no consumers waiting." [7131,7204]
                        ExpressionStatement [7318,7325]
                            MethodInvocation [7318,7324]
                                SimpleName: wait [7318,7322]
                ExpressionStatement [7354,7430]
                    MethodInvocation [7354,7429]
                        METHOD_INVOCATION_RECEIVER [7354,7357]
                            SimpleName: LOG [7354,7357]
                        SimpleName: debug [7358,7363]
                        METHOD_INVOCATION_ARGUMENTS [7364,7428]
                            StringLiteral: "Task delivery thread is awake, and some consumers are waiting." [7364,7428]
                ExpressionStatement [7444,7461]
                    MethodInvocation [7444,7460]
                        SimpleName: logQueueStatus [7444,7458]
                ExpressionStatement [7666,7740]
                    MethodInvocation [7666,7739]
                        METHOD_INVOCATION_RECEIVER [7666,7669]
                            SimpleName: LOG [7666,7669]
                        SimpleName: debug [7670,7675]
                        METHOD_INVOCATION_ARGUMENTS [7676,7738]
                            StringLiteral: "Looking for an eligible consumer, respecting graph affinity." [7676,7738]
                VariableDeclarationStatement [7754,7815]
                    ParameterizedType [7754,7769]
                        SimpleType [7754,7759]
                            SimpleName: Deque [7754,7759]
                        SimpleType [7760,7768]
                            SimpleName: Response [7760,7768]
                    VariableDeclarationFragment [7770,7814]
                        SimpleName: deque [7770,7775]
                        MethodInvocation [7778,7814]
                            METHOD_INVOCATION_RECEIVER [7778,7797]
                                SimpleName: connectionsForGraph [7778,7797]
                            SimpleName: get [7798,7801]
                            METHOD_INVOCATION_ARGUMENTS [7802,7813]
                                QualifiedName: job.graphId [7802,7813]
                WhileStatement [7829,8073]
                    InfixExpression [7836,7869]
                        InfixExpression [7836,7849]
                            SimpleName: deque [7836,7841]
                            INFIX_EXPRESSION_OPERATOR: != [7842,7844]
                            NullLiteral [7845,7849]
                        INFIX_EXPRESSION_OPERATOR: && [7850,7852]
                        PrefixExpression [7853,7869]
                            PREFIX_EXPRESSION_OPERATOR: ! [7853,7854]
                            MethodInvocation [7854,7869]
                                METHOD_INVOCATION_RECEIVER [7854,7859]
                                    SimpleName: deque [7854,7859]
                                SimpleName: isEmpty [7860,7867]
                    Block [7871,8073]
                        VariableDeclarationStatement [7890,7922]
                            SimpleType [7890,7898]
                                SimpleName: Response [7890,7898]
                            VariableDeclarationFragment [7899,7921]
                                SimpleName: response [7899,7907]
                                MethodInvocation [7910,7921]
                                    METHOD_INVOCATION_RECEIVER [7910,7915]
                                        SimpleName: deque [7910,7915]
                                    SimpleName: pop [7916,7919]
                        ExpressionStatement [7940,7963]
                            Assignment [7940,7962]
                                SimpleName: nWaitingConsumers [7940,7957]
                                ASSIGNMENT_OPERATOR: -= [7958,7960]
                                NumberLiteral: 1 [7961,7962]
                        IfStatement [7981,8058]
                            MethodInvocation [7985,8007]
                                SimpleName: deliver [7985,7992]
                                METHOD_INVOCATION_ARGUMENTS [7993,8006]
                                    SimpleName: job [7993,7996]
                                    SimpleName: response [7998,8006]
                            Block [8009,8058]
                                ReturnStatement [8032,8039]
                ExpressionStatement [8169,8246]
                    MethodInvocation [8169,8245]
                        METHOD_INVOCATION_RECEIVER [8169,8172]
                            SimpleName: LOG [8169,8172]
                        SimpleName: debug [8173,8178]
                        METHOD_INVOCATION_ARGUMENTS [8179,8244]
                            StringLiteral: "No consumers with the right affinity. Looking for any consumer." [8179,8244]
                VariableDeclarationStatement [8260,8337]
                    ParameterizedType [8260,8281]
                        SimpleType [8260,8264]
                            SimpleName: List [8260,8264]
                        ParameterizedType [8265,8280]
                            SimpleType [8265,8270]
                                SimpleName: Deque [8265,8270]
                            SimpleType [8271,8279]
                                SimpleName: Response [8271,8279]
                    VariableDeclarationFragment [8282,8336]
                        SimpleName: deques [8282,8288]
                        ClassInstanceCreation [8291,8336]
                            ParameterizedType [8295,8306]
                                SimpleType [8295,8304]
                                    SimpleName: ArrayList [8295,8304]
                            MethodInvocation [8307,8335]
                                METHOD_INVOCATION_RECEIVER [8307,8326]
                                    SimpleName: connectionsForGraph [8307,8326]
                                SimpleName: values [8327,8333]
                ExpressionStatement [8351,8414]
                    MethodInvocation [8351,8413]
                        METHOD_INVOCATION_RECEIVER [8351,8357]
                            SimpleName: deques [8351,8357]
                        SimpleName: sort [8358,8362]
                        METHOD_INVOCATION_ARGUMENTS [8363,8412]
                            LambdaExpression [8363,8412]
                                VariableDeclarationFragment [8364,8366]
                                    SimpleName: d1 [8364,8366]
                                VariableDeclarationFragment [8368,8370]
                                    SimpleName: d2 [8368,8370]
                                MethodInvocation [8375,8412]
                                    METHOD_INVOCATION_RECEIVER [8375,8382]
                                        SimpleName: Integer [8375,8382]
                                    SimpleName: compare [8383,8390]
                                    METHOD_INVOCATION_ARGUMENTS [8391,8411]
                                        MethodInvocation [8391,8400]
                                            METHOD_INVOCATION_RECEIVER [8391,8393]
                                                SimpleName: d2 [8391,8393]
                                            SimpleName: size [8394,8398]
                                        MethodInvocation [8402,8411]
                                            METHOD_INVOCATION_RECEIVER [8402,8404]
                                                SimpleName: d1 [8402,8404]
                                            SimpleName: size [8405,8409]
                EnhancedForStatement [8428,8738]
                    SingleVariableDeclaration [8433,8450]
                        ParameterizedType [8433,8448]
                            SimpleType [8433,8438]
                                SimpleName: Deque [8433,8438]
                            SimpleType [8439,8447]
                                SimpleName: Response [8439,8447]
                        SimpleName: d [8449,8450]
                    SimpleName: deques [8453,8459]
                    Block [8461,8738]
                        WhileStatement [8480,8723]
                            PrefixExpression [8487,8499]
                                PREFIX_EXPRESSION_OPERATOR: ! [8487,8488]
                                MethodInvocation [8488,8499]
                                    METHOD_INVOCATION_RECEIVER [8488,8489]
                                        SimpleName: d [8488,8489]
                                    SimpleName: isEmpty [8490,8497]
                            Block [8501,8723]
                                VariableDeclarationStatement [8524,8552]
                                    SimpleType [8524,8532]
                                        SimpleName: Response [8524,8532]
                                    VariableDeclarationFragment [8533,8551]
                                        SimpleName: response [8533,8541]
                                        MethodInvocation [8544,8551]
                                            METHOD_INVOCATION_RECEIVER [8544,8545]
                                                SimpleName: d [8544,8545]
                                            SimpleName: pop [8546,8549]
                                ExpressionStatement [8574,8597]
                                    Assignment [8574,8596]
                                        SimpleName: nWaitingConsumers [8574,8591]
                                        ASSIGNMENT_OPERATOR: -= [8592,8594]
                                        NumberLiteral: 1 [8595,8596]
                                IfStatement [8619,8704]
                                    MethodInvocation [8623,8645]
                                        SimpleName: deliver [8623,8630]
                                        METHOD_INVOCATION_ARGUMENTS [8631,8644]
                                            SimpleName: job [8631,8634]
                                            SimpleName: response [8636,8644]
                                    Block [8647,8704]
                                        ReturnStatement [8674,8681]
                ExpressionStatement [8863,8948]
                    MethodInvocation [8863,8947]
                        METHOD_INVOCATION_RECEIVER [8863,8866]
                            SimpleName: LOG [8863,8866]
                        SimpleName: debug [8867,8872]
                        METHOD_INVOCATION_ARGUMENTS [8873,8946]
                            StringLiteral: "No consumer was available. They all must have closed their connections." [8873,8946]
                IfStatement [8962,9115]
                    InfixExpression [8966,8988]
                        SimpleName: nWaitingConsumers [8966,8983]
                        INFIX_EXPRESSION_OPERATOR: != [8984,8986]
                        NumberLiteral: 0 [8987,8988]
                    Block [8990,9115]
                        ThrowStatement [9009,9100]
                            ClassInstanceCreation [9015,9099]
                                SimpleType [9019,9033]
                                    SimpleName: AssertionError [9019,9033]
                                StringLiteral: "There should be no waiting consumers here, something is wrong." [9034,9098]
to
TypeDeclaration [653,12783]
at 16
===
insert-tree
---
MethodDeclaration [9143,11120]
    Javadoc [9143,9521]
        TagElement [9155,9465]
            TextElement: Attempt to hand some tasks from the given job to a waiting consumer connection. [9155,9234]
            TextElement: The write will fail if the consumer has closed the connection but it hasn't been removed from the connection [9243,9351]
            TextElement: queue yet because the Broker methods are synchronized (the removal action is waiting to get the monitor). [9360,9465]
        TagElement [9474,9512]
            TextElement:  whether the handoff succeeded. [9481,9512]
    Modifier: public [9527,9533]
    Modifier: synchronized [9534,9546]
    PrimitiveType: boolean [9547,9554]
    SimpleName: deliver [9555,9562]
    SingleVariableDeclaration [9564,9571]
        SimpleType [9564,9567]
            SimpleName: Job [9564,9567]
        SimpleName: job [9568,9571]
    SingleVariableDeclaration [9573,9590]
        SimpleType [9573,9581]
            SimpleName: Response [9573,9581]
        SimpleName: response [9582,9590]
    Block [9592,11120]
        IfStatement [9670,9854]
            PrefixExpression [9674,9734]
                PREFIX_EXPRESSION_OPERATOR: ! [9674,9675]
                MethodInvocation [9675,9734]
                    METHOD_INVOCATION_RECEIVER [9675,9725]
                        MethodInvocation [9675,9725]
                            METHOD_INVOCATION_RECEIVER [9675,9709]
                                MethodInvocation [9675,9709]
                                    METHOD_INVOCATION_RECEIVER [9675,9696]
                                        MethodInvocation [9675,9696]
                                            METHOD_INVOCATION_RECEIVER [9675,9683]
                                                SimpleName: response [9675,9683]
                                            SimpleName: getRequest [9684,9694]
                                    SimpleName: getRequest [9697,9707]
                            SimpleName: getConnection [9710,9723]
                    SimpleName: isOpen [9726,9732]
            Block [9736,9854]
                ExpressionStatement [9751,9816]
                    MethodInvocation [9751,9815]
                        METHOD_INVOCATION_RECEIVER [9751,9754]
                            SimpleName: LOG [9751,9754]
                        SimpleName: debug [9755,9760]
                        METHOD_INVOCATION_ARGUMENTS [9761,9814]
                            StringLiteral: "Consumer connection was closed. It will be removed." [9761,9814]
                ReturnStatement [9830,9843]
                    BooleanLiteral: false [9837,9842]
        VariableDeclarationStatement [9924,9978]
            ParameterizedType [9924,9951]
                SimpleType [9924,9928]
                    SimpleName: List [9924,9928]
                SimpleType [9929,9950]
                    SimpleName: AnalystClusterRequest [9929,9950]
            VariableDeclarationFragment [9952,9977]
                SimpleName: tasks [9952,9957]
                ClassInstanceCreation [9960,9977]
                    ParameterizedType [9964,9975]
                        SimpleType [9964,9973]
                            SimpleName: ArrayList [9964,9973]
        WhileStatement [9988,10105]
            InfixExpression [9995,10042]
                InfixExpression [9995,10011]
                    MethodInvocation [9995,10007]
                        METHOD_INVOCATION_RECEIVER [9995,10000]
                            SimpleName: tasks [9995,10000]
                        SimpleName: size [10001,10005]
                    INFIX_EXPRESSION_OPERATOR: < [10008,10009]
                    NumberLiteral: 4 [10010,10011]
                INFIX_EXPRESSION_OPERATOR: && [10012,10014]
                PrefixExpression [10015,10042]
                    PREFIX_EXPRESSION_OPERATOR: ! [10015,10016]
                    MethodInvocation [10016,10042]
                        METHOD_INVOCATION_RECEIVER [10016,10032]
                            QualifiedName: job.visibleTasks [10016,10032]
                        SimpleName: isEmpty [10033,10040]
            Block [10044,10105]
                ExpressionStatement [10059,10094]
                    MethodInvocation [10059,10093]
                        METHOD_INVOCATION_RECEIVER [10059,10064]
                            SimpleName: tasks [10059,10064]
                        SimpleName: add [10065,10068]
                        METHOD_INVOCATION_ARGUMENTS [10069,10092]
                            MethodInvocation [10069,10092]
                                METHOD_INVOCATION_RECEIVER [10069,10085]
                                    QualifiedName: job.visibleTasks [10069,10085]
                                SimpleName: poll [10086,10090]
        TryStatement [10181,10854]
            Block [10185,10385]
                ExpressionStatement [10200,10238]
                    MethodInvocation [10200,10237]
                        METHOD_INVOCATION_RECEIVER [10200,10208]
                            SimpleName: response [10200,10208]
                        SimpleName: setStatus [10209,10218]
                        METHOD_INVOCATION_ARGUMENTS [10219,10236]
                            QualifiedName: HttpStatus.OK_200 [10219,10236]
                VariableDeclarationStatement [10252,10298]
                    SimpleType [10252,10264]
                        SimpleName: OutputStream [10252,10264]
                    VariableDeclarationFragment [10265,10297]
                        SimpleName: out [10265,10268]
                        MethodInvocation [10271,10297]
                            METHOD_INVOCATION_RECEIVER [10271,10279]
                                SimpleName: response [10271,10279]
                            SimpleName: getOutputStream [10280,10295]
                ExpressionStatement [10312,10342]
                    MethodInvocation [10312,10341]
                        METHOD_INVOCATION_RECEIVER [10312,10318]
                            SimpleName: mapper [10312,10318]
                        SimpleName: writeValue [10319,10329]
                        METHOD_INVOCATION_ARGUMENTS [10330,10340]
                            SimpleName: out [10330,10333]
                            SimpleName: tasks [10335,10340]
                ExpressionStatement [10356,10374]
                    MethodInvocation [10356,10373]
                        METHOD_INVOCATION_RECEIVER [10356,10364]
                            SimpleName: response [10356,10364]
                        SimpleName: resume [10365,10371]
            CatchClause [10386,10854]
                SingleVariableDeclaration [10393,10406]
                    SimpleType [10393,10404]
                        SimpleName: IOException [10393,10404]
                    SimpleName: e [10405,10406]
                Block [10408,10854]
                    ExpressionStatement [10523,10593]
                        MethodInvocation [10523,10592]
                            METHOD_INVOCATION_RECEIVER [10523,10526]
                                SimpleName: LOG [10523,10526]
                            SimpleName: debug [10527,10532]
                            METHOD_INVOCATION_ARGUMENTS [10533,10591]
                                StringLiteral: "Consumer connection caused IO error, it will be removed." [10533,10591]
                    ExpressionStatement [10607,10664]
                        MethodInvocation [10607,10663]
                            METHOD_INVOCATION_RECEIVER [10607,10615]
                                SimpleName: response [10607,10615]
                            SimpleName: setStatus [10616,10625]
                            METHOD_INVOCATION_ARGUMENTS [10626,10662]
                                QualifiedName: HttpStatus.INTERNAL_SERVER_ERROR_500 [10626,10662]
                    ExpressionStatement [10678,10696]
                        MethodInvocation [10678,10695]
                            METHOD_INVOCATION_RECEIVER [10678,10686]
                                SimpleName: response [10678,10686]
                            SimpleName: resume [10687,10693]
                    ExpressionStatement [10785,10816]
                        MethodInvocation [10785,10815]
                            METHOD_INVOCATION_RECEIVER [10785,10801]
                                QualifiedName: job.visibleTasks [10785,10801]
                            SimpleName: addAll [10802,10808]
                            METHOD_INVOCATION_ARGUMENTS [10809,10814]
                                SimpleName: tasks [10809,10814]
                    ReturnStatement [10830,10843]
                        BooleanLiteral: false [10837,10842]
        ExpressionStatement [10946,11005]
            MethodInvocation [10946,11004]
                METHOD_INVOCATION_RECEIVER [10946,10949]
                    SimpleName: LOG [10946,10949]
                SimpleName: debug [10950,10955]
                METHOD_INVOCATION_ARGUMENTS [10956,11003]
                    StringLiteral: "Delivery of {} tasks succeeded." [10956,10989]
                    MethodInvocation [10991,11003]
                        METHOD_INVOCATION_RECEIVER [10991,10996]
                            SimpleName: tasks [10991,10996]
                        SimpleName: size [10997,11001]
        ExpressionStatement [11015,11049]
            Assignment [11015,11048]
                SimpleName: nUndeliveredTasks [11015,11032]
                ASSIGNMENT_OPERATOR: -= [11033,11035]
                MethodInvocation [11036,11048]
                    METHOD_INVOCATION_RECEIVER [11036,11041]
                        SimpleName: tasks [11036,11041]
                    SimpleName: size [11042,11046]
        ExpressionStatement [11059,11089]
            MethodInvocation [11059,11088]
                METHOD_INVOCATION_RECEIVER [11059,11062]
                    SimpleName: job [11059,11062]
                SimpleName: markTasksDelivered [11063,11081]
                METHOD_INVOCATION_ARGUMENTS [11082,11087]
                    SimpleName: tasks [11082,11087]
        ReturnStatement [11099,11111]
            BooleanLiteral: true [11106,11110]
to
TypeDeclaration [653,12783]
at 17
===
insert-tree
---
MethodDeclaration [11128,11912]
    Javadoc [11128,11292]
        TagElement [11140,11227]
            TextElement: Take a task out of the job, marking it as completed. The body of this DELETE request... [11140,11227]
        TagElement [11236,11283]
            TextElement:  whether the task was found and removed. [11243,11283]
    Modifier: public [11298,11304]
    Modifier: synchronized [11305,11317]
    PrimitiveType: boolean [11318,11325]
    SimpleName: deleteTask [11326,11336]
    SingleVariableDeclaration [11338,11357]
        SimpleType [11338,11347]
            SimpleName: QueuePath [11338,11347]
        SimpleName: queuePath [11348,11357]
    Block [11359,11912]
        VariableDeclarationStatement [11372,11418]
            SimpleType [11372,11376]
                SimpleName: User [11372,11376]
            VariableDeclarationFragment [11377,11417]
                SimpleName: user [11377,11381]
                MethodInvocation [11384,11417]
                    SimpleName: findUser [11384,11392]
                    METHOD_INVOCATION_ARGUMENTS [11393,11416]
                        QualifiedName: queuePath.userId [11393,11409]
                        BooleanLiteral: false [11411,11416]
        IfStatement [11428,11485]
            InfixExpression [11432,11444]
                SimpleName: user [11432,11436]
                INFIX_EXPRESSION_OPERATOR: == [11437,11439]
                NullLiteral [11440,11444]
            Block [11446,11485]
                ReturnStatement [11461,11474]
                    BooleanLiteral: false [11468,11473]
        VariableDeclarationStatement [11497,11544]
            SimpleType [11497,11500]
                SimpleName: Job [11497,11500]
            VariableDeclarationFragment [11501,11543]
                SimpleName: job [11501,11504]
                MethodInvocation [11507,11543]
                    METHOD_INVOCATION_RECEIVER [11507,11511]
                        SimpleName: user [11507,11511]
                    SimpleName: findJob [11512,11519]
                    METHOD_INVOCATION_ARGUMENTS [11520,11542]
                        QualifiedName: queuePath.jobId [11520,11535]
                        BooleanLiteral: false [11537,11542]
        IfStatement [11554,11610]
            InfixExpression [11558,11569]
                SimpleName: job [11558,11561]
                INFIX_EXPRESSION_OPERATOR: == [11562,11564]
                NullLiteral [11565,11569]
            Block [11571,11610]
                ReturnStatement [11586,11599]
                    BooleanLiteral: false [11593,11598]
        ReturnStatement [11844,11903]
            InfixExpression [11851,11902]
                MethodInvocation [11851,11894]
                    METHOD_INVOCATION_RECEIVER [11851,11869]
                        QualifiedName: job.invisibleTasks [11851,11869]
                    SimpleName: remove [11870,11876]
                    METHOD_INVOCATION_ARGUMENTS [11877,11893]
                        QualifiedName: queuePath.taskId [11877,11893]
                INFIX_EXPRESSION_OPERATOR: != [11895,11897]
                NullLiteral [11898,11902]
to
TypeDeclaration [653,12783]
at 18
===
insert-tree
---
MethodDeclaration [11999,12288]
    MarkerAnnotation [11999,12008]
        SimpleName: Override [12000,12008]
    Modifier: public [12014,12020]
    PrimitiveType: void [12021,12025]
    SimpleName: run [12026,12029]
    Block [12032,12288]
        WhileStatement [12043,12281]
            BooleanLiteral: true [12050,12054]
            Block [12056,12281]
                TryStatement [12071,12270]
                    Block [12075,12133]
                        ExpressionStatement [12094,12118]
                            MethodInvocation [12094,12117]
                                SimpleName: deliverTasksForOneJob [12094,12115]
                    CatchClause [12134,12270]
                        SingleVariableDeclaration [12141,12163]
                            SimpleType [12141,12161]
                                SimpleName: InterruptedException [12141,12161]
                            SimpleName: e [12162,12163]
                        Block [12165,12270]
                            ExpressionStatement [12184,12230]
                                MethodInvocation [12184,12229]
                                    METHOD_INVOCATION_RECEIVER [12184,12187]
                                        SimpleName: LOG [12184,12187]
                                    SimpleName: warn [12188,12192]
                                    METHOD_INVOCATION_ARGUMENTS [12193,12228]
                                        StringLiteral: "Task pump thread was interrupted." [12193,12228]
                            ReturnStatement [12248,12255]
to
TypeDeclaration [653,12783]
at 19
===
insert-tree
---
MethodDeclaration [12296,12776]
    Javadoc [12296,12407]
        TagElement [12300,12405]
            TextElement: Search through the users to find one with the given ID, without advancing the head of the circular list.  [12300,12405]
    Modifier: public [12413,12419]
    SimpleType [12420,12424]
        SimpleName: User [12420,12424]
    SimpleName: findUser [12425,12433]
    SingleVariableDeclaration [12435,12448]
        SimpleType [12435,12441]
            SimpleName: String [12435,12441]
        SimpleName: userId [12442,12448]
    SingleVariableDeclaration [12450,12464]
        PrimitiveType: boolean [12450,12457]
        SimpleName: create [12458,12464]
    Block [12466,12776]
        EnhancedForStatement [12477,12605]
            SingleVariableDeclaration [12482,12491]
                SimpleType [12482,12486]
                    SimpleName: User [12482,12486]
                SimpleName: user [12487,12491]
            SimpleName: users [12494,12499]
            Block [12501,12605]
                IfStatement [12516,12594]
                    MethodInvocation [12520,12546]
                        METHOD_INVOCATION_RECEIVER [12520,12531]
                            QualifiedName: user.userId [12520,12531]
                        SimpleName: equals [12532,12538]
                        METHOD_INVOCATION_ARGUMENTS [12539,12545]
                            SimpleName: userId [12539,12545]
                    Block [12548,12594]
                        ReturnStatement [12567,12579]
                            SimpleName: user [12574,12578]
        IfStatement [12615,12747]
            SimpleName: create [12619,12625]
            Block [12627,12747]
                VariableDeclarationStatement [12642,12671]
                    SimpleType [12642,12646]
                        SimpleName: User [12642,12646]
                    VariableDeclarationFragment [12647,12670]
                        SimpleName: user [12647,12651]
                        ClassInstanceCreation [12654,12670]
                            SimpleType [12658,12662]
                                SimpleName: User [12658,12662]
                            SimpleName: userId [12663,12669]
                ExpressionStatement [12685,12710]
                    MethodInvocation [12685,12709]
                        METHOD_INVOCATION_RECEIVER [12685,12690]
                            SimpleName: users [12685,12690]
                        SimpleName: insertAtTail [12691,12703]
                        METHOD_INVOCATION_ARGUMENTS [12704,12708]
                            SimpleName: user [12704,12708]
                ReturnStatement [12724,12736]
                    SimpleName: user [12731,12735]
        ReturnStatement [12757,12769]
            NullLiteral [12764,12768]
to
TypeDeclaration [653,12783]
at 20
===
insert-tree
---
Javadoc [13575,14432]
    TagElement [13582,14424]
        TextElement: A Grizzly Async Http Service (uses reponse suspend/resume) [13582,13640]
        TextElement: https://blogs.oracle.com/oleksiys/entry/grizzly_2_0_httpserver_api1 [13645,13712]
        TextElement: When resuming a response object, "The only reliable way to check the socket status is to try to read or [13721,13824]
        TextElement: write something." Though you also have: [13829,13868]
        TextElement: response.getRequest().getRequest().getConnection().isOpen() [13877,13936]
        TextElement: response.getRequest().getRequest().getConnection().addCloseListener(); [13941,14011]
        TextElement: But none of these work, I've tried all three of them. You can even write to the outputstream after the connection [14016,14129]
        TextElement: is closed. [14134,14144]
        TextElement: Solution: networkListener.getTransport().setIOStrategy(SameThreadIOStrategy.getInstance()); [14149,14240]
        TextElement: This makes all three work! isOpen, CloseListener, and IOExceptions from flush(); [14245,14325]
        TextElement: Grizzly has Comet support, but this seems geared toward subscriptions to broadcast events. [14334,14424]
to
TypeDeclaration [13575,18581]
at 0
===
insert-node
---
TYPE_DECLARATION_KIND: class [14434,14439]
to
TypeDeclaration [13575,18581]
at 1
===
insert-node
---
SimpleName: BrokerHttpHandler [14440,14457]
to
TypeDeclaration [13575,18581]
at 2
===
insert-tree
---
SimpleType [14466,14477]
    SimpleName: HttpHandler [14466,14477]
to
TypeDeclaration [13575,18581]
at 3
===
insert-tree
---
FieldDeclaration [14581,14765]
    Modifier: private [14581,14588]
    SimpleType [14589,14601]
        SimpleName: ObjectMapper [14589,14601]
    VariableDeclarationFragment [14602,14764]
        SimpleName: mapper [14602,14608]
        MethodInvocation [14611,14764]
            METHOD_INVOCATION_RECEIVER [14611,14694]
                MethodInvocation [14611,14694]
                    METHOD_INVOCATION_RECEIVER [14611,14629]
                        ClassInstanceCreation [14611,14629]
                            SimpleType [14615,14627]
                                SimpleName: ObjectMapper [14615,14627]
                    SimpleName: registerModule [14644,14658]
                    METHOD_INVOCATION_ARGUMENTS [14659,14693]
                        MethodInvocation [14659,14693]
                            METHOD_INVOCATION_RECEIVER [14659,14680]
                                SimpleName: AgencyAndIdSerializer [14659,14680]
                            SimpleName: makeModule [14681,14691]
            SimpleName: setSerializationInclusion [14709,14734]
            METHOD_INVOCATION_ARGUMENTS [14735,14763]
                QualifiedName: JsonInclude.Include.NON_NULL [14735,14763]
to
TypeDeclaration [13575,18581]
at 4
===
insert-tree
---
FieldDeclaration [14774,14796]
    Modifier: private [14774,14781]
    SimpleType [14782,14788]
        SimpleName: Broker [14782,14788]
    VariableDeclarationFragment [14789,14795]
        SimpleName: broker [14789,14795]
to
TypeDeclaration [13575,18581]
at 5
===
insert-tree
---
MethodDeclaration [14804,14883]
    Modifier: public [14804,14810]
    SimpleName: BrokerHttpHandler [14811,14828]
    SingleVariableDeclaration [14829,14842]
        SimpleType [14829,14835]
            SimpleName: Broker [14829,14835]
        SimpleName: broker [14836,14842]
    Block [14844,14883]
        ExpressionStatement [14855,14876]
            Assignment [14855,14875]
                FieldAccess [14855,14866]
                    ThisExpression [14855,14859]
                    SimpleName: broker [14860,14866]
                ASSIGNMENT_OPERATOR: = [14867,14868]
                SimpleName: broker [14869,14875]
to
TypeDeclaration [13575,18581]
at 6
===
insert-node
---
MethodDeclaration [14891,18420]
to
TypeDeclaration [13575,18581]
at 7
===
insert-tree
---
MethodDeclaration [18428,18576]
    Modifier: public [18428,18434]
    PrimitiveType: void [18435,18439]
    SimpleName: writeJson [18440,18449]
    SingleVariableDeclaration [18451,18468]
        SimpleType [18451,18459]
            SimpleName: Response [18451,18459]
        SimpleName: response [18460,18468]
    SingleVariableDeclaration [18470,18483]
        SimpleType [18470,18476]
            SimpleName: Object [18470,18476]
        SimpleName: object [18477,18483]
    SimpleType [18492,18503]
        SimpleName: IOException [18492,18503]
    Block [18504,18576]
        ExpressionStatement [18515,18569]
            MethodInvocation [18515,18568]
                METHOD_INVOCATION_RECEIVER [18515,18521]
                    SimpleName: mapper [18515,18521]
                SimpleName: writeValue [18522,18532]
                METHOD_INVOCATION_ARGUMENTS [18533,18567]
                    MethodInvocation [18533,18559]
                        METHOD_INVOCATION_RECEIVER [18533,18541]
                            SimpleName: response [18533,18541]
                        SimpleName: getOutputStream [18542,18557]
                    SimpleName: object [18561,18567]
to
TypeDeclaration [13575,18581]
at 8
===
insert-node
---
Javadoc [29220,29232]
to
TypeDeclaration [29220,29892]
at 0
===
insert-node
---
Modifier: public [29234,29240]
to
TypeDeclaration [29220,29892]
at 1
===
insert-node
---
TYPE_DECLARATION_KIND: class [29241,29246]
to
TypeDeclaration [29220,29892]
at 2
===
insert-node
---
SimpleName: User [29247,29251]
to
TypeDeclaration [29220,29892]
at 3
===
insert-tree
---
FieldDeclaration [29261,29288]
    Modifier: public [29261,29267]
    Modifier: final [29268,29273]
    SimpleType [29274,29280]
        SimpleName: String [29274,29280]
    VariableDeclarationFragment [29281,29287]
        SimpleName: userId [29281,29287]
to
TypeDeclaration [29220,29892]
at 4
===
insert-node
---
FieldDeclaration [29294,29315]
to
TypeDeclaration [29220,29892]
at 5
===
insert-tree
---
FieldDeclaration [29398,29457]
    Modifier: public [29398,29404]
    Modifier: final [29405,29410]
    ParameterizedType [29411,29428]
        SimpleType [29411,29423]
            SimpleName: CircularList [29411,29423]
        SimpleType [29424,29427]
            SimpleName: Job [29424,29427]
    VariableDeclarationFragment [29429,29456]
        SimpleName: jobs [29429,29433]
        ClassInstanceCreation [29436,29456]
            ParameterizedType [29440,29454]
                SimpleType [29440,29452]
                    SimpleName: CircularList [29440,29452]
to
TypeDeclaration [29220,29892]
at 6
===
insert-tree
---
MethodDeclaration [29465,29531]
    Modifier: public [29465,29471]
    SimpleName: User [29472,29476]
    SingleVariableDeclaration [29477,29490]
        SimpleType [29477,29483]
            SimpleName: String [29477,29483]
        SimpleName: userId [29484,29490]
    Block [29492,29531]
        ExpressionStatement [29503,29524]
            Assignment [29503,29523]
                FieldAccess [29503,29514]
                    ThisExpression [29503,29507]
                    SimpleName: userId [29508,29514]
                ASSIGNMENT_OPERATOR: = [29515,29516]
                SimpleName: userId [29517,29523]
to
TypeDeclaration [29220,29892]
at 7
===
insert-tree
---
MethodDeclaration [29539,29885]
    Modifier: public [29539,29545]
    SimpleType [29546,29549]
        SimpleName: Job [29546,29549]
    SimpleName: findJob [29550,29557]
    SingleVariableDeclaration [29559,29571]
        SimpleType [29559,29565]
            SimpleName: String [29559,29565]
        SimpleName: jobId [29566,29571]
    SingleVariableDeclaration [29573,29587]
        PrimitiveType: boolean [29573,29580]
        SimpleName: create [29581,29587]
    Block [29589,29885]
        EnhancedForStatement [29600,29721]
            SingleVariableDeclaration [29605,29612]
                SimpleType [29605,29608]
                    SimpleName: Job [29605,29608]
                SimpleName: job [29609,29612]
            SimpleName: jobs [29615,29619]
            Block [29621,29721]
                IfStatement [29636,29710]
                    MethodInvocation [29640,29663]
                        METHOD_INVOCATION_RECEIVER [29640,29649]
                            QualifiedName: job.jobId [29640,29649]
                        SimpleName: equals [29650,29656]
                        METHOD_INVOCATION_ARGUMENTS [29657,29662]
                            SimpleName: jobId [29657,29662]
                    Block [29665,29710]
                        ReturnStatement [29684,29695]
                            SimpleName: job [29691,29694]
        IfStatement [29731,29856]
            SimpleName: create [29735,29741]
            Block [29743,29856]
                VariableDeclarationStatement [29758,29783]
                    SimpleType [29758,29761]
                        SimpleName: Job [29758,29761]
                    VariableDeclarationFragment [29762,29782]
                        SimpleName: job [29762,29765]
                        ClassInstanceCreation [29768,29782]
                            SimpleType [29772,29775]
                                SimpleName: Job [29772,29775]
                            SimpleName: jobId [29776,29781]
                ExpressionStatement [29797,29820]
                    MethodInvocation [29797,29819]
                        METHOD_INVOCATION_RECEIVER [29797,29801]
                            SimpleName: jobs [29797,29801]
                        SimpleName: insertAtTail [29802,29814]
                        METHOD_INVOCATION_ARGUMENTS [29815,29818]
                            SimpleName: job [29815,29818]
                ReturnStatement [29834,29845]
                    SimpleName: job [29841,29844]
        ReturnStatement [29866,29878]
            NullLiteral [29873,29877]
to
TypeDeclaration [29220,29892]
at 8
===
insert-node
---
FieldDeclaration [30995,31096]
to
TypeDeclaration [279,3025]
at 11
===
insert-tree
---
FieldDeclaration [35068,35117]
    SimpleType [35068,35074]
        SimpleName: String [35068,35074]
    VariableDeclarationFragment [35075,35116]
        SimpleName: BROKER_BASE_URL [35075,35090]
        StringLiteral: "http://localhost:9001" [35093,35116]
to
TypeDeclaration [4766,14623]
at 9
===
insert-tree
---
Javadoc [3178,3263]
    TagElement [3182,3261]
        TextElement: Outstanding requests from workers for tasks, grouped by worker graph affinity.  [3182,3261]
to
FieldDeclaration [3178,3336]
at 0
===
insert-node
---
ParameterizedType [3269,3297]
to
FieldDeclaration [3178,3336]
at 1
===
insert-tree
---
VariableDeclarationFragment [3298,3335]
    SimpleName: connectionsForGraph [3298,3317]
    ClassInstanceCreation [3320,3335]
        ParameterizedType [3324,3333]
            SimpleType [3324,3331]
                SimpleName: HashMap [3324,3331]
to
FieldDeclaration [3178,3336]
at 2
===
insert-tree
---
MarkerAnnotation [14891,14900]
    SimpleName: Override [14892,14900]
to
MethodDeclaration [14891,18420]
at 0
===
insert-node
---
Modifier: public [14906,14912]
to
MethodDeclaration [14891,18420]
at 1
===
insert-node
---
PrimitiveType: void [14913,14917]
to
MethodDeclaration [14891,18420]
at 2
===
insert-node
---
SimpleName: service [14918,14925]
to
MethodDeclaration [14891,18420]
at 3
===
move-tree
---
SingleVariableDeclaration [24188,24203]
    SimpleType [24188,24195]
        SimpleName: Request [24188,24195]
    SimpleName: request [24196,24203]
to
MethodDeclaration [14891,18420]
at 4
===
move-tree
---
SingleVariableDeclaration [24205,24222]
    SimpleType [24205,24213]
        SimpleName: Response [24205,24213]
    SimpleName: response [24214,24222]
to
MethodDeclaration [14891,18420]
at 5
===
insert-tree
---
SimpleType [14969,14978]
    SimpleName: Exception [14969,14978]
to
MethodDeclaration [14891,18420]
at 6
===
insert-tree
---
Block [14979,18420]
    ExpressionStatement [15144,15188]
        MethodInvocation [15144,15187]
            METHOD_INVOCATION_RECEIVER [15144,15152]
                SimpleName: response [15144,15152]
            SimpleName: setContentType [15153,15167]
            METHOD_INVOCATION_ARGUMENTS [15168,15186]
                StringLiteral: "application/json" [15168,15186]
    VariableDeclarationStatement [15274,15333]
        SimpleType [15274,15283]
            SimpleName: QueuePath [15274,15283]
        VariableDeclarationFragment [15284,15332]
            SimpleName: queuePath [15284,15293]
            ClassInstanceCreation [15296,15332]
                SimpleType [15300,15309]
                    SimpleName: QueuePath [15300,15309]
                MethodInvocation [15310,15331]
                    METHOD_INVOCATION_RECEIVER [15310,15317]
                        SimpleName: request [15310,15317]
                    SimpleName: getPathInfo [15318,15329]
    TryStatement [15572,18413]
        Block [15576,17968]
            IfStatement [15591,17957]
                InfixExpression [15595,15629]
                    MethodInvocation [15595,15614]
                        METHOD_INVOCATION_RECEIVER [15595,15602]
                            SimpleName: request [15595,15602]
                        SimpleName: getMethod [15603,15612]
                    INFIX_EXPRESSION_OPERATOR: == [15615,15617]
                    QualifiedName: Method.HEAD [15618,15629]
                Block [15631,15876]
                    ExpressionStatement [15738,15780]
                        MethodInvocation [15738,15779]
                            METHOD_INVOCATION_RECEIVER [15738,15744]
                                SimpleName: mapper [15738,15744]
                            SimpleName: readTree [15745,15753]
                            METHOD_INVOCATION_ARGUMENTS [15754,15778]
                                MethodInvocation [15754,15778]
                                    METHOD_INVOCATION_RECEIVER [15754,15761]
                                        SimpleName: request [15754,15761]
                                    SimpleName: getInputStream [15762,15776]
                    ExpressionStatement [15798,15836]
                        MethodInvocation [15798,15835]
                            METHOD_INVOCATION_RECEIVER [15798,15806]
                                SimpleName: response [15798,15806]
                            SimpleName: setStatus [15807,15816]
                            METHOD_INVOCATION_ARGUMENTS [15817,15834]
                                QualifiedName: HttpStatus.OK_200 [15817,15834]
                    ReturnStatement [15854,15861]
                IfStatement [15882,17957]
                    InfixExpression [15886,15919]
                        MethodInvocation [15886,15905]
                            METHOD_INVOCATION_RECEIVER [15886,15893]
                                SimpleName: request [15886,15893]
                            SimpleName: getMethod [15894,15903]
                        INFIX_EXPRESSION_OPERATOR: == [15906,15908]
                        QualifiedName: Method.GET [15909,15919]
                    Block [15921,16393]
                        ExpressionStatement [16011,16196]
                            MethodInvocation [16011,16195]
                                METHOD_INVOCATION_RECEIVER [16011,16047]
                                    MethodInvocation [16011,16047]
                                        METHOD_INVOCATION_RECEIVER [16011,16031]
                                            MethodInvocation [16011,16031]
                                                METHOD_INVOCATION_RECEIVER [16011,16018]
                                                    SimpleName: request [16011,16018]
                                                SimpleName: getRequest [16019,16029]
                                        SimpleName: getConnection [16032,16045]
                                SimpleName: addCloseListener [16048,16064]
                                METHOD_INVOCATION_ARGUMENTS [16065,16194]
                                    LambdaExpression [16065,16194]
                                        VariableDeclarationFragment [16066,16075]
                                            SimpleName: closeable [16066,16075]
                                        VariableDeclarationFragment [16077,16087]
                                            SimpleName: iCloseType [16077,16087]
                                        Block [16092,16194]
                                            ExpressionStatement [16115,16175]
                                                MethodInvocation [16115,16174]
                                                    METHOD_INVOCATION_RECEIVER [16115,16121]
                                                        SimpleName: broker [16115,16121]
                                                    SimpleName: removeSuspendedResponse [16122,16145]
                                                    METHOD_INVOCATION_ARGUMENTS [16146,16173]
                                                        QualifiedName: queuePath.graphId [16146,16163]
                                                        SimpleName: response [16165,16173]
                        ExpressionStatement [16214,16233]
                            MethodInvocation [16214,16232]
                                METHOD_INVOCATION_RECEIVER [16214,16222]
                                    SimpleName: response [16214,16222]
                                SimpleName: suspend [16223,16230]
                        ExpressionStatement [16316,16378]
                            MethodInvocation [16316,16377]
                                METHOD_INVOCATION_RECEIVER [16316,16322]
                                    SimpleName: broker [16316,16322]
                                SimpleName: registerSuspendedResponse [16323,16348]
                                METHOD_INVOCATION_ARGUMENTS [16349,16376]
                                    QualifiedName: queuePath.graphId [16349,16366]
                                    SimpleName: response [16368,16376]
                    IfStatement [16399,17957]
                        InfixExpression [16403,16437]
                            MethodInvocation [16403,16422]
                                METHOD_INVOCATION_RECEIVER [16403,16410]
                                    SimpleName: request [16403,16410]
                                SimpleName: getMethod [16411,16420]
                            INFIX_EXPRESSION_OPERATOR: == [16423,16425]
                            QualifiedName: Method.POST [16426,16437]
                        Block [16439,17425]
                            VariableDeclarationStatement [16622,16774]
                                ParameterizedType [16622,16649]
                                    SimpleType [16622,16626]
                                        SimpleName: List [16622,16626]
                                    SimpleType [16627,16648]
                                        SimpleName: AnalystClusterRequest [16627,16648]
                                VariableDeclarationFragment [16650,16773]
                                    SimpleName: tasks [16650,16655]
                                    MethodInvocation [16679,16773]
                                        METHOD_INVOCATION_RECEIVER [16679,16685]
                                            SimpleName: mapper [16679,16685]
                                        SimpleName: readValue [16686,16695]
                                        METHOD_INVOCATION_ARGUMENTS [16696,16772]
                                            MethodInvocation [16696,16720]
                                                METHOD_INVOCATION_RECEIVER [16696,16703]
                                                    SimpleName: request [16696,16703]
                                                SimpleName: getInputStream [16704,16718]
                                            ClassInstanceCreation [16722,16772]
                                                ParameterizedType [16726,16768]
                                                    SimpleType [16726,16739]
                                                        SimpleName: TypeReference [16726,16739]
                                                    ParameterizedType [16740,16767]
                                                        SimpleType [16740,16744]
                                                            SimpleName: List [16740,16744]
                                                        SimpleType [16745,16766]
                                                            SimpleName: AnalystClusterRequest [16745,16766]
                                                AnonymousClassDeclaration [16770,16772]
                            EnhancedForStatement [16792,17292]
                                SingleVariableDeclaration [16797,16823]
                                    SimpleType [16797,16818]
                                        SimpleName: AnalystClusterRequest [16797,16818]
                                    SimpleName: task [16819,16823]
                                SimpleName: tasks [16826,16831]
                                Block [16833,17292]
                                    IfStatement [16856,17273]
                                        InfixExpression [16860,17037]
                                            PrefixExpression [16860,16899]
                                                PREFIX_EXPRESSION_OPERATOR: ! [16860,16861]
                                                MethodInvocation [16861,16899]
                                                    METHOD_INVOCATION_RECEIVER [16861,16873]
                                                        QualifiedName: task.graphId [16861,16873]
                                                    SimpleName: equals [16874,16880]
                                                    METHOD_INVOCATION_ARGUMENTS [16881,16898]
                                                        QualifiedName: queuePath.graphId [16881,16898]
                                            INFIX_EXPRESSION_OPERATOR: || [16929,16931]
                                            PrefixExpression [16932,16969]
                                                PREFIX_EXPRESSION_OPERATOR: ! [16932,16933]
                                                MethodInvocation [16933,16969]
                                                    METHOD_INVOCATION_RECEIVER [16933,16944]
                                                        QualifiedName: task.userId [16933,16944]
                                                    SimpleName: equals [16945,16951]
                                                    METHOD_INVOCATION_ARGUMENTS [16952,16968]
                                                        QualifiedName: queuePath.userId [16952,16968]
                                            PrefixExpression [17002,17037]
                                                PREFIX_EXPRESSION_OPERATOR: ! [17002,17003]
                                                MethodInvocation [17003,17037]
                                                    METHOD_INVOCATION_RECEIVER [17003,17013]
                                                        QualifiedName: task.jobId [17003,17013]
                                                    SimpleName: equals [17014,17020]
                                                    METHOD_INVOCATION_ARGUMENTS [17021,17036]
                                                        QualifiedName: queuePath.jobId [17021,17036]
                                        Block [17039,17273]
                                            ExpressionStatement [17066,17113]
                                                MethodInvocation [17066,17112]
                                                    METHOD_INVOCATION_RECEIVER [17066,17074]
                                                        SimpleName: response [17066,17074]
                                                    SimpleName: setStatus [17075,17084]
                                                    METHOD_INVOCATION_ARGUMENTS [17085,17111]
                                                        QualifiedName: HttpStatus.BAD_REQUEST_400 [17085,17111]
                                            ExpressionStatement [17139,17217]
                                                MethodInvocation [17139,17216]
                                                    METHOD_INVOCATION_RECEIVER [17139,17147]
                                                        SimpleName: response [17139,17147]
                                                    SimpleName: setDetailMessage [17148,17164]
                                                    METHOD_INVOCATION_ARGUMENTS [17165,17215]
                                                        StringLiteral: "Task graph/user/job ID does not match POST path." [17165,17215]
                                            ReturnStatement [17243,17250]
                            ExpressionStatement [17310,17348]
                                MethodInvocation [17310,17347]
                                    METHOD_INVOCATION_RECEIVER [17310,17316]
                                        SimpleName: broker [17310,17316]
                                    SimpleName: enqueueTasks [17317,17329]
                                    METHOD_INVOCATION_ARGUMENTS [17330,17346]
                                        SimpleName: queuePath [17330,17339]
                                        SimpleName: tasks [17341,17346]
                            ExpressionStatement [17366,17410]
                                MethodInvocation [17366,17409]
                                    METHOD_INVOCATION_RECEIVER [17366,17374]
                                        SimpleName: response [17366,17374]
                                    SimpleName: setStatus [17375,17384]
                                    METHOD_INVOCATION_ARGUMENTS [17385,17408]
                                        QualifiedName: HttpStatus.ACCEPTED_202 [17385,17408]
                        IfStatement [17431,17957]
                            InfixExpression [17435,17471]
                                MethodInvocation [17435,17454]
                                    METHOD_INVOCATION_RECEIVER [17435,17442]
                                        SimpleName: request [17435,17442]
                                    SimpleName: getMethod [17443,17452]
                                INFIX_EXPRESSION_OPERATOR: == [17455,17457]
                                QualifiedName: Method.DELETE [17458,17471]
                            Block [17473,17797]
                                IfStatement [17575,17782]
                                    MethodInvocation [17579,17607]
                                        METHOD_INVOCATION_RECEIVER [17579,17585]
                                            SimpleName: broker [17579,17585]
                                        SimpleName: deleteTask [17586,17596]
                                        METHOD_INVOCATION_ARGUMENTS [17597,17606]
                                            SimpleName: queuePath [17597,17606]
                                    Block [17609,17689]
                                        ExpressionStatement [17632,17670]
                                            MethodInvocation [17632,17669]
                                                METHOD_INVOCATION_RECEIVER [17632,17640]
                                                    SimpleName: response [17632,17640]
                                                SimpleName: setStatus [17641,17650]
                                                METHOD_INVOCATION_ARGUMENTS [17651,17668]
                                                    QualifiedName: HttpStatus.OK_200 [17651,17668]
                                    Block [17695,17782]
                                        ExpressionStatement [17718,17763]
                                            MethodInvocation [17718,17762]
                                                METHOD_INVOCATION_RECEIVER [17718,17726]
                                                    SimpleName: response [17718,17726]
                                                SimpleName: setStatus [17727,17736]
                                                METHOD_INVOCATION_ARGUMENTS [17737,17761]
                                                    QualifiedName: HttpStatus.NOT_FOUND_404 [17737,17761]
                            Block [17803,17957]
                                ExpressionStatement [17822,17869]
                                    MethodInvocation [17822,17868]
                                        METHOD_INVOCATION_RECEIVER [17822,17830]
                                            SimpleName: response [17822,17830]
                                        SimpleName: setStatus [17831,17840]
                                        METHOD_INVOCATION_ARGUMENTS [17841,17867]
                                            QualifiedName: HttpStatus.BAD_REQUEST_400 [17841,17867]
                                ExpressionStatement [17887,17942]
                                    MethodInvocation [17887,17941]
                                        METHOD_INVOCATION_RECEIVER [17887,17895]
                                            SimpleName: response [17887,17895]
                                        SimpleName: setDetailMessage [17896,17912]
                                        METHOD_INVOCATION_ARGUMENTS [17913,17940]
                                            StringLiteral: "Unrecognized HTTP method." [17913,17940]
        CatchClause [17969,18218]
            SingleVariableDeclaration [17976,18004]
                SimpleType [17976,17999]
                    SimpleName: JsonProcessingException [17976,17999]
                SimpleName: jpex [18000,18004]
            Block [18006,18218]
                ExpressionStatement [18021,18068]
                    MethodInvocation [18021,18067]
                        METHOD_INVOCATION_RECEIVER [18021,18029]
                            SimpleName: response [18021,18029]
                        SimpleName: setStatus [18030,18039]
                        METHOD_INVOCATION_ARGUMENTS [18040,18066]
                            QualifiedName: HttpStatus.BAD_REQUEST_400 [18040,18066]
                ExpressionStatement [18082,18170]
                    MethodInvocation [18082,18169]
                        METHOD_INVOCATION_RECEIVER [18082,18090]
                            SimpleName: response [18082,18090]
                        SimpleName: setDetailMessage [18091,18107]
                        METHOD_INVOCATION_ARGUMENTS [18108,18168]
                            InfixExpression [18108,18168]
                                StringLiteral: "Could not decode/encode JSON payload. " [18108,18148]
                                INFIX_EXPRESSION_OPERATOR: + [18149,18150]
                                MethodInvocation [18151,18168]
                                    METHOD_INVOCATION_RECEIVER [18151,18155]
                                        SimpleName: jpex [18151,18155]
                                    SimpleName: getMessage [18156,18166]
                ExpressionStatement [18184,18207]
                    MethodInvocation [18184,18206]
                        METHOD_INVOCATION_RECEIVER [18184,18188]
                            SimpleName: jpex [18184,18188]
                        SimpleName: printStackTrace [18189,18204]
        CatchClause [18219,18413]
            SingleVariableDeclaration [18226,18238]
                SimpleType [18226,18235]
                    SimpleName: Exception [18226,18235]
                SimpleName: ex [18236,18238]
            Block [18240,18413]
                ExpressionStatement [18255,18312]
                    MethodInvocation [18255,18311]
                        METHOD_INVOCATION_RECEIVER [18255,18263]
                            SimpleName: response [18255,18263]
                        SimpleName: setStatus [18264,18273]
                        METHOD_INVOCATION_ARGUMENTS [18274,18310]
                            QualifiedName: HttpStatus.INTERNAL_SERVER_ERROR_500 [18274,18310]
                ExpressionStatement [18326,18367]
                    MethodInvocation [18326,18366]
                        METHOD_INVOCATION_RECEIVER [18326,18334]
                            SimpleName: response [18326,18334]
                        SimpleName: setDetailMessage [18335,18351]
                        METHOD_INVOCATION_ARGUMENTS [18352,18365]
                            MethodInvocation [18352,18365]
                                METHOD_INVOCATION_RECEIVER [18352,18354]
                                    SimpleName: ex [18352,18354]
                                SimpleName: toString [18355,18363]
                ExpressionStatement [18381,18402]
                    MethodInvocation [18381,18401]
                        METHOD_INVOCATION_RECEIVER [18381,18383]
                            SimpleName: ex [18381,18383]
                        SimpleName: printStackTrace [18384,18399]
to
MethodDeclaration [14891,18420]
at 7
===
insert-node
---
Modifier: public [29294,29300]
to
FieldDeclaration [29294,29315]
at 0
===
move-tree
---
SimpleType [24500,24506]
    SimpleName: String [24500,24506]
to
FieldDeclaration [29294,29315]
at 1
===
insert-tree
---
VariableDeclarationFragment [29308,29314]
    SimpleName: region [29308,29314]
to
FieldDeclaration [29294,29315]
at 2
===
insert-tree
---
Javadoc [30995,31075]
    TagElement [30999,31073]
        TextElement: A unique identifier for this request assigned by the queue/broker system.  [30999,31073]
to
FieldDeclaration [30995,31096]
at 0
===
insert-node
---
Modifier: public [31078,31084]
to
FieldDeclaration [30995,31096]
at 1
===
insert-node
---
PrimitiveType: int [31085,31088]
to
FieldDeclaration [30995,31096]
at 2
===
move-tree
---
VariableDeclarationFragment [24480,24486]
    SimpleName: taskId [24480,24486]
to
FieldDeclaration [30995,31096]
at 3
===
move-tree
---
SimpleType [12260,12263]
    SimpleName: Map [12260,12263]
to
ParameterizedType [3269,3297]
at 0
===
insert-tree
---
SimpleType [3273,3279]
    SimpleName: String [3273,3279]
to
ParameterizedType [3269,3297]
at 1
===
insert-node
---
ParameterizedType [3281,3296]
to
ParameterizedType [3269,3297]
at 2
===
update-node
---
NumberLiteral: 30000 [4962,4967]
replace 30000 by 10000
===
insert-tree
---
SimpleType [42277,42281]
    SimpleName: List [42277,42281]
to
ParameterizedType [12260,12295]
at 0
===
insert-node
---
VariableDeclarationStatement [43832,43990]
to
Block [13855,14618]
at 0
===
insert-tree
---
SimpleType [3281,3286]
    SimpleName: Deque [3281,3286]
to
ParameterizedType [3281,3296]
at 0
===
move-tree
---
SimpleType [24136,24144]
    SimpleName: Response [24136,24144]
to
ParameterizedType [3281,3296]
at 1
===
move-tree
---
SimpleType [13866,13872]
    SimpleName: String [13866,13872]
to
VariableDeclarationStatement [43832,43990]
at 0
===
insert-node
---
VariableDeclarationFragment [43839,43989]
to
VariableDeclarationStatement [43832,43990]
at 1
===
insert-node
---
InfixExpression [42399,42442]
to
VariableDeclarationFragment [12384,12413]
at 1
===
move-tree
---
SimpleName: url [13873,13876]
to
VariableDeclarationFragment [43839,43989]
at 0
===
insert-node
---
InfixExpression [43845,43989]
to
VariableDeclarationFragment [43839,43989]
at 1
===
update-node
---
SimpleName: requests [8438,8446]
replace requests by tasks
===
move-tree
---
SimpleName: requests [8438,8446]
to
EnhancedForStatement [8420,8641]
at 1
===
insert-node
---
SimpleName: BROKER_BASE_URL [42399,42414]
to
InfixExpression [42399,42442]
at 0
===
insert-node
---
INFIX_EXPRESSION_OPERATOR: + [42415,42416]
to
InfixExpression [42399,42442]
at 1
===
update-node
---
StringLiteral: "http://localhost:9001" [12390,12413]
replace "http://localhost:9001" by "/jobs/userA/graphA/jobA"
===
move-tree
---
StringLiteral: "http://localhost:9001" [12390,12413]
to
InfixExpression [42399,42442]
at 2
===
update-node
---
SimpleName: url [13913,13916]
replace url by BROKER_BASE_URL
===
move-tree
---
SimpleName: url [13913,13916]
to
InfixExpression [43845,43989]
at 0
===
insert-node
---
INFIX_EXPRESSION_OPERATOR: + [43861,43862]
to
InfixExpression [43845,43989]
at 1
===
move-tree
---
MethodInvocation [13920,14031]
    METHOD_INVOCATION_RECEIVER [13920,13926]
        SimpleName: String [13920,13926]
    SimpleName: format [13927,13933]
    METHOD_INVOCATION_ARGUMENTS [13934,14030]
        StringLiteral: "/jobs/%s/%s/%s/%s" [13934,13953]
        QualifiedName: clusterRequest.userId [13955,13976]
        QualifiedName: clusterRequest.graphId [13978,14000]
        QualifiedName: clusterRequest.jobId [14002,14022]
        SimpleName: taskId [14024,14030]
to
InfixExpression [43845,43989]
at 2
===
update-node
---
SimpleName: requests [8006,8014]
replace requests by tasks
===
update-node
---
SimpleName: requests [8049,8057]
replace requests by tasks
===
insert-tree
---
SimpleType [38457,38478]
    SimpleName: AnalystClusterRequest [38457,38478]
to
SingleVariableDeclaration [8425,8435]
at 0
===
update-node
---
SimpleName: taskId [8429,8435]
replace taskId by task
===
update-node
---
SimpleName: Map [7970,7973]
replace Map by List
===
insert-node
---
QualifiedName: clusterRequest.taskId [43967,43988]
to
METHOD_INVOCATION_ARGUMENTS [13934,14030]
at 4
===
update-node
---
SimpleName: values [8194,8200]
replace values by tasks
===
move-tree
---
SimpleName: values [8194,8200]
to
METHOD_INVOCATION_RECEIVER [8185,8202]
at 0
===
move-tree
---
METHOD_INVOCATION_ARGUMENTS [8529,8535]
    SimpleName: taskId [8529,8535]
to
MethodInvocation [8494,8537]
at 1
===
insert-node
---
QualifiedName: task.taskId [38600,38611]
to
METHOD_INVOCATION_ARGUMENTS [8565,8624]
at 1
===
update-node
---
SimpleName: taskId [8529,8535]
replace taskId by task
===
update-node
---
SimpleName: Map [12940,12943]
replace Map by List
===
delete-tree
---
PackageDeclaration [24380,24424]
    QualifiedName: org.opentripplanner.analyst.qbroker [24388,24423]
===
delete-tree
---
SimpleType [7974,7981]
    SimpleName: Integer [7974,7981]
===
delete-tree
---
METHOD_INVOCATION_RECEIVER [8185,8193]
    SimpleName: requests [8185,8193]
===
delete-node
---
MethodInvocation [8185,8202]
===
delete-node
---
PrimitiveType: int [8425,8428]
===
delete-node
---
METHOD_INVOCATION_RECEIVER [8438,8446]
===
delete-node
---
SimpleName: keySet [8447,8453]
===
delete-node
---
MethodInvocation [8438,8455]
===
delete-node
---
SimpleName: taskId [8508,8514]
===
delete-tree
---
METHOD_INVOCATION_RECEIVER [8516,8524]
    SimpleName: requests [8516,8524]
===
delete-node
---
SimpleName: get [8525,8528]
===
delete-node
---
MethodInvocation [8516,8536]
===
delete-node
---
METHOD_INVOCATION_ARGUMENTS [8508,8536]
===
delete-node
---
SimpleName: taskId [8588,8594]
===
delete-tree
---
SimpleType [12264,12271]
    SimpleName: Integer [12264,12271]
===
delete-tree
---
ExpressionStatement [12424,12457]
    Assignment [12424,12456]
        SimpleName: url [12424,12427]
        ASSIGNMENT_OPERATOR: += [12428,12430]
        StringLiteral: "/jobs/userA/graphA/jobA" [12431,12456]
===
delete-tree
---
SimpleType [12944,12951]
    SimpleName: Integer [12944,12951]
===
delete-tree
---
SingleVariableDeclaration [13805,13815]
    PrimitiveType: int [13805,13808]
    SimpleName: taskId [13809,13815]
===
delete-node
---
SimpleName: taskId [14024,14030]
===
delete-node
---
StringLiteral: "http://localhost:9001" [13879,13902]
===
delete-node
---
VariableDeclarationFragment [13873,13902]
===
delete-node
---
VariableDeclarationStatement [13866,13903]
===
delete-node
---
ASSIGNMENT_OPERATOR: += [13917,13919]
===
delete-node
---
Assignment [13913,14031]
===
delete-node
---
ExpressionStatement [13913,14032]
===
delete-tree
---
Javadoc [23995,24051]
    TagElement [24003,24046]
        TextElement: Represents a dormant connection waiting for [24003,24046]
===
delete-node
---
Modifier: public [24053,24059]
===
delete-node
---
TYPE_DECLARATION_KIND: class [24060,24065]
===
delete-node
---
SimpleName: LongPollConnection [24066,24084]
===
delete-tree
---
FieldDeclaration [24094,24108]
    SimpleType [24094,24098]
        SimpleName: Task [24094,24098]
    VariableDeclarationFragment [24099,24107]
        SimpleName: affinity [24099,24107]
===
delete-tree
---
FieldDeclaration [24114,24130]
    SimpleType [24114,24121]
        SimpleName: Request [24114,24121]
    VariableDeclarationFragment [24122,24129]
        SimpleName: request [24122,24129]
===
delete-tree
---
VariableDeclarationFragment [24145,24153]
    SimpleName: response [24145,24153]
===
delete-node
---
FieldDeclaration [24136,24154]
===
delete-node
---
Modifier: public [24162,24168]
===
delete-node
---
SimpleName: LongPollConnection [24169,24187]
===
delete-tree
---
Block [24224,24300]
    ExpressionStatement [24235,24258]
        Assignment [24235,24257]
            FieldAccess [24235,24247]
                ThisExpression [24235,24239]
                SimpleName: request [24240,24247]
            ASSIGNMENT_OPERATOR: = [24248,24249]
            SimpleName: request [24250,24257]
    ExpressionStatement [24268,24293]
        Assignment [24268,24292]
            FieldAccess [24268,24281]
                ThisExpression [24268,24272]
                SimpleName: response [24273,24281]
            ASSIGNMENT_OPERATOR: = [24282,24283]
            SimpleName: response [24284,24292]
===
delete-node
---
MethodDeclaration [24162,24300]
===
delete-node
---
TypeDeclaration [23995,24307]
===
delete-node
---
Javadoc [24428,24440]
===
delete-node
---
Modifier: public [24442,24448]
===
delete-node
---
TYPE_DECLARATION_KIND: class [24449,24454]
===
delete-node
---
SimpleName: Task [24455,24459]
===
delete-node
---
Modifier: public [24469,24475]
===
delete-node
---
PrimitiveType: int [24476,24479]
===
delete-node
---
FieldDeclaration [24469,24487]
===
delete-node
---
Modifier: public [24493,24499]
===
delete-tree
---
VariableDeclarationFragment [24507,24514]
    SimpleName: payload [24507,24514]
===
delete-node
---
FieldDeclaration [24493,24515]
===
delete-tree
---
FieldDeclaration [24607,24634]
    Modifier: public [24607,24613]
    PrimitiveType: long [24614,24618]
    VariableDeclarationFragment [24619,24633]
        SimpleName: invisibleUntil [24619,24633]
===
delete-node
---
TypeDeclaration [24428,24730]
