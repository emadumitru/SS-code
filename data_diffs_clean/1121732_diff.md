===
move-tree
---
ImportDeclaration [38179,38243]
    QualifiedName: org.apache.drill.exec.work.foreman.ForemanSetupException [38186,38242]
to
CompilationUnit [0,66459]
at 143
===
move-tree
---
ImportDeclaration [42484,42523]
    QualifiedName: com.google.common.collect.Lists [42491,42522]
to
CompilationUnit [0,66459]
at 149
===
move-tree
---
ImportDeclaration [17228,17292]
    QualifiedName: org.apache.drill.exec.work.foreman.ForemanSetupException [17235,17291]
to
CompilationUnit [0,66459]
at 166
===
move-tree
---
ImportDeclaration [17546,17585]
    QualifiedName: com.google.common.collect.Lists [17553,17584]
to
CompilationUnit [0,66459]
at 172
===
move-tree
---
ImportDeclaration [43734,43781]
    QualifiedName: org.apache.calcite.rel.type.RelDataType [43741,43780]
to
CompilationUnit [0,66459]
at 203
===
move-tree
---
ImportDeclaration [64186,64215]
    QualifiedName: java.util.Collections [64193,64214]
to
CompilationUnit [0,66459]
at 241
===
move-tree
---
ImportDeclaration [60416,60438]
    QualifiedName: java.util.List [60423,60437]
to
CompilationUnit [0,66459]
at 241
===
insert-tree
---
ImportDeclaration [43686,43733]
    QualifiedName: org.apache.calcite.rel.type.RelDataType [43693,43732]
to
CompilationUnit [0,66459]
at 197
===
move-tree
---
MethodDeclaration [32098,32477]
    Javadoc [32098,32359]
        TagElement [32108,32252]
            TextElement: Rewrite the parse tree. Used before validating the parse tree. Useful if a particular statement needs to converted [32108,32222]
            TextElement: into another statement. [32229,32252]
        TagElement [32265,32276]
            SimpleName: node [32272,32276]
        TagElement [32283,32315]
            TextElement:  Rewritten sql parse tree [32290,32315]
        TagElement [32322,32352]
            SimpleName: RelConversionException [32330,32352]
    Modifier: public [32363,32369]
    SimpleType [32370,32377]
        SimpleName: SqlNode [32370,32377]
    SimpleName: rewrite [32378,32385]
    SingleVariableDeclaration [32386,32398]
        SimpleType [32386,32393]
            SimpleName: SqlNode [32386,32393]
        SimpleName: node [32394,32398]
    SimpleType [32407,32429]
        SimpleName: RelConversionException [32407,32429]
    SimpleType [32431,32452]
        SimpleName: ForemanSetupException [32431,32452]
    Block [32453,32477]
        ReturnStatement [32460,32472]
            SimpleName: node [32467,32471]
to
TypeDeclaration [17589,36306]
at 17
===
move-tree
---
MethodDeclaration [21016,21761]
    Modifier: protected [21016,21025]
    SimpleType [21026,21038]
        SimpleName: TypedSqlNode [21026,21038]
    SimpleName: validateNode [21039,21051]
    SingleVariableDeclaration [21052,21067]
        SimpleType [21052,21059]
            SimpleName: SqlNode [21052,21059]
        SimpleName: sqlNode [21060,21067]
    SimpleType [21076,21095]
        SimpleName: ValidationException [21076,21095]
    SimpleType [21097,21119]
        SimpleName: RelConversionException [21097,21119]
    SimpleType [21121,21142]
        SimpleName: ForemanSetupException [21121,21142]
    Block [21143,21761]
        VariableDeclarationStatement [21150,21214]
            SimpleType [21150,21162]
                SimpleName: TypedSqlNode [21150,21162]
            VariableDeclarationFragment [21163,21213]
                SimpleName: typedSqlNode [21163,21175]
                MethodInvocation [21178,21213]
                    METHOD_INVOCATION_RECEIVER [21178,21185]
                        SimpleName: planner [21178,21185]
                    SimpleName: validateAndGetType [21186,21204]
                    METHOD_INVOCATION_ARGUMENTS [21205,21212]
                        SimpleName: sqlNode [21205,21212]
        VariableDeclarationStatement [21222,21275]
            SimpleType [21222,21229]
                SimpleName: SqlNode [21222,21229]
            VariableDeclarationFragment [21230,21274]
                SimpleName: sqlNodeValidated [21230,21246]
                MethodInvocation [21249,21274]
                    METHOD_INVOCATION_RECEIVER [21249,21261]
                        SimpleName: typedSqlNode [21249,21261]
                    SimpleName: getSqlNode [21262,21272]
        VariableDeclarationStatement [21338,21427]
            SimpleType [21338,21365]
                SimpleName: UnsupportedOperatorsVisitor [21338,21365]
            VariableDeclarationFragment [21366,21426]
                SimpleName: visitor [21366,21373]
                MethodInvocation [21376,21426]
                    METHOD_INVOCATION_RECEIVER [21376,21403]
                        SimpleName: UnsupportedOperatorsVisitor [21376,21403]
                    SimpleName: createVisitor [21404,21417]
                    METHOD_INVOCATION_ARGUMENTS [21418,21425]
                        SimpleName: context [21418,21425]
        TryStatement [21433,21728]
            Block [21437,21486]
                ExpressionStatement [21446,21479]
                    MethodInvocation [21446,21478]
                        METHOD_INVOCATION_RECEIVER [21446,21462]
                            SimpleName: sqlNodeValidated [21446,21462]
                        SimpleName: accept [21463,21469]
                        METHOD_INVOCATION_ARGUMENTS [21470,21477]
                            SimpleName: visitor [21470,21477]
            CatchClause [21487,21728]
                SingleVariableDeclaration [21494,21526]
                    SimpleType [21494,21523]
                        SimpleName: UnsupportedOperationException [21494,21523]
                    SimpleName: ex [21524,21526]
                Block [21528,21728]
                    ExpressionStatement [21603,21630]
                        MethodInvocation [21603,21629]
                            METHOD_INVOCATION_RECEIVER [21603,21610]
                                SimpleName: visitor [21603,21610]
                            SimpleName: convertException [21611,21627]
                    ThrowStatement [21712,21721]
                        SimpleName: ex [21718,21720]
        ReturnStatement [21736,21756]
            SimpleName: typedSqlNode [21743,21755]
to
TypeDeclaration [17589,36306]
at 28
===
move-tree
---
MethodDeclaration [21767,22004]
    Modifier: protected [21767,21776]
    SimpleType [21777,21784]
        SimpleName: RelNode [21777,21784]
    SimpleName: convertToRel [21785,21797]
    SingleVariableDeclaration [21798,21810]
        SimpleType [21798,21805]
            SimpleName: SqlNode [21798,21805]
        SimpleName: node [21806,21810]
    SimpleType [21819,21841]
        SimpleName: RelConversionException [21819,21841]
    Block [21842,22004]
        VariableDeclarationStatement [21849,21895]
            SimpleType [21849,21856]
                SimpleName: RelNode [21849,21856]
            VariableDeclarationFragment [21857,21894]
                SimpleName: convertedNode [21857,21870]
                MethodInvocation [21873,21894]
                    METHOD_INVOCATION_RECEIVER [21873,21880]
                        SimpleName: planner [21873,21880]
                    SimpleName: convert [21881,21888]
                    METHOD_INVOCATION_ARGUMENTS [21889,21893]
                        SimpleName: node [21889,21893]
        ExpressionStatement [21901,21935]
            MethodInvocation [21901,21934]
                METHOD_INVOCATION_RECEIVER [21901,21911]
                    SimpleName: hepPlanner [21901,21911]
                SimpleName: setRoot [21912,21919]
                METHOD_INVOCATION_ARGUMENTS [21920,21933]
                    SimpleName: convertedNode [21920,21933]
        VariableDeclarationStatement [21941,21980]
            SimpleType [21941,21948]
                SimpleName: RelNode [21941,21948]
            VariableDeclarationFragment [21949,21979]
                SimpleName: rel [21949,21952]
                MethodInvocation [21955,21979]
                    METHOD_INVOCATION_RECEIVER [21955,21965]
                        SimpleName: hepPlanner [21955,21965]
                    SimpleName: findBestExp [21966,21977]
        ReturnStatement [21988,21999]
            SimpleName: rel [21995,21998]
to
TypeDeclaration [17589,36306]
at 28
===
move-tree
---
MethodDeclaration [22010,22847]
    Modifier: protected [22010,22019]
    SimpleType [22020,22027]
        SimpleName: RelNode [22020,22027]
    SimpleName: preprocessNode [22028,22042]
    SingleVariableDeclaration [22043,22054]
        SimpleType [22043,22050]
            SimpleName: RelNode [22043,22050]
        SimpleName: rel [22051,22054]
    SimpleType [22063,22086]
        SimpleName: SqlUnsupportedException [22063,22086]
    Block [22087,22847]
        VariableDeclarationStatement [22535,22669]
            SimpleType [22535,22555]
                SimpleName: PreProcessLogicalRel [22535,22555]
            VariableDeclarationFragment [22556,22668]
                SimpleName: visitor [22556,22563]
                MethodInvocation [22566,22668]
                    METHOD_INVOCATION_RECEIVER [22566,22586]
                        SimpleName: PreProcessLogicalRel [22566,22586]
                    SimpleName: createVisitor [22587,22600]
                    METHOD_INVOCATION_ARGUMENTS [22601,22667]
                        MethodInvocation [22601,22625]
                            METHOD_INVOCATION_RECEIVER [22601,22608]
                                SimpleName: planner [22601,22608]
                            SimpleName: getTypeFactory [22609,22623]
                        MethodInvocation [22636,22667]
                            METHOD_INVOCATION_RECEIVER [22636,22643]
                                SimpleName: context [22636,22643]
                            SimpleName: getDrillOperatorTable [22644,22665]
        TryStatement [22675,22823]
            Block [22679,22721]
                ExpressionStatement [22688,22714]
                    Assignment [22688,22713]
                        SimpleName: rel [22688,22691]
                        ASSIGNMENT_OPERATOR: = [22692,22693]
                        MethodInvocation [22694,22713]
                            METHOD_INVOCATION_RECEIVER [22694,22697]
                                SimpleName: rel [22694,22697]
                            SimpleName: accept [22698,22704]
                            METHOD_INVOCATION_ARGUMENTS [22705,22712]
                                SimpleName: visitor [22705,22712]
            CatchClause [22722,22823]
                SingleVariableDeclaration [22729,22761]
                    SimpleType [22729,22758]
                        SimpleName: UnsupportedOperationException [22729,22758]
                    SimpleName: ex [22759,22761]
                Block [22763,22823]
                    ExpressionStatement [22772,22799]
                        MethodInvocation [22772,22798]
                            METHOD_INVOCATION_RECEIVER [22772,22779]
                                SimpleName: visitor [22772,22779]
                            SimpleName: convertException [22780,22796]
                    ThrowStatement [22807,22816]
                        SimpleName: ex [22813,22815]
        ReturnStatement [22831,22842]
            SimpleName: rel [22838,22841]
to
TypeDeclaration [17589,36306]
at 28
===
move-tree
---
MethodDeclaration [20053,21008]
    Modifier: protected [20053,20062]
    SimpleType [20063,20071]
        SimpleName: DrillRel [20063,20071]
    SimpleName: addRenamedProject [20072,20089]
    SingleVariableDeclaration [20090,20102]
        SimpleType [20090,20098]
            SimpleName: DrillRel [20090,20098]
        SimpleName: rel [20099,20102]
    SingleVariableDeclaration [20104,20132]
        SimpleType [20104,20115]
            SimpleName: RelDataType [20104,20115]
        SimpleName: validatedRowType [20116,20132]
    Block [20134,21008]
        VariableDeclarationStatement [20141,20174]
            SimpleType [20141,20152]
                SimpleName: RelDataType [20141,20152]
            VariableDeclarationFragment [20153,20173]
                SimpleName: t [20153,20154]
                MethodInvocation [20157,20173]
                    METHOD_INVOCATION_RECEIVER [20157,20160]
                        SimpleName: rel [20157,20160]
                    SimpleName: getRowType [20161,20171]
        VariableDeclarationStatement [20182,20230]
            SimpleType [20182,20192]
                SimpleName: RexBuilder [20182,20192]
            VariableDeclarationFragment [20193,20229]
                SimpleName: b [20193,20194]
                MethodInvocation [20197,20229]
                    METHOD_INVOCATION_RECEIVER [20197,20213]
                        MethodInvocation [20197,20213]
                            METHOD_INVOCATION_RECEIVER [20197,20200]
                                SimpleName: rel [20197,20200]
                            SimpleName: getCluster [20201,20211]
                    SimpleName: getRexBuilder [20214,20227]
        VariableDeclarationStatement [20236,20285]
            ParameterizedType [20236,20249]
                SimpleType [20236,20240]
                    SimpleName: List [20236,20240]
                SimpleType [20241,20248]
                    SimpleName: RexNode [20241,20248]
            VariableDeclarationFragment [20250,20284]
                SimpleName: projections [20250,20261]
                MethodInvocation [20264,20284]
                    METHOD_INVOCATION_RECEIVER [20264,20269]
                        SimpleName: Lists [20264,20269]
                    SimpleName: newArrayList [20270,20282]
        VariableDeclarationStatement [20291,20334]
            PrimitiveType: int [20291,20294]
            VariableDeclarationFragment [20295,20333]
                SimpleName: projectCount [20295,20307]
                MethodInvocation [20310,20333]
                    METHOD_INVOCATION_RECEIVER [20310,20326]
                        MethodInvocation [20310,20326]
                            METHOD_INVOCATION_RECEIVER [20310,20311]
                                SimpleName: t [20310,20311]
                            SimpleName: getFieldList [20312,20324]
                    SimpleName: size [20327,20331]
        ForStatement [20342,20436]
            VariableDeclarationExpression [20347,20355]
                PrimitiveType: int [20347,20350]
                VariableDeclarationFragment [20351,20355]
                    SimpleName: i [20351,20352]
                    NumberLiteral: 0 [20354,20355]
            InfixExpression [20357,20373]
                SimpleName: i [20357,20358]
                INFIX_EXPRESSION_OPERATOR: < [20359,20360]
                SimpleName: projectCount [20361,20373]
            PostfixExpression [20375,20378]
                SimpleName: i [20375,20376]
                POSTFIX_EXPRESSION_OPERATOR: ++ [20376,20378]
            Block [20380,20436]
                ExpressionStatement [20389,20429]
                    MethodInvocation [20389,20428]
                        METHOD_INVOCATION_RECEIVER [20389,20400]
                            SimpleName: projections [20389,20400]
                        SimpleName: add [20401,20404]
                        METHOD_INVOCATION_ARGUMENTS [20405,20427]
                            MethodInvocation [20405,20427]
                                METHOD_INVOCATION_RECEIVER [20405,20406]
                                    SimpleName: b [20405,20406]
                                SimpleName: makeInputRef [20407,20419]
                                METHOD_INVOCATION_ARGUMENTS [20420,20426]
                                    SimpleName: rel [20420,20423]
                                    SimpleName: i [20425,20426]
        VariableDeclarationStatement [20444,20568]
            Modifier: final [20444,20449]
            ParameterizedType [20450,20462]
                SimpleType [20450,20454]
                    SimpleName: List [20450,20454]
                SimpleType [20455,20461]
                    SimpleName: String [20455,20461]
            VariableDeclarationFragment [20463,20567]
                SimpleName: fieldNames2 [20463,20474]
                MethodInvocation [20477,20567]
                    METHOD_INVOCATION_RECEIVER [20477,20493]
                        SimpleName: SqlValidatorUtil [20477,20493]
                    SimpleName: uniquify [20494,20502]
                    METHOD_INVOCATION_ARGUMENTS [20503,20566]
                        MethodInvocation [20503,20535]
                            METHOD_INVOCATION_RECEIVER [20503,20519]
                                SimpleName: validatedRowType [20503,20519]
                            SimpleName: getFieldNames [20520,20533]
                        QualifiedName: SqlValidatorUtil.F_SUGGESTER2 [20537,20566]
        VariableDeclarationStatement [20576,20687]
            SimpleType [20576,20587]
                SimpleName: RelDataType [20576,20587]
            VariableDeclarationFragment [20588,20686]
                SimpleName: newRowType [20588,20598]
                MethodInvocation [20601,20686]
                    METHOD_INVOCATION_RECEIVER [20601,20608]
                        SimpleName: RexUtil [20601,20608]
                    SimpleName: createStructType [20609,20625]
                    METHOD_INVOCATION_ARGUMENTS [20626,20685]
                        MethodInvocation [20626,20659]
                            METHOD_INVOCATION_RECEIVER [20626,20642]
                                MethodInvocation [20626,20642]
                                    METHOD_INVOCATION_RECEIVER [20626,20629]
                                        SimpleName: rel [20626,20629]
                                    SimpleName: getCluster [20630,20640]
                            SimpleName: getTypeFactory [20643,20657]
                        SimpleName: projections [20661,20672]
                        SimpleName: fieldNames2 [20674,20685]
        VariableDeclarationStatement [20695,20811]
            SimpleType [20695,20710]
                SimpleName: DrillProjectRel [20695,20710]
            VariableDeclarationFragment [20711,20810]
                SimpleName: topProj [20711,20718]
                MethodInvocation [20721,20810]
                    METHOD_INVOCATION_RECEIVER [20721,20736]
                        SimpleName: DrillProjectRel [20721,20736]
                    SimpleName: create [20737,20743]
                    METHOD_INVOCATION_ARGUMENTS [20744,20809]
                        MethodInvocation [20744,20760]
                            METHOD_INVOCATION_RECEIVER [20744,20747]
                                SimpleName: rel [20744,20747]
                            SimpleName: getCluster [20748,20758]
                        MethodInvocation [20762,20779]
                            METHOD_INVOCATION_RECEIVER [20762,20765]
                                SimpleName: rel [20762,20765]
                            SimpleName: getTraitSet [20766,20777]
                        SimpleName: rel [20781,20784]
                        SimpleName: projections [20786,20797]
                        SimpleName: newRowType [20799,20809]
        IfStatement [20819,20930]
            MethodInvocation [20823,20865]
                METHOD_INVOCATION_RECEIVER [20823,20840]
                    SimpleName: ProjectRemoveRule [20823,20840]
                SimpleName: isTrivial [20841,20850]
                METHOD_INVOCATION_ARGUMENTS [20851,20864]
                    SimpleName: topProj [20851,20858]
                    BooleanLiteral: true [20860,20864]
            Block [20867,20894]
                ReturnStatement [20876,20887]
                    SimpleName: rel [20883,20886]
            Block [20899,20930]
                ReturnStatement [20908,20923]
                    SimpleName: topProj [20915,20922]
to
TypeDeclaration [17589,36306]
at 28
===
insert-node
---
Modifier: public [15975,15981]
to
TypeDeclaration [17589,36306]
at 1
===
insert-node
---
TYPE_DECLARATION_KIND: class [15982,15987]
to
TypeDeclaration [17589,36306]
at 2
===
insert-node
---
SimpleName: DefaultSqlHandler [15988,16005]
to
TypeDeclaration [17589,36306]
at 3
===
insert-node
---
MethodDeclaration [17609,18348]
to
TypeDeclaration [17589,36306]
at 20
===
move-tree
---
SimpleType [19307,19329]
    SimpleName: RelConversionException [19307,19329]
to
MethodDeclaration [19221,20047]
at 8
===
move-tree
---
SimpleType [19286,19305]
    SimpleName: ValidationException [19286,19305]
to
MethodDeclaration [19221,20047]
at 8
===
move-tree
---
SimpleType [22940,22962]
    SimpleName: RelConversionException [22940,22962]
to
MethodDeclaration [22853,24411]
at 6
===
insert-node
---
MethodDeclaration [20700,21661]
to
TypeDeclaration [17589,36306]
at 24
===
insert-tree
---
TypeDeclaration [35894,36357]
    Modifier: protected [35894,35903]
    TYPE_DECLARATION_KIND: class [35904,35909]
    SimpleName: ConvertedRelNode [35910,35926]
    FieldDeclaration [35934,35964]
        Modifier: private [35934,35941]
        Modifier: final [35942,35947]
        SimpleType [35948,35955]
            SimpleName: RelNode [35948,35955]
        VariableDeclarationFragment [35956,35963]
            SimpleName: relNode [35956,35963]
    FieldDeclaration [35970,36013]
        Modifier: private [35970,35977]
        Modifier: final [35978,35983]
        SimpleType [35984,35995]
            SimpleName: RelDataType [35984,35995]
        VariableDeclarationFragment [35996,36012]
            SimpleName: validatedRowType [35996,36012]
    MethodDeclaration [36021,36180]
        Modifier: public [36021,36027]
        SimpleName: ConvertedRelNode [36028,36044]
        SingleVariableDeclaration [36045,36060]
            SimpleType [36045,36052]
                SimpleName: RelNode [36045,36052]
            SimpleName: relNode [36053,36060]
        SingleVariableDeclaration [36062,36090]
            SimpleType [36062,36073]
                SimpleName: RelDataType [36062,36073]
            SimpleName: validatedRowType [36074,36090]
        Block [36092,36180]
            ExpressionStatement [36101,36124]
                Assignment [36101,36123]
                    FieldAccess [36101,36113]
                        ThisExpression [36101,36105]
                        SimpleName: relNode [36106,36113]
                    ASSIGNMENT_OPERATOR: = [36114,36115]
                    SimpleName: relNode [36116,36123]
            ExpressionStatement [36132,36173]
                Assignment [36132,36172]
                    FieldAccess [36132,36153]
                        ThisExpression [36132,36136]
                        SimpleName: validatedRowType [36137,36153]
                    ASSIGNMENT_OPERATOR: = [36154,36155]
                    SimpleName: validatedRowType [36156,36172]
    MethodDeclaration [36188,36258]
        Modifier: public [36188,36194]
        SimpleType [36195,36202]
            SimpleName: RelNode [36195,36202]
        SimpleName: getConvertedNode [36203,36219]
        Block [36222,36258]
            ReturnStatement [36231,36251]
                FieldAccess [36238,36250]
                    ThisExpression [36238,36242]
                    SimpleName: relNode [36243,36250]
    MethodDeclaration [36266,36352]
        Modifier: public [36266,36272]
        SimpleType [36273,36284]
            SimpleName: RelDataType [36273,36284]
        SimpleName: getValidatedRowType [36285,36304]
        Block [36307,36352]
            ReturnStatement [36316,36345]
                FieldAccess [36323,36344]
                    ThisExpression [36323,36327]
                    SimpleName: validatedRowType [36328,36344]
to
TypeDeclaration [17589,36306]
at 38
===
insert-tree
---
SingleVariableDeclaration [5001,5025]
    SimpleType [5001,5012]
        SimpleName: RelDataType [5001,5012]
    SimpleName: queryRowType [5013,5025]
to
MethodDeclaration [5021,5736]
at 7
===
insert-tree
---
SimpleType [5065,5088]
    SimpleName: SqlUnsupportedException [5065,5088]
to
MethodDeclaration [5021,5736]
at 9
===
move-tree
---
MarkerAnnotation [19221,19230]
    SimpleName: Override [19222,19230]
to
MethodDeclaration [17609,18348]
at 0
===
insert-node
---
Modifier: public [17622,17628]
to
MethodDeclaration [17609,18348]
at 1
===
move-tree
---
SimpleType [19241,19253]
    SimpleName: PhysicalPlan [19241,19253]
to
MethodDeclaration [17609,18348]
at 2
===
insert-node
---
SimpleName: getPlan [17642,17649]
to
MethodDeclaration [17609,18348]
at 3
===
insert-tree
---
SingleVariableDeclaration [17650,17665]
    SimpleType [17650,17657]
        SimpleName: SqlNode [17650,17657]
    SimpleName: sqlNode [17658,17665]
to
MethodDeclaration [17609,18348]
at 4
===
insert-tree
---
SimpleType [17674,17693]
    SimpleName: ValidationException [17674,17693]
to
MethodDeclaration [17609,18348]
at 5
===
insert-tree
---
SimpleType [17695,17717]
    SimpleName: RelConversionException [17695,17717]
to
MethodDeclaration [17609,18348]
at 6
===
move-tree
---
SimpleType [19331,19342]
    SimpleName: IOException [19331,19342]
to
MethodDeclaration [17609,18348]
at 7
===
insert-tree
---
SimpleType [17732,17753]
    SimpleName: ForemanSetupException [17732,17753]
to
MethodDeclaration [17609,18348]
at 8
===
insert-node
---
Block [17754,18348]
to
MethodDeclaration [17609,18348]
at 9
===
update-node
---
Modifier: public [32363,32369]
replace public by protected
===
update-node
---
Modifier: public [19234,19240]
replace public by protected
===
insert-tree
---
SimpleType [18754,18770]
    SimpleName: ConvertedRelNode [18754,18770]
to
MethodDeclaration [19221,20047]
at 1
===
update-node
---
SimpleName: getPlan [19254,19261]
replace getPlan by validateAndConvert
===
insert-tree
---
Javadoc [19248,19457]
    TagElement [19259,19340]
        TextElement: Given a relNode tree for SELECT statement, convert to Drill Logical RelNode tree. [19259,19340]
    TagElement [19347,19361]
        SimpleName: relNode [19354,19361]
    TagElement [19368,19375]
    TagElement [19382,19413]
        SimpleName: SqlUnsupportedException [19390,19413]
    TagElement [19420,19450]
        SimpleName: RelConversionException [19428,19450]
to
MethodDeclaration [22853,24411]
at 0
===
insert-tree
---
Javadoc [20700,21109]
    TagElement [20710,20809]
        TextElement: Return Drill Logical RelNode tree for a SELECT statement, when it is executed / explained directly. [20710,20809]
    TagElement [20822,20891]
        SimpleName: relNode [20829,20836]
        TextElement:  : root RelNode corresponds to Calcite Logical RelNode. [20836,20891]
    TagElement [20898,21013]
        SimpleName: validatedRowType [20905,20921]
        TextElement:  : the rowType for the final field names. A rename project may be placed on top of the root. [20921,21013]
    TagElement [21020,21027]
    TagElement [21034,21064]
        SimpleName: RelConversionException [21042,21064]
    TagElement [21071,21102]
        SimpleName: SqlUnsupportedException [21079,21102]
to
MethodDeclaration [20700,21661]
at 0
===
insert-node
---
Modifier: protected [21113,21122]
to
MethodDeclaration [20700,21661]
at 1
===
insert-tree
---
SimpleType [21123,21131]
    SimpleName: DrillRel [21123,21131]
to
MethodDeclaration [20700,21661]
at 2
===
insert-node
---
SimpleName: convertToDrel [21132,21145]
to
MethodDeclaration [20700,21661]
at 3
===
insert-tree
---
SingleVariableDeclaration [21146,21161]
    SimpleType [21146,21153]
        SimpleName: RelNode [21146,21153]
    SimpleName: relNode [21154,21161]
to
MethodDeclaration [20700,21661]
at 4
===
move-tree
---
SingleVariableDeclaration [22903,22931]
    SimpleType [22903,22914]
        SimpleName: RelDataType [22903,22914]
    SimpleName: validatedRowType [22915,22931]
to
MethodDeclaration [20700,21661]
at 5
===
insert-tree
---
SimpleType [21200,21222]
    SimpleName: RelConversionException [21200,21222]
to
MethodDeclaration [20700,21661]
at 6
===
insert-tree
---
SimpleType [21224,21247]
    SimpleName: SqlUnsupportedException [21224,21247]
to
MethodDeclaration [20700,21661]
at 7
===
move-tree
---
Block [23381,24012]
    IfStatement [23516,23643]
        MethodInvocation [23520,23570]
            METHOD_INVOCATION_RECEIVER [23520,23537]
                SimpleName: FindLimit0Visitor [23520,23537]
            SimpleName: containsLimit0 [23538,23552]
            METHOD_INVOCATION_ARGUMENTS [23553,23569]
                SimpleName: convertedRelNode [23553,23569]
        Block [23572,23643]
            ExpressionStatement [23585,23632]
                MethodInvocation [23585,23631]
                    METHOD_INVOCATION_RECEIVER [23585,23613]
                        MethodInvocation [23585,23613]
                            METHOD_INVOCATION_RECEIVER [23585,23592]
                                SimpleName: context [23585,23592]
                            SimpleName: getPlannerSettings [23593,23611]
                    SimpleName: forceSingleMode [23614,23629]
    VariableDeclarationStatement [23764,23861]
        SimpleType [23764,23772]
            SimpleName: DrillRel [23764,23772]
        VariableDeclarationFragment [23773,23860]
            SimpleName: topPreservedNameProj [23773,23793]
            MethodInvocation [23796,23860]
                SimpleName: addRenamedProject [23796,23813]
                METHOD_INVOCATION_ARGUMENTS [23814,23859]
                    CastExpression [23814,23841]
                        SimpleType [23815,23823]
                            SimpleName: DrillRel [23815,23823]
                        SimpleName: convertedRelNode [23825,23841]
                    SimpleName: validatedRowType [23843,23859]
    ReturnStatement [23871,24003]
        ClassInstanceCreation [23878,24002]
            SimpleType [23882,23896]
                SimpleName: DrillScreenRel [23882,23896]
            MethodInvocation [23897,23930]
                METHOD_INVOCATION_RECEIVER [23897,23917]
                    SimpleName: topPreservedNameProj [23897,23917]
                SimpleName: getCluster [23918,23928]
            MethodInvocation [23932,23966]
                METHOD_INVOCATION_RECEIVER [23932,23952]
                    SimpleName: topPreservedNameProj [23932,23952]
                SimpleName: getTraitSet [23953,23964]
            SimpleName: topPreservedNameProj [23981,24001]
to
MethodDeclaration [20700,21661]
at 8
===
update-node
---
Modifier: protected [21016,21025]
replace protected by private
===
update-node
---
Modifier: protected [21767,21776]
replace protected by private
===
update-node
---
Modifier: protected [22010,22019]
replace protected by private
===
update-node
---
Modifier: protected [20053,20062]
replace protected by private
===
update-node
---
Modifier: public [33673,33679]
replace public by private
===
insert-node
---
SingleVariableDeclaration [44947,44967]
to
MethodDeclaration [43998,47833]
at 9
===
update-node
---
SimpleName: AbstractSqlHandler [54429,54447]
replace AbstractSqlHandler by DefaultSqlHandler
===
insert-node
---
VariableDeclarationStatement [3340,3416]
to
Block [3519,5015]
at 3
===
insert-node
---
VariableDeclarationStatement [3422,3487]
to
Block [3519,5015]
at 4
===
insert-node
---
VariableDeclarationStatement [3497,3641]
to
Block [3519,5015]
at 5
===
insert-tree
---
VariableDeclarationStatement [17761,17831]
    Modifier: final [17761,17766]
    SimpleType [17767,17783]
        SimpleName: ConvertedRelNode [17767,17783]
    VariableDeclarationFragment [17784,17830]
        SimpleName: convertedRelNode [17784,17800]
        MethodInvocation [17803,17830]
            SimpleName: validateAndConvert [17803,17821]
            METHOD_INVOCATION_ARGUMENTS [17822,17829]
                SimpleName: sqlNode [17822,17829]
to
Block [17754,18348]
at 0
===
insert-node
---
VariableDeclarationStatement [17837,17913]
to
Block [17754,18348]
at 1
===
insert-node
---
VariableDeclarationStatement [17919,17984]
to
Block [17754,18348]
at 2
===
insert-tree
---
ExpressionStatement [17992,18027]
    MethodInvocation [17992,18026]
        SimpleName: log [17992,17995]
        METHOD_INVOCATION_ARGUMENTS [17996,18025]
            StringLiteral: "Optiq Logical" [17996,18011]
            SimpleName: queryRelNode [18013,18025]
to
Block [17754,18348]
at 3
===
insert-node
---
VariableDeclarationStatement [18033,18095]
to
Block [17754,18348]
at 4
===
move-tree
---
ExpressionStatement [19802,19829]
    MethodInvocation [19802,19828]
        SimpleName: log [19802,19805]
        METHOD_INVOCATION_ARGUMENTS [19806,19827]
            StringLiteral: "Drill Logical" [19806,19821]
            SimpleName: drel [19823,19827]
to
Block [17754,18348]
at 5
===
move-tree
---
VariableDeclarationStatement [19835,19867]
    SimpleType [19835,19839]
        SimpleName: Prel [19835,19839]
    VariableDeclarationFragment [19840,19866]
        SimpleName: prel [19840,19844]
        MethodInvocation [19847,19866]
            SimpleName: convertToPrel [19847,19860]
            METHOD_INVOCATION_ARGUMENTS [19861,19865]
                SimpleName: drel [19861,19865]
to
Block [17754,18348]
at 6
===
move-tree
---
ExpressionStatement [19873,19901]
    MethodInvocation [19873,19900]
        SimpleName: log [19873,19876]
        METHOD_INVOCATION_ARGUMENTS [19877,19899]
            StringLiteral: "Drill Physical" [19877,19893]
            SimpleName: prel [19895,19899]
to
Block [17754,18348]
at 7
===
move-tree
---
VariableDeclarationStatement [19907,19949]
    SimpleType [19907,19923]
        SimpleName: PhysicalOperator [19907,19923]
    VariableDeclarationFragment [19924,19948]
        SimpleName: pop [19924,19927]
        MethodInvocation [19930,19948]
            SimpleName: convertToPop [19930,19942]
            METHOD_INVOCATION_ARGUMENTS [19943,19947]
                SimpleName: prel [19943,19947]
to
Block [17754,18348]
at 8
===
move-tree
---
VariableDeclarationStatement [19955,19994]
    SimpleType [19955,19967]
        SimpleName: PhysicalPlan [19955,19967]
    VariableDeclarationFragment [19968,19993]
        SimpleName: plan [19968,19972]
        MethodInvocation [19975,19993]
            SimpleName: convertToPlan [19975,19988]
            METHOD_INVOCATION_ARGUMENTS [19989,19992]
                SimpleName: pop [19989,19992]
to
Block [17754,18348]
at 9
===
move-tree
---
ExpressionStatement [20000,20024]
    MethodInvocation [20000,20023]
        SimpleName: log [20000,20003]
        METHOD_INVOCATION_ARGUMENTS [20004,20022]
            StringLiteral: "Drill Plan" [20004,20016]
            SimpleName: plan [20018,20022]
to
Block [17754,18348]
at 10
===
move-tree
---
ReturnStatement [20030,20042]
    SimpleName: plan [20037,20041]
to
Block [17754,18348]
at 11
===
insert-node
---
ReturnStatement [19171,19237]
to
Block [19366,20047]
at 6
===
insert-tree
---
VariableDeclarationStatement [21255,21312]
    Modifier: final [21255,21260]
    SimpleType [21261,21269]
        SimpleName: DrillRel [21261,21269]
    VariableDeclarationFragment [21270,21311]
        SimpleName: convertedRelNode [21270,21286]
        MethodInvocation [21289,21311]
            SimpleName: convertToDrel [21289,21302]
            METHOD_INVOCATION_ARGUMENTS [21303,21310]
                SimpleName: relNode [21303,21310]
to
Block [23381,24012]
at 0
===
update-node
---
SimpleName: node [38888,38892]
replace node by sqlNode
===
update-node
---
SimpleName: newTableQueryDef [45254,45270]
replace newTableQueryDef by validatedRowtype
===
move-tree
---
SimpleType [45334,45346]
    SimpleName: TypedSqlNode [45334,45346]
to
SingleVariableDeclaration [44947,44967]
at 0
===
update-node
---
SimpleName: validatedSqlNodeWithType [45347,45371]
replace validatedSqlNodeWithType by queryRelNode
===
move-tree
---
SimpleName: validatedSqlNodeWithType [45347,45371]
to
SingleVariableDeclaration [44947,44967]
at 1
===
update-node
---
SimpleName: context [54667,54674]
replace context by config
===
insert-node
---
SuperConstructorInvocation [54171,54185]
to
Block [54676,54740]
at 0
===
insert-tree
---
SimpleType [3252,3268]
    SimpleName: ConvertedRelNode [3252,3268]
to
VariableDeclarationStatement [3661,3809]
at 1
===
insert-node
---
Modifier: final [3340,3345]
to
VariableDeclarationStatement [3340,3416]
at 0
===
move-tree
---
SimpleType [19558,19569]
    SimpleName: RelDataType [19558,19569]
to
VariableDeclarationStatement [3340,3416]
at 1
===
insert-tree
---
VariableDeclarationFragment [3358,3415]
    SimpleName: validatedRowType [3358,3374]
    MethodInvocation [3377,3415]
        METHOD_INVOCATION_RECEIVER [3377,3393]
            SimpleName: convertedRelNode [3377,3393]
        SimpleName: getValidatedRowType [3394,3413]
to
VariableDeclarationStatement [3340,3416]
at 2
===
insert-node
---
Modifier: final [3422,3427]
to
VariableDeclarationStatement [3422,3487]
at 0
===
move-tree
---
SimpleType [46090,46097]
    SimpleName: RelNode [46090,46097]
to
VariableDeclarationStatement [3422,3487]
at 1
===
insert-tree
---
VariableDeclarationFragment [3436,3486]
    SimpleName: queryRelNode [3436,3448]
    MethodInvocation [3451,3486]
        METHOD_INVOCATION_RECEIVER [3451,3467]
            SimpleName: convertedRelNode [3451,3467]
        SimpleName: getConvertedNode [3468,3484]
to
VariableDeclarationStatement [3422,3487]
at 2
===
insert-node
---
Modifier: final [3497,3502]
to
VariableDeclarationStatement [3497,3641]
at 0
===
move-tree
---
SimpleType [3667,3674]
    SimpleName: RelNode [3667,3674]
to
VariableDeclarationStatement [3497,3641]
at 1
===
insert-node
---
VariableDeclarationFragment [3511,3640]
to
VariableDeclarationStatement [3497,3641]
at 2
===
insert-node
---
Modifier: final [5098,5103]
to
VariableDeclarationStatement [5185,5330]
at 0
===
insert-tree
---
SimpleType [5104,5112]
    SimpleName: DrillRel [5104,5112]
to
VariableDeclarationStatement [5185,5330]
at 1
===
insert-node
---
Modifier: final [17837,17842]
to
VariableDeclarationStatement [17837,17913]
at 0
===
move-tree
---
SimpleType [46016,46027]
    SimpleName: RelDataType [46016,46027]
to
VariableDeclarationStatement [17837,17913]
at 1
===
insert-tree
---
VariableDeclarationFragment [17855,17912]
    SimpleName: validatedRowType [17855,17871]
    MethodInvocation [17874,17912]
        METHOD_INVOCATION_RECEIVER [17874,17890]
            SimpleName: convertedRelNode [17874,17890]
        SimpleName: getValidatedRowType [17891,17910]
to
VariableDeclarationStatement [17837,17913]
at 2
===
insert-node
---
Modifier: final [17919,17924]
to
VariableDeclarationStatement [17919,17984]
at 0
===
move-tree
---
SimpleType [23008,23015]
    SimpleName: RelNode [23008,23015]
to
VariableDeclarationStatement [17919,17984]
at 1
===
insert-tree
---
VariableDeclarationFragment [17933,17983]
    SimpleName: queryRelNode [17933,17945]
    MethodInvocation [17948,17983]
        METHOD_INVOCATION_RECEIVER [17948,17964]
            SimpleName: convertedRelNode [17948,17964]
        SimpleName: getConvertedNode [17965,17981]
to
VariableDeclarationStatement [17919,17984]
at 2
===
move-tree
---
SimpleType [19741,19749]
    SimpleName: DrillRel [19741,19749]
to
VariableDeclarationStatement [18033,18095]
at 0
===
insert-tree
---
VariableDeclarationFragment [18042,18094]
    SimpleName: drel [18042,18046]
    MethodInvocation [18049,18094]
        SimpleName: convertToDrel [18049,18062]
        METHOD_INVOCATION_ARGUMENTS [18063,18093]
            SimpleName: queryRelNode [18063,18075]
            SimpleName: validatedRowType [18077,18093]
to
VariableDeclarationStatement [18033,18095]
at 1
===
insert-node
---
Modifier: final [18888,18893]
to
VariableDeclarationStatement [19373,19417]
at 0
===
insert-node
---
Modifier: final [18944,18949]
to
VariableDeclarationStatement [19423,19491]
at 0
===
insert-node
---
Modifier: final [19024,19029]
to
VariableDeclarationStatement [19497,19552]
at 0
===
insert-node
---
ClassInstanceCreation [19178,19236]
to
ReturnStatement [19171,19237]
at 0
===
insert-node
---
Modifier: final [39004,39009]
to
VariableDeclarationStatement [39026,39085]
at 0
===
insert-node
---
Modifier: final [39080,39085]
to
VariableDeclarationStatement [39152,39215]
at 0
===
insert-node
---
Modifier: final [39162,39167]
to
VariableDeclarationStatement [39223,39261]
at 0
===
move-tree
---
SimpleType [5185,5192]
    SimpleName: RelNode [5185,5192]
to
VariableDeclarationStatement [39223,39261]
at 1
===
update-node
---
SimpleName: SqlNode [45246,45253]
replace SqlNode by RelDataType
===
update-node
---
SimpleName: TypedSqlNode [45334,45346]
replace TypedSqlNode by RelNode
===
update-node
---
SimpleName: validatedQueryRelNode [47806,47827]
replace validatedQueryRelNode by queryRelNode
===
update-node
---
SimpleName: QueryContext [54654,54666]
replace QueryContext by SqlHandlerConfig
===
update-node
---
SimpleName: planner [54688,54695]
replace planner by config
===
move-tree
---
SimpleName: planner [54688,54695]
to
SuperConstructorInvocation [54171,54185]
at 0
===
update-node
---
SimpleName: context [54900,54907]
replace context by config
===
insert-tree
---
VariableDeclarationStatement [54987,55063]
    Modifier: final [54987,54992]
    SimpleType [54993,55004]
        SimpleName: RelDataType [54993,55004]
    VariableDeclarationFragment [55005,55062]
        SimpleName: validatedRowType [55005,55021]
        MethodInvocation [55024,55062]
            METHOD_INVOCATION_RECEIVER [55024,55040]
                SimpleName: convertedRelNode [55024,55040]
            SimpleName: getValidatedRowType [55041,55060]
to
Block [55104,57180]
at 4
===
insert-tree
---
VariableDeclarationStatement [55071,55136]
    Modifier: final [55071,55076]
    SimpleType [55077,55084]
        SimpleName: RelNode [55077,55084]
    VariableDeclarationFragment [55085,55135]
        SimpleName: queryRelNode [55085,55097]
        MethodInvocation [55100,55135]
            METHOD_INVOCATION_RECEIVER [55100,55116]
                SimpleName: convertedRelNode [55100,55116]
            SimpleName: getConvertedNode [55117,55133]
to
Block [55104,57180]
at 5
===
insert-node
---
VariableDeclarationStatement [55146,55277]
to
Block [55104,57180]
at 6
===
update-node
---
SimpleName: context [57321,57328]
replace context by config
===
update-node
---
SimpleName: newTblRelNode [3675,3688]
replace newTblRelNode by convertedRelNode
===
insert-node
---
SimpleName: newTblRelNode [3511,3524]
to
VariableDeclarationFragment [3511,3640]
at 0
===
insert-node
---
MethodInvocation [3536,3640]
to
VariableDeclarationFragment [3511,3640]
at 1
===
insert-tree
---
SimpleType [19182,19198]
    SimpleName: ConvertedRelNode [19182,19198]
to
ClassInstanceCreation [19178,19236]
at 0
===
move-tree
---
SimpleName: rel [19771,19774]
to
ClassInstanceCreation [19178,19236]
at 1
===
move-tree
---
MethodInvocation [19589,19620]
    METHOD_INVOCATION_RECEIVER [19589,19610]
        SimpleName: validatedTypedSqlNode [19589,19610]
    SimpleName: getType [19611,19618]
to
ClassInstanceCreation [19178,19236]
at 2
===
update-node
---
SimpleName: TypedSqlNode [39026,39038]
replace TypedSqlNode by ConvertedRelNode
===
update-node
---
SimpleName: validatedTypedSqlNode [39039,39060]
replace validatedTypedSqlNode by convertedRelNode
===
update-node
---
SimpleName: rel [39231,39234]
replace rel by queryRelNode
===
move-tree
---
MethodInvocation [62499,62518]
    METHOD_INVOCATION_RECEIVER [62499,62505]
        SimpleName: config [62499,62505]
    SimpleName: getContext [62506,62516]
to
Assignment [54712,54734]
at 2
===
update-node
---
SimpleName: QueryContext [54887,54899]
replace QueryContext by SqlHandlerConfig
===
update-node
---
SimpleName: context [54933,54940]
replace context by config
===
insert-tree
---
SimpleType [54901,54917]
    SimpleName: ConvertedRelNode [54901,54917]
to
VariableDeclarationStatement [55428,55570]
at 1
===
insert-node
---
Modifier: final [55146,55151]
to
VariableDeclarationStatement [55146,55277]
at 0
===
move-tree
---
SimpleType [55434,55441]
    SimpleName: RelNode [55434,55441]
to
VariableDeclarationStatement [55146,55277]
at 1
===
insert-node
---
VariableDeclarationFragment [55160,55276]
to
VariableDeclarationStatement [55146,55277]
at 2
===
update-node
---
SimpleName: QueryContext [57308,57320]
replace QueryContext by SqlHandlerConfig
===
update-node
---
SimpleName: context [57351,57358]
replace context by config
===
move-tree
---
SimpleName: config [62478,62484]
to
ClassInstanceCreation [62451,62519]
at 1
===
move-tree
---
SimpleName: config [66067,66073]
to
ClassInstanceCreation [66054,66087]
at 1
===
insert-node
---
SimpleName: validateAndConvert [3288,3306]
to
MethodInvocation [3700,3808]
at 0
===
move-tree
---
METHOD_INVOCATION_RECEIVER [3700,3714]
    SimpleName: SqlHandlerUtil [3700,3714]
to
MethodInvocation [3536,3640]
at 0
===
move-tree
---
SimpleName: resolveNewTableRel [3715,3733]
to
MethodInvocation [3536,3640]
at 1
===
insert-node
---
METHOD_INVOCATION_ARGUMENTS [3570,3639]
to
MethodInvocation [3536,3640]
at 2
===
update-node
---
SimpleName: planner [5212,5219]
replace planner by convertToDrel
===
move-tree
---
SimpleName: planner [5212,5219]
to
MethodInvocation [5212,5329]
at 0
===
insert-node
---
Modifier: final [19586,19591]
to
VariableDeclarationStatement [23008,23033]
at 0
===
insert-tree
---
SimpleType [19592,19600]
    SimpleName: DrillRel [19592,19600]
to
VariableDeclarationStatement [23008,23033]
at 1
===
insert-node
---
Block [19988,20295]
to
IfStatement [23266,24012]
at 2
===
update-node
---
SimpleName: validateNode [39063,39075]
replace validateNode by validateAndConvert
===
update-node
---
SimpleName: getType [39205,39212]
replace getType by getValidatedRowType
===
insert-node
---
METHOD_INVOCATION_RECEIVER [39191,39207]
to
MethodInvocation [39237,39260]
at 0
===
update-node
---
SimpleName: validated [39250,39259]
replace validated by getConvertedNode
===
move-tree
---
SimpleName: validated [39250,39259]
to
MethodInvocation [39237,39260]
at 1
===
update-node
---
SimpleName: rel [39322,39325]
replace rel by queryRelNode
===
update-node
---
SimpleName: newViewRelNode [55442,55456]
replace newViewRelNode by convertedRelNode
===
insert-node
---
SimpleName: newViewRelNode [55160,55174]
to
VariableDeclarationFragment [55160,55276]
at 0
===
insert-node
---
MethodInvocation [55177,55276]
to
VariableDeclarationFragment [55160,55276]
at 1
===
move-tree
---
BooleanLiteral: false [3734,3739]
to
METHOD_INVOCATION_ARGUMENTS [3570,3639]
at 0
===
move-tree
---
MethodInvocation [3750,3780]
    METHOD_INVOCATION_RECEIVER [3750,3764]
        SimpleName: sqlCreateTable [3750,3764]
    SimpleName: getFieldNames [3765,3778]
to
METHOD_INVOCATION_ARGUMENTS [3570,3639]
at 1
===
insert-node
---
SimpleName: validatedRowType [3609,3625]
to
METHOD_INVOCATION_ARGUMENTS [3570,3639]
at 2
===
insert-node
---
SimpleName: queryRelNode [3627,3639]
to
METHOD_INVOCATION_ARGUMENTS [3570,3639]
at 3
===
insert-tree
---
MethodInvocation [4528,4554]
    METHOD_INVOCATION_RECEIVER [4528,4541]
        SimpleName: newTblRelNode [4528,4541]
    SimpleName: getRowType [4542,4552]
to
METHOD_INVOCATION_ARGUMENTS [4610,4694]
at 4
===
move-tree
---
SimpleName: relNode [5269,5276]
to
METHOD_INVOCATION_ARGUMENTS [5230,5328]
at 0
===
move-tree
---
IfStatement [23516,23643]
    MethodInvocation [23520,23570]
        METHOD_INVOCATION_RECEIVER [23520,23537]
            SimpleName: FindLimit0Visitor [23520,23537]
        SimpleName: containsLimit0 [23538,23552]
        METHOD_INVOCATION_ARGUMENTS [23553,23569]
            SimpleName: convertedRelNode [23553,23569]
    Block [23572,23643]
        ExpressionStatement [23585,23632]
            MethodInvocation [23585,23631]
                METHOD_INVOCATION_RECEIVER [23585,23613]
                    MethodInvocation [23585,23613]
                        METHOD_INVOCATION_RECEIVER [23585,23592]
                            SimpleName: context [23585,23592]
                        SimpleName: getPlannerSettings [23593,23611]
                SimpleName: forceSingleMode [23614,23629]
to
Block [19988,20295]
at 0
===
insert-tree
---
ReturnStatement [20262,20286]
    SimpleName: convertedRelNode [20269,20285]
to
Block [19988,20295]
at 1
===
update-node
---
SimpleName: validatedTypedSqlNode [39183,39204]
replace validatedTypedSqlNode by convertedRelNode
===
update-node
---
SimpleName: convertToRel [39237,39249]
replace convertToRel by convertedRelNode
===
move-tree
---
SimpleName: convertToRel [39237,39249]
to
METHOD_INVOCATION_RECEIVER [39191,39207]
at 0
===
update-node
---
SimpleName: rel [39363,39366]
replace rel by queryRelNode
===
insert-node
---
SimpleName: validateAndConvert [54937,54955]
to
MethodInvocation [55470,55569]
at 0
===
move-tree
---
METHOD_INVOCATION_RECEIVER [55470,55484]
    SimpleName: SqlHandlerUtil [55470,55484]
to
MethodInvocation [55177,55276]
at 0
===
move-tree
---
SimpleName: resolveNewTableRel [55485,55503]
to
MethodInvocation [55177,55276]
at 1
===
insert-node
---
METHOD_INVOCATION_ARGUMENTS [55211,55275]
to
MethodInvocation [55177,55276]
at 2
===
update-node
---
SimpleName: queryRowType [46702,46714]
replace queryRowType by validatedRowtype
===
update-node
---
SimpleName: validatedQueryRelNode [47556,47577]
replace validatedQueryRelNode by queryRelNode
===
update-node
---
SimpleName: queryRowType [47761,47773]
replace queryRowType by validatedRowtype
===
move-tree
---
BooleanLiteral: true [55504,55508]
to
METHOD_INVOCATION_ARGUMENTS [55211,55275]
at 0
===
move-tree
---
MethodInvocation [55519,55545]
    METHOD_INVOCATION_RECEIVER [55519,55529]
        SimpleName: createView [55519,55529]
    SimpleName: getFieldNames [55530,55543]
to
METHOD_INVOCATION_ARGUMENTS [55211,55275]
at 1
===
insert-node
---
SimpleName: validatedRowType [55245,55261]
to
METHOD_INVOCATION_ARGUMENTS [55211,55275]
at 2
===
insert-node
---
SimpleName: queryRelNode [55263,55275]
to
METHOD_INVOCATION_ARGUMENTS [55211,55275]
at 3
===
insert-node
---
CastExpression [19716,19758]
to
Assignment [23112,23162]
at 2
===
insert-node
---
CastExpression [19804,19853]
to
Assignment [23189,23246]
at 2
===
update-node
---
SimpleName: queryRowType [46292,46304]
replace queryRowType by validatedRowtype
===
insert-tree
---
SimpleType [19717,19725]
    SimpleName: DrillRel [19717,19725]
to
CastExpression [19716,19758]
at 0
===
move-tree
---
MethodInvocation [23131,23162]
    SimpleName: logicalPlanningVolcano [23131,23153]
    METHOD_INVOCATION_ARGUMENTS [23154,23161]
        SimpleName: relNode [23154,23161]
to
CastExpression [19716,19758]
at 1
===
insert-tree
---
SimpleType [19805,19813]
    SimpleName: DrillRel [19805,19813]
to
CastExpression [19804,19853]
at 0
===
move-tree
---
MethodInvocation [23208,23246]
    SimpleName: logicalPlanningVolcanoAndLopt [23208,23237]
    METHOD_INVOCATION_ARGUMENTS [23238,23245]
        SimpleName: relNode [23238,23245]
to
CastExpression [19804,19853]
at 1
===
delete-tree
---
ImportDeclaration [1011,1039]
    QualifiedName: java.math.BigDecimal [1018,1038]
===
delete-tree
---
ImportDeclaration [1041,1071]
    QualifiedName: java.util.AbstractList [1048,1070]
===
delete-tree
---
ImportDeclaration [1296,1338]
    QualifiedName: org.apache.calcite.plan.RelOptUtil [1303,1337]
===
delete-tree
---
ImportDeclaration [1803,1839]
    QualifiedName: org.apache.calcite.util.Pair [1810,1838]
===
delete-tree
---
ImportDeclaration [1899,1952]
    QualifiedName: org.apache.drill.common.expression.SchemaPath [1906,1951]
===
delete-tree
---
ImportDeclaration [1954,2002]
    QualifiedName: org.apache.drill.common.types.TypeProtos [1961,2001]
===
delete-tree
---
ImportDeclaration [2004,2049]
    QualifiedName: org.apache.drill.exec.expr.TypeHelper [2011,2048]
===
delete-tree
---
ImportDeclaration [2284,2343]
    QualifiedName: org.apache.drill.exec.planner.logical.DrillStoreRel [2291,2342]
===
delete-tree
---
ImportDeclaration [2779,2835]
    QualifiedName: org.apache.drill.exec.planner.sql.DrillSqlWorker [2786,2834]
===
delete-tree
---
ImportDeclaration [11825,11872]
    QualifiedName: com.google.common.collect.ImmutableList [11832,11871]
===
delete-tree
---
ImportDeclaration [11874,11916]
    QualifiedName: org.apache.calcite.plan.RelOptRule [11881,11915]
===
delete-tree
---
ImportDeclaration [12119,12161]
    QualifiedName: org.apache.calcite.rel.core.Filter [12126,12160]
===
delete-tree
---
ImportDeclaration [12205,12248]
    QualifiedName: org.apache.calcite.rel.core.Project [12212,12247]
===
delete-tree
---
ImportDeclaration [12402,12452]
    QualifiedName: org.apache.calcite.rel.logical.LogicalJoin [12409,12451]
===
delete-tree
---
ImportDeclaration [12454,12507]
    QualifiedName: org.apache.calcite.rel.logical.LogicalProject [12461,12506]
===
delete-tree
---
ImportDeclaration [12699,12765]
    QualifiedName: org.apache.calcite.rel.metadata.DefaultRelMetadataProvider [12706,12764]
===
delete-tree
---
ImportDeclaration [12828,12893]
    QualifiedName: org.apache.calcite.rel.rules.FilterAggregateTransposeRule [12835,12892]
===
delete-tree
---
ImportDeclaration [12895,12946]
    QualifiedName: org.apache.calcite.rel.rules.FilterJoinRule [12902,12945]
===
delete-tree
---
ImportDeclaration [12948,13000]
    QualifiedName: org.apache.calcite.rel.rules.FilterMergeRule [12955,12999]
===
delete-tree
---
ImportDeclaration [13002,13065]
    QualifiedName: org.apache.calcite.rel.rules.FilterProjectTransposeRule [13009,13064]
===
delete-tree
---
ImportDeclaration [13067,13127]
    QualifiedName: org.apache.calcite.rel.rules.JoinPushThroughJoinRule [13074,13126]
===
delete-tree
---
ImportDeclaration [13129,13198]
    QualifiedName: org.apache.calcite.rel.rules.JoinPushTransitivePredicatesRule [13136,13197]
===
delete-tree
---
ImportDeclaration [13317,13370]
    QualifiedName: org.apache.calcite.rel.rules.ProjectMergeRule [13324,13369]
===
delete-tree
---
ImportDeclaration [13428,13492]
    QualifiedName: org.apache.calcite.rel.rules.SemiJoinFilterTransposeRule [13435,13491]
===
delete-tree
---
ImportDeclaration [13494,13556]
    QualifiedName: org.apache.calcite.rel.rules.SemiJoinJoinTransposeRule [13501,13555]
===
delete-tree
---
ImportDeclaration [13558,13623]
    QualifiedName: org.apache.calcite.rel.rules.SemiJoinProjectTransposeRule [13565,13622]
===
delete-tree
---
ImportDeclaration [13988,14038]
    QualifiedName: org.apache.calcite.sql2rel.RelFieldTrimmer [13995,14037]
===
delete-tree
---
ImportDeclaration [14927,14993]
    QualifiedName: org.apache.drill.exec.planner.logical.DrillFilterJoinRules [14934,14992]
===
delete-tree
---
ImportDeclaration [15055,15122]
    QualifiedName: org.apache.drill.exec.planner.logical.DrillMergeProjectRule [15062,15121]
===
delete-tree
---
ImportDeclaration [15187,15263]
    QualifiedName: org.apache.drill.exec.planner.logical.DrillPushFilterPastProjectRule [15194,15262]
===
delete-tree
---
ImportDeclaration [15265,15341]
    QualifiedName: org.apache.drill.exec.planner.logical.DrillPushProjectPastFilterRule [15272,15340]
===
delete-tree
---
ImportDeclaration [37366,37409]
    QualifiedName: org.apache.calcite.sql.TypedSqlNode [37373,37408]
===
delete-tree
---
ImportDeclaration [53451,53501]
    QualifiedName: org.apache.calcite.schema.Schema.TableType [53458,53500]
===
delete-tree
---
ImportDeclaration [53590,53630]
    QualifiedName: org.apache.calcite.tools.Planner [53597,53629]
===
delete-node
---
SimpleName: planner [3741,3748]
===
delete-node
---
METHOD_INVOCATION_RECEIVER [5212,5219]
===
delete-node
---
SimpleName: transform [5220,5229]
===
delete-node
---
QualifiedName: DrillSqlWorker.LOGICAL_RULES [5230,5258]
===
delete-node
---
METHOD_INVOCATION_RECEIVER [5269,5276]
===
delete-node
---
SimpleName: getTraitSet [5277,5288]
===
delete-node
---
MethodInvocation [5269,5290]
===
delete-node
---
METHOD_INVOCATION_RECEIVER [5269,5290]
===
delete-node
---
SimpleName: plus [5291,5295]
===
delete-tree
---
METHOD_INVOCATION_ARGUMENTS [5296,5318]
    QualifiedName: DrillRel.DRILL_LOGICAL [5296,5318]
===
delete-node
---
MethodInvocation [5269,5319]
===
delete-node
---
SimpleName: relNode [5321,5328]
===
delete-tree
---
IfStatement [5338,5443]
    InstanceofExpression [5342,5383]
        SimpleName: convertedRelNode [5342,5358]
        SimpleType [5370,5383]
            SimpleName: DrillStoreRel [5370,5383]
    Block [5385,5443]
        ThrowStatement [5394,5436]
            ClassInstanceCreation [5400,5435]
                SimpleType [5404,5433]
                    SimpleName: UnsupportedOperationException [5404,5433]
===
delete-node
---
Modifier: public [17589,17595]
===
delete-node
---
TYPE_DECLARATION_KIND: class [17596,17601]
===
delete-node
---
SimpleName: DefaultSqlHandler [17602,17619]
===
delete-node
---
SimpleName: validatedRowType [19570,19586]
===
delete-node
---
VariableDeclarationFragment [19570,19620]
===
delete-node
---
VariableDeclarationStatement [19558,19621]
===
delete-tree
---
ExpressionStatement [19709,19735]
    MethodInvocation [19709,19734]
        SimpleName: log [19709,19712]
        METHOD_INVOCATION_ARGUMENTS [19713,19733]
            StringLiteral: "Optiq Logical" [19713,19728]
            SimpleName: rel [19730,19733]
===
delete-node
---
SimpleName: drel [19750,19754]
===
delete-node
---
SimpleName: convertToDrel [19757,19770]
===
delete-node
---
SimpleName: validatedRowType [19776,19792]
===
delete-node
---
METHOD_INVOCATION_ARGUMENTS [19771,19792]
===
delete-node
---
MethodInvocation [19757,19793]
===
delete-node
---
VariableDeclarationFragment [19750,19793]
===
delete-node
---
VariableDeclarationStatement [19741,19794]
===
delete-tree
---
VariableDeclarationStatement [38988,39020]
    SimpleType [38988,38995]
        SimpleName: SqlNode [38988,38995]
    VariableDeclarationFragment [38996,39019]
        SimpleName: sqlNode [38996,39003]
        MethodInvocation [39006,39019]
            SimpleName: rewrite [39006,39013]
            METHOD_INVOCATION_ARGUMENTS [39014,39018]
                SimpleName: node [39014,39018]
===
delete-tree
---
VariableDeclarationStatement [39091,39146]
    SimpleType [39091,39098]
        SimpleName: SqlNode [39091,39098]
    VariableDeclarationFragment [39099,39145]
        SimpleName: validated [39099,39108]
        MethodInvocation [39111,39145]
            METHOD_INVOCATION_RECEIVER [39111,39132]
                SimpleName: validatedTypedSqlNode [39111,39132]
            SimpleName: getSqlNode [39133,39143]
===
delete-tree
---
SimpleType [39223,39230]
    SimpleName: RelNode [39223,39230]
===
delete-node
---
METHOD_INVOCATION_ARGUMENTS [39250,39259]
===
delete-tree
---
ExpressionStatement [39267,39293]
    Assignment [39267,39292]
        SimpleName: rel [39267,39270]
        ASSIGNMENT_OPERATOR: = [39271,39272]
        MethodInvocation [39273,39292]
            SimpleName: preprocessNode [39273,39287]
            METHOD_INVOCATION_ARGUMENTS [39288,39291]
                SimpleName: rel [39288,39291]
===
delete-tree
---
TagElement [44293,44325]
    SimpleName: planner [44300,44307]
    TextElement:  Planner instance. [44307,44325]
===
delete-tree
---
TagElement [44686,44904]
    SimpleName: newTableQueryDef [44693,44709]
    TextElement:   Sql tree of definition of the new table or view (query after the AS keyword). This tree is [44709,44801]
    TextElement: modified, so it is responsibility of caller's to make a copy if needed. [44833,44904]
===
delete-tree
---
SingleVariableDeclaration [45192,45207]
    SimpleType [45192,45199]
        SimpleName: Planner [45192,45199]
    SimpleName: planner [45200,45207]
===
delete-tree
---
MethodInvocation [45374,45418]
    METHOD_INVOCATION_RECEIVER [45374,45381]
        SimpleName: planner [45374,45381]
    SimpleName: validateAndGetType [45382,45400]
    METHOD_INVOCATION_ARGUMENTS [45401,45417]
        SimpleName: newTableQueryDef [45401,45417]
===
delete-node
---
VariableDeclarationFragment [45347,45418]
===
delete-node
---
VariableDeclarationStatement [45334,45419]
===
delete-node
---
Modifier: final [46010,46015]
===
delete-tree
---
VariableDeclarationFragment [46028,46077]
    SimpleName: queryRowType [46028,46040]
    MethodInvocation [46043,46077]
        METHOD_INVOCATION_RECEIVER [46043,46067]
            SimpleName: validatedSqlNodeWithType [46043,46067]
        SimpleName: getType [46068,46075]
===
delete-node
---
VariableDeclarationStatement [46010,46078]
===
delete-node
---
Modifier: final [46084,46089]
===
delete-tree
---
VariableDeclarationFragment [46098,46176]
    SimpleName: validatedQueryRelNode [46098,46119]
    MethodInvocation [46122,46176]
        METHOD_INVOCATION_RECEIVER [46122,46129]
            SimpleName: planner [46122,46129]
        SimpleName: convert [46130,46137]
        METHOD_INVOCATION_ARGUMENTS [46138,46175]
            MethodInvocation [46138,46175]
                METHOD_INVOCATION_RECEIVER [46138,46162]
                    SimpleName: validatedSqlNodeWithType [46138,46162]
                SimpleName: getSqlNode [46163,46173]
===
delete-node
---
VariableDeclarationStatement [46084,46177]
===
delete-tree
---
FieldDeclaration [54551,54577]
    Modifier: protected [54551,54560]
    SimpleType [54561,54568]
        SimpleName: Planner [54561,54568]
    VariableDeclarationFragment [54569,54576]
        SimpleName: planner [54569,54576]
===
delete-tree
---
SingleVariableDeclaration [54637,54652]
    SimpleType [54637,54644]
        SimpleName: Planner [54637,54644]
    SimpleName: planner [54645,54652]
===
delete-node
---
ThisExpression [54683,54687]
===
delete-node
---
FieldAccess [54683,54695]
===
delete-node
---
ASSIGNMENT_OPERATOR: = [54696,54697]
===
delete-node
---
SimpleName: planner [54698,54705]
===
delete-node
---
Assignment [54683,54705]
===
delete-node
---
ExpressionStatement [54683,54706]
===
delete-node
---
SimpleName: context [54727,54734]
===
delete-tree
---
SingleVariableDeclaration [54870,54885]
    SimpleType [54870,54877]
        SimpleName: Planner [54870,54877]
    SimpleName: planner [54878,54885]
===
delete-node
---
SimpleName: planner [54924,54931]
===
delete-node
---
SimpleName: planner [55510,55517]
===
delete-node
---
NullLiteral [57345,57349]
===
delete-node
---
METHOD_INVOCATION_RECEIVER [62478,62484]
===
delete-node
---
SimpleName: getPlanner [62485,62495]
===
delete-node
---
MethodInvocation [62478,62497]
===
delete-node
---
METHOD_INVOCATION_RECEIVER [66067,66073]
===
delete-node
---
SimpleName: getContext [66074,66084]
===
delete-node
---
MethodInvocation [66067,66086]
